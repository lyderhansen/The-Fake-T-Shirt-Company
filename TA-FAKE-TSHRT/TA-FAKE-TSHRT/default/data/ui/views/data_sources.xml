<dashboard version="1.1" theme="dark">
  <label>Data Sources</label>
  <description>All available data sources and their event volumes</description>

  <fieldset submitButton="false">
    <input type="time" token="time" searchWhenChanged="true">
      <label>Time Range</label>
      <default>
        <earliest>1735689600</earliest>
        <latest>1736899200</latest>
      </default>
    </input>
  </fieldset>

  <row>
    <panel>
      <html>
        <div style="padding: 15px; background: #1a1a1a; border-radius: 5px;">
          <h2 style="color: #5CC05C; margin-top: 0;">Available Data Sources</h2>
          <p style="color: #999;">This TA generates synthetic log data for 17+ data sources across network, cloud, endpoints, and business applications.</p>
        </div>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>Event Volume by Category</title>
      <chart>
        <search>
          <query>| tstats count where index=fake_tshrt by sourcetype
| eval category=case(
    match(sourcetype, "(?i)cisco:asa|meraki"), "Network",
    match(sourcetype, "(?i)aws|azure|google"), "Cloud",
    match(sourcetype, "(?i)WinEventLog|Perfmon"), "Windows",
    match(sourcetype, "(?i)cpu|vmstat|df|iostat|interfaces"), "Linux",
    match(sourcetype, "(?i)access"), "Web",
    match(sourcetype, "(?i)order|servicebus"), "Retail",
    match(sourcetype, "(?i)webex"), "Collaboration",
    match(sourcetype, "(?i)servicenow"), "ITSM",
    match(sourcetype, "(?i)o365|exchange|messagetrace"), "Email",
    1=1, "Other"
)
| stats sum(count) as count by category
| sort -count</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">bar</option>
        <option name="charting.drilldown">none</option>
        <option name="height">250</option>
      </chart>
    </panel>
  </row>

  <row>
    <panel>
      <title>Network Security</title>
      <table>
        <search>
          <query>| makeresults
| eval data="FAKE:cisco:asa,Cisco ASA Firewall,Perimeter firewall logs (302013/302014/106023 etc)|FAKE:meraki:securityappliances,Meraki MX,SD-WAN/Firewall appliance events|FAKE:meraki:accesspoints,Meraki MR,Wireless access point events|FAKE:meraki:switches,Meraki MS,Network switch events|FAKE:meraki:cameras,Meraki MV,Smart camera events|FAKE:meraki:sensors,Meraki MT,Environmental sensor data"
| makemv delim="|" data
| mvexpand data
| rex field=data "(?&lt;sourcetype&gt;[^,]+),(?&lt;source&gt;[^,]+),(?&lt;description&gt;.+)"
| table sourcetype, source, description
| rename sourcetype as "Sourcetype", source as "Source", description as "Description"</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>

  <row>
    <panel>
      <title>Cloud Security</title>
      <table>
        <search>
          <query>| makeresults
| eval data="FAKE:aws:cloudtrail,AWS CloudTrail,API activity logs from AWS|FAKE:azure:aad:signin,Entra ID Sign-in,Azure AD authentication events|FAKE:azure:aad:audit,Entra ID Audit,Azure AD administrative changes|FAKE:google:gcp:pubsub:audit,GCP Audit,Google Cloud Platform audit logs"
| makemv delim="|" data
| mvexpand data
| rex field=data "(?&lt;sourcetype&gt;[^,]+),(?&lt;source&gt;[^,]+),(?&lt;description&gt;.+)"
| table sourcetype, source, description
| rename sourcetype as "Sourcetype", source as "Source", description as "Description"</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>

  <row>
    <panel>
      <title>Endpoints</title>
      <table>
        <search>
          <query>| makeresults
| eval data="FAKE:WinEventLog,Windows Event Log,Security/System/Application events|FAKE:Perfmon:Processor,Windows Perfmon,CPU performance metrics|FAKE:Perfmon:Memory,Windows Perfmon,Memory utilization|FAKE:Perfmon:LogicalDisk,Windows Perfmon,Disk space and I/O|FAKE:cpu,Linux CPU,CPU utilization (sar-style)|FAKE:vmstat,Linux Memory,Memory statistics|FAKE:df,Linux Disk,Filesystem usage|FAKE:iostat,Linux I/O,Disk I/O statistics"
| makemv delim="|" data
| mvexpand data
| rex field=data "(?&lt;sourcetype&gt;[^,]+),(?&lt;source&gt;[^,]+),(?&lt;description&gt;.+)"
| table sourcetype, source, description
| rename sourcetype as "Sourcetype", source as "Source", description as "Description"</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>

  <row>
    <panel>
      <title>Business Applications</title>
      <table>
        <search>
          <query>| makeresults
| eval data="FAKE:access_combined,Apache Access,Web server access logs|FAKE:online:order,Retail Orders,E-commerce order data|FAKE:azure:servicebus,Azure ServiceBus,Order processing messages|FAKE:o365:reporting:messagetrace,Exchange,Email message trace|FAKE:cisco:webex:events,Webex,Collaboration device events|FAKE:servicenow:incident,ServiceNow,IT incident management"
| makemv delim="|" data
| mvexpand data
| rex field=data "(?&lt;sourcetype&gt;[^,]+),(?&lt;source&gt;[^,]+),(?&lt;description&gt;.+)"
| table sourcetype, source, description
| rename sourcetype as "Sourcetype", source as "Source", description as "Description"</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>

  <row>
    <panel>
      <title>Actual Event Counts</title>
      <table>
        <search>
          <query>| tstats count, earliest(_time) as first_event, latest(_time) as last_event where index=fake_tshrt by sourcetype
| eval first_event=strftime(first_event, "%Y-%m-%d"), last_event=strftime(last_event, "%Y-%m-%d")
| sort -count
| rename sourcetype as "Sourcetype", count as "Event Count", first_event as "First Event", last_event as "Last Event"</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="count">20</option>
      </table>
    </panel>
  </row>
</dashboard>
