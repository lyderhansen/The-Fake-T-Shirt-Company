<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The FAKE T-Shirt Company - Infrastructure Architecture</title>
<style>
  :root {
    --bg: #0B0C10;
    --bg-card: #1F2833;
    --bg-card-hover: #2a3545;
    --accent: #66FCF1;
    --accent-dim: #45A29E;
    --text: #C5C6C7;
    --text-bright: #FFFFFF;
    --border: #333;
    --cisco: #FF6B35;
    --threat: #FF4444;
    --cloud: #4A90D9;
    --server-win: #0078D4;
    --server-linux: #E95420;
    --meraki: #78BE20;
    --webex: #00BCF2;
    --data-flow: #FFD700;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Segoe UI', -apple-system, sans-serif;
    line-height: 1.5;
    padding: 20px;
  }

  h1 {
    text-align: center;
    color: var(--accent);
    font-size: 28px;
    margin-bottom: 5px;
  }
  .subtitle {
    text-align: center;
    color: var(--text);
    font-size: 14px;
    margin-bottom: 20px;
  }

  /* Legend */
  .legend {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-bottom: 15px;
    flex-wrap: wrap;
  }
  .legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
  }
  .legend-dot {
    width: 12px;
    height: 12px;
    border-radius: 3px;
    display: inline-block;
  }
  .legend-line {
    width: 30px;
    height: 0;
    display: inline-block;
    border-top: 2px solid;
  }
  .legend-line.dashed {
    border-top-style: dashed;
  }

  /* Tab navigation */
  .tabs {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-bottom: 20px;
    flex-wrap: wrap;
  }
  .tab {
    padding: 8px 20px;
    background: var(--bg-card);
    border: 1px solid var(--border);
    color: var(--text);
    cursor: pointer;
    border-radius: 6px;
    font-size: 13px;
    transition: all 0.2s;
  }
  .tab:hover { border-color: var(--accent-dim); }
  .tab.active {
    background: var(--accent-dim);
    color: var(--bg);
    border-color: var(--accent);
    font-weight: 600;
  }

  .tab-content { display: none; }
  .tab-content.active { display: block; }

  /* Diagram container */
  .diagram {
    max-width: 1440px;
    margin: 0 auto;
  }

  /* Cards */
  .section {
    margin-bottom: 30px;
  }
  .section-title {
    font-size: 18px;
    color: var(--accent);
    border-bottom: 1px solid var(--accent-dim);
    padding-bottom: 5px;
    margin-bottom: 15px;
  }

  .card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 20px;
  }

  .card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 15px;
    transition: border-color 0.2s;
  }
  .card:hover { border-color: var(--accent-dim); }
  .card-title {
    font-size: 15px;
    font-weight: 600;
    color: var(--text-bright);
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .badge {
    font-size: 10px;
    padding: 2px 6px;
    border-radius: 3px;
    font-weight: 600;
  }
  .badge-cisco { background: var(--cisco); color: #fff; }
  .badge-existing { background: var(--accent-dim); color: var(--bg); }
  .badge-cloud { background: var(--cloud); color: #fff; }
  .badge-threat { background: var(--threat); color: #fff; }
  .badge-attack { background: var(--threat); color: #fff; }
  .badge-ops { background: var(--cloud); color: #fff; }
  .badge-network { background: var(--cisco); color: #fff; }

  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 12px;
  }
  th {
    text-align: left;
    color: var(--accent-dim);
    padding: 4px 8px;
    border-bottom: 1px solid var(--border);
    font-weight: 600;
  }
  td {
    padding: 4px 8px;
    border-bottom: 1px solid #222;
    color: var(--text);
  }
  tr:hover td { background: rgba(102, 252, 241, 0.05); }

  .os-win { color: var(--server-win); }
  .os-linux { color: var(--server-linux); }

  /* SVG styles */
  svg text { font-family: 'Segoe UI', -apple-system, sans-serif; }
  svg path, svg line { fill: none; }

  .hoverable { cursor: pointer; }
  .hoverable:hover rect,
  .hoverable:hover circle { filter: brightness(1.3); }
  .hoverable:hover text { fill: #FFFFFF; }

  /* Stats row */
  .stats-row {
    display: flex;
    gap: 15px;
    margin-bottom: 20px;
    flex-wrap: wrap;
    justify-content: center;
  }
  .stat {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 12px 20px;
    text-align: center;
    min-width: 120px;
  }
  .stat-value {
    font-size: 24px;
    font-weight: 700;
    color: var(--accent);
  }
  .stat-label {
    font-size: 11px;
    color: var(--text);
    margin-top: 2px;
  }

  .note {
    font-size: 11px;
    color: #888;
    font-style: italic;
    margin-top: 5px;
  }

  /* Tooltip */
  #tooltip {
    position: fixed;
    display: none;
    z-index: 1000;
    pointer-events: none;
    background: #1F2833;
    border: 1px solid #66FCF1;
    border-radius: 8px;
    padding: 12px 16px;
    max-width: 340px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.5);
    transition: opacity 0.15s;
  }
  #tooltip .tt-title {
    color: #66FCF1;
    font-weight: 700;
    font-size: 14px;
    margin-bottom: 2px;
  }
  #tooltip .tt-body {
    color: #C5C6C7;
    font-size: 12px;
    margin-top: 4px;
    line-height: 1.4;
  }
  #tooltip .tt-detail {
    color: #888;
    font-size: 11px;
    margin-top: 6px;
    line-height: 1.4;
  }

  /* Scenario timeline bar */
  .timeline-container {
    position: relative;
    height: 24px;
    background: #1a1a2e;
    border-radius: 4px;
    margin: 8px 0 20px 0;
    overflow: hidden;
  }
  .timeline-bar {
    position: absolute;
    height: 24px;
    border-radius: 3px;
    opacity: 0.85;
    display: flex;
    align-items: center;
    padding: 0 6px;
    font-size: 10px;
    color: #fff;
    font-weight: 600;
    white-space: nowrap;
    overflow: hidden;
    top: 2px;
  }
  .timeline-row {
    position: relative;
    height: 28px;
    margin-bottom: 4px;
    display: flex;
  }
  .timeline-row-label {
    width: 60px;
    flex-shrink: 0;
    font-size: 9px;
    font-weight: 600;
    line-height: 28px;
    color: #888;
  }
  .timeline-row-bars {
    position: relative;
    flex: 1;
  }
  .timeline-days {
    display: flex;
    justify-content: space-between;
    font-size: 10px;
    color: #666;
    padding: 0 2px;
  }

  /* Log generators list */
  .gen-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    gap: 6px;
    margin-top: 10px;
  }
  .gen-item {
    font-size: 11px;
    padding: 4px 8px;
    background: rgba(69, 162, 158, 0.1);
    border: 1px solid rgba(69, 162, 158, 0.3);
    border-radius: 4px;
    color: var(--text);
  }
  .gen-item .gen-name { color: var(--accent); font-weight: 600; }
</style>
</head>
<body>

<h1>The FAKE T-Shirt Company</h1>
<p class="subtitle">Infrastructure Architecture | 175 Employees | 3 Locations | January 2026</p>

<div class="legend">
  <div class="legend-item"><div class="legend-dot" style="background:var(--accent-dim)"></div> Network</div>
  <div class="legend-item"><div class="legend-dot" style="background:var(--cisco)"></div> Cisco Networking</div>
  <div class="legend-item"><div class="legend-dot" style="background:var(--cloud)"></div> Cloud Services</div>
  <div class="legend-item"><div class="legend-dot" style="background:var(--server-win)"></div> Windows</div>
  <div class="legend-item"><div class="legend-dot" style="background:var(--server-linux)"></div> Linux</div>
  <div class="legend-item"><div class="legend-line" style="border-color:var(--accent-dim)"></div> Network</div>
  <div class="legend-item"><div class="legend-line dashed" style="border-color:var(--meraki)"></div> SD-WAN</div>
  <div class="legend-item"><div class="legend-line dashed" style="border-color:var(--cisco)"></div> Management</div>
  <div class="legend-item"><div class="legend-line" style="border-color:var(--data-flow)"></div> Data Flow</div>
  <div class="legend-item"><div class="legend-line dashed" style="border-color:var(--threat)"></div> Threat</div>
</div>

<div class="stats-row">
  <div class="stat"><div class="stat-value">175</div><div class="stat-label">Employees</div></div>
  <div class="stat"><div class="stat-value">13</div><div class="stat-label">Servers</div></div>
  <div class="stat"><div class="stat-value">79</div><div class="stat-label">Meraki Devices</div></div>
  <div class="stat"><div class="stat-value">21</div><div class="stat-label">Webex Rooms</div></div>
  <div class="stat"><div class="stat-value">24</div><div class="stat-label">Log Generators</div></div>
  <div class="stat"><div class="stat-value">10</div><div class="stat-label">Scenarios</div></div>
</div>

<div class="tabs">
  <div class="tab active" onclick="showTab('overview')">Network Overview</div>
  <div class="tab" onclick="showTab('connections')">Server Connections</div>
  <div class="tab" onclick="showTab('boston')">Boston HQ</div>
  <div class="tab" onclick="showTab('atlanta')">Atlanta Hub</div>
  <div class="tab" onclick="showTab('austin')">Austin Office</div>
  <div class="tab" onclick="showTab('cloud')">Cloud & SaaS</div>
  <div class="tab" onclick="showTab('scenarios')">Scenarios</div>
</div>

<!-- Tooltip element -->
<div id="tooltip">
  <div class="tt-title"></div>
  <div class="tt-body"></div>
  <div class="tt-detail"></div>
</div>

<!-- ========== TAB: NETWORK OVERVIEW ========== -->
<div id="tab-overview" class="tab-content active">
<div class="diagram">
<svg viewBox="0 0 1440 1060" xmlns="http://www.w3.org/2000/svg" style="width:100%; height:auto;">
  <defs>
    <marker id="arrow" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#45A29E"/></marker>
    <marker id="arrow-threat" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#FF4444"/></marker>
    <marker id="arrow-mgmt" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#FF6B35"/></marker>
    <marker id="arrow-data" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#FFD700"/></marker>
  </defs>

  <!-- ===== LAYER 1: INTERNET + THREAT (y=10-55) ===== -->
  <g class="hoverable" data-tt-title="Internet" data-tt-body="Public Internet / WAN edge" data-tt-detail="All external traffic enters via FW-EDGE-01 (ASA 5525-X)|Public IPs: 203.0.113.10 (WEB-01), 203.0.113.11 (WEB-02)">
    <rect x="560" y="10" width="320" height="42" rx="6" fill="#1F2833" stroke="#45A29E" stroke-width="1.5"/>
    <text x="720" y="36" text-anchor="middle" fill="#C5C6C7" font-size="14" font-weight="600">INTERNET</text>
  </g>
  <g class="hoverable" data-tt-title="Threat Actor" data-tt-body="185.220.101.42 | Frankfurt, Germany" data-tt-detail="ASN: AS205100 (F3 Netze e.V.)|Active in exfil scenario (Days 1-14)|Phishing, C2, data exfiltration">
    <rect x="960" y="10" width="220" height="42" rx="6" fill="#331111" stroke="#FF4444" stroke-width="1.5"/>
    <text x="1070" y="30" text-anchor="middle" fill="#FF4444" font-size="11" font-weight="700">THREAT ACTOR</text>
    <text x="1070" y="44" text-anchor="middle" fill="#FF8888" font-size="9">185.220.101.42 | Frankfurt DE</text>
  </g>
  <!-- Threat arrow -->
  <path d="M 960,31 L 880,31" stroke="#FF4444" stroke-width="1.5" stroke-dasharray="4,3" marker-end="url(#arrow-threat)" opacity="0.7"/>

  <!-- ===== LAYER 2: CLOUD SERVICES (y=70-130) ===== -->
  <rect x="40" y="68" width="1360" height="60" rx="8" fill="none" stroke="#4A90D9" stroke-width="1" stroke-dasharray="6,3" opacity="0.5"/>
  <text x="60" y="82" fill="#4A90D9" font-size="10" font-weight="600" opacity="0.7">CLOUD SERVICES</text>

  <g class="hoverable" data-tt-title="Cisco Secure Access" data-tt-body="Cloud-delivered security (DNS, SWG, CFFW)" data-tt-detail="175 users | 5 data centers (IAD, ORD, DFW, SJC, ATL)|DNS: 100K-120K queries/day | SWG: 25K-40K events/day|Sourcetypes: cisco:umbrella:dns, proxy, firewall, audit">
    <rect x="60" y="88" width="170" height="32" rx="5" fill="#2d1f15" stroke="#FF6B35" stroke-width="1.5"/>
    <text x="145" y="108" text-anchor="middle" fill="#FF6B35" font-size="10" font-weight="600">Cisco Secure Access</text>
  </g>
  <g class="hoverable" data-tt-title="AWS CloudTrail" data-tt-body="Account: 123456789012 | us-east-1" data-tt-detail="Regions: us-east-1 (primary), us-west-2 (secondary)|Buckets: finance-data, backups-prod|Sourcetype: aws:cloudtrail">
    <rect x="250" y="88" width="140" height="32" rx="5" fill="#1F2833" stroke="#FF9900" stroke-width="1"/>
    <text x="320" y="108" text-anchor="middle" fill="#FF9900" font-size="10" font-weight="600">AWS</text>
  </g>
  <g class="hoverable" data-tt-title="GCP" data-tt-body="Project: faketshirtcompany-prod-01 | us-central1" data-tt-detail="Bucket: confidential-docs|Sourcetype: google:gcp:pubsub:message">
    <rect x="410" y="88" width="140" height="32" rx="5" fill="#1F2833" stroke="#4285F4" stroke-width="1"/>
    <text x="480" y="108" text-anchor="middle" fill="#4285F4" font-size="10" font-weight="600">GCP</text>
  </g>
  <g class="hoverable" data-tt-title="Entra ID / Microsoft 365" data-tt-body="Tenant: theFakeTshirtCompany.com" data-tt-detail="175 users + service accounts | 17 enterprise apps|MFA: Enabled | Licensing: M365 E3|Sourcetypes: azure:aad:signin, audit, o365:management:activity">
    <rect x="570" y="88" width="160" height="32" rx="5" fill="#1F2833" stroke="#0078D4" stroke-width="1"/>
    <text x="650" y="108" text-anchor="middle" fill="#0078D4" font-size="10" font-weight="600">Entra ID / M365</text>
  </g>
  <g class="hoverable" data-tt-title="Exchange Online" data-tt-body="Email service for all 175 employees" data-tt-detail="Sourcetype: ms:o365:reporting:messagetrace|Scenarios: exfil, phishing_test, ransomware_attempt">
    <rect x="750" y="88" width="140" height="32" rx="5" fill="#1F2833" stroke="#0078D4" stroke-width="1"/>
    <text x="820" y="108" text-anchor="middle" fill="#0078D4" font-size="10" font-weight="600">Exchange Online</text>
  </g>
  <g class="hoverable" data-tt-title="Cisco Webex" data-tt-body="21 meeting rooms across 3 sites" data-tt-detail="Boston: 10 rooms | Atlanta: 7 rooms | Austin: 4 rooms|Problem rooms: Kirby (BOS), Cortana (ATL)|Sourcetypes: cisco:webex:events, meetings:history, API types">
    <rect x="910" y="88" width="140" height="32" rx="5" fill="#1F2833" stroke="#00BCF2" stroke-width="1"/>
    <text x="980" y="108" text-anchor="middle" fill="#00BCF2" font-size="10" font-weight="600">Cisco Webex</text>
  </g>
  <g class="hoverable" data-tt-title="Meraki Dashboard" data-tt-body="Cloud-managed network infrastructure" data-tt-detail="79 devices: 4 MX + 36 MR + 11 MS + 19 MV + 14 MT (physical)|Plus 21 door + 18 temp sensors in meeting rooms|Sourcetypes: meraki:mx, mr, ms, mv, mt">
    <rect x="1070" y="88" width="160" height="32" rx="5" fill="#1F2833" stroke="#78BE20" stroke-width="1"/>
    <text x="1150" y="108" text-anchor="middle" fill="#78BE20" font-size="10" font-weight="600">Meraki Dashboard</text>
  </g>
  <g class="hoverable" data-tt-title="ServiceNow" data-tt-body="IT Service Management" data-tt-detail="Incident management for all scenarios|Auto-ticket creation on threshold alerts|Sourcetype: servicenow:incident">
    <rect x="1250" y="88" width="130" height="32" rx="5" fill="#1F2833" stroke="#81B5A1" stroke-width="1"/>
    <text x="1315" y="108" text-anchor="middle" fill="#81B5A1" font-size="10" font-weight="600">ServiceNow</text>
  </g>

  <!-- Internet to ASA -->
  <line x1="720" y1="52" x2="720" y2="148" stroke="#45A29E" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- ===== LAYER 3: PERIMETER + DMZ (y=148-220) ===== -->
  <g class="hoverable" data-tt-title="FW-EDGE-01" data-tt-body="Cisco ASA 5525-X | 203.0.113.1" data-tt-detail="Perimeter firewall for ALL external traffic|DMZ host: WEB-01/02 behind NAT|Scenarios: exfil, ransomware, firewall_misconfig, certificate_expiry, ddos_attack|Generator: generate_asa.py | cisco:asa">
    <rect x="590" y="148" width="260" height="46" rx="6" fill="#1F2833" stroke="#45A29E" stroke-width="2"/>
    <text x="720" y="168" text-anchor="middle" fill="#66FCF1" font-size="12" font-weight="700">FW-EDGE-01</text>
    <text x="720" y="184" text-anchor="middle" fill="#C5C6C7" font-size="9">ASA 5525-X | 203.0.113.1</text>
  </g>

  <!-- DMZ box -->
  <g class="hoverable" data-tt-title="DMZ Zone" data-tt-body="172.16.1.0/24 | Boston perimeter" data-tt-detail="WEB-01 (172.16.1.10) + WEB-02 (172.16.1.11)|Apache web servers behind NAT|Public: 203.0.113.10 / .11">
    <rect x="180" y="148" width="280" height="46" rx="6" fill="#1F2833" stroke="#45A29E" stroke-width="1" stroke-dasharray="5,3"/>
    <text x="210" y="164" fill="#45A29E" font-size="9" font-weight="600">DMZ 172.16.1.0/24</text>
    <rect x="200" y="170" width="100" height="20" rx="3" fill="#2a1a10" stroke="#E95420" stroke-width="1"/>
    <text x="250" y="184" text-anchor="middle" fill="#E95420" font-size="9">WEB-01</text>
    <rect x="320" y="170" width="100" height="20" rx="3" fill="#2a1a10" stroke="#E95420" stroke-width="1"/>
    <text x="370" y="184" text-anchor="middle" fill="#E95420" font-size="9">WEB-02</text>
  </g>
  <!-- ASA to DMZ -->
  <path d="M 590,171 L 460,171" stroke="#45A29E" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Catalyst Center (management plane) -->
  <g class="hoverable" data-tt-title="Catalyst Center" data-tt-body="CATCENTER-BOS-01 | 10.10.10.40" data-tt-detail="Network management and assurance platform|Manages: CAT-BOS-DIST-01/02, CAT-ATL-DIST-01|Device health, network health, client health, issues|Sourcetypes: cisco:catalyst:devicehealth, networkhealth, clienthealth, issue">
    <rect x="1020" y="148" width="220" height="46" rx="6" fill="#2d1f15" stroke="#FF6B35" stroke-width="1.5"/>
    <text x="1130" y="168" text-anchor="middle" fill="#FF6B35" font-size="11" font-weight="600">Catalyst Center</text>
    <text x="1130" y="183" text-anchor="middle" fill="#C5C6C7" font-size="9">CATCENTER-BOS-01 | 10.10.10.40</text>
  </g>

  <!-- ===== LAYER 4: SD-WAN BACKBONE (y=218-248) ===== -->
  <rect x="40" y="218" width="1360" height="30" rx="4" fill="#0d1a0d" stroke="#78BE20" stroke-width="1" stroke-dasharray="6,3" opacity="0.6"/>
  <text x="60" y="237" fill="#78BE20" font-size="10" font-weight="600" opacity="0.7">SD-WAN BACKBONE (AutoVPN Mesh)</text>

  <!-- ASA down to backbone -->
  <line x1="720" y1="194" x2="720" y2="218" stroke="#45A29E" stroke-width="1.5"/>

  <!-- Catalyst Center management lines - orthogonal through backbone -->
  <path d="M 1130,194 L 1130,210" stroke="#FF6B35" stroke-width="1" stroke-dasharray="4,3" opacity="0.6"/>

  <!-- ===== LAYER 5: THREE SITE COLUMNS (y=268-800) ===== -->

  <!-- ── BOSTON HQ ── -->
  <rect x="40" y="268" width="420" height="530" rx="8" fill="#111822" stroke="#45A29E" stroke-width="1.5"/>
  <text x="250" y="290" text-anchor="middle" fill="#66FCF1" font-size="14" font-weight="700">BOSTON HQ</text>
  <text x="250" y="304" text-anchor="middle" fill="#888" font-size="10">10.10.x.x | 93 employees | 3 floors</text>

  <!-- BOS: SD-WAN -->
  <g class="hoverable" data-tt-title="MX-BOS-01/02 (HA Pair)" data-tt-body="Meraki MX450 | SD-WAN Hub" data-tt-detail="WAN: Comcast + AT&T|AutoVPN concentrator for ATL + AUS|HA pair: active/passive|Serials: Q2BOS-0001-0001, Q2BOS-0001-0002">
    <rect x="60" y="316" width="185" height="40" rx="5" fill="#1F2833" stroke="#78BE20" stroke-width="1.5"/>
    <text x="152" y="334" text-anchor="middle" fill="#78BE20" font-size="10" font-weight="600">MX-BOS-01/02 (HA)</text>
    <text x="152" y="348" text-anchor="middle" fill="#888" font-size="8">MX450 | SD-WAN Hub</text>
  </g>

  <!-- BOS: Catalyst Switches -->
  <g class="hoverable" data-tt-title="Catalyst 9300 Switches" data-tt-body="CAT-BOS-DIST-01/02 | C9300-48UXM" data-tt-detail="IOS-XE 17.12.4 | Distribution layer|IPs: 10.10.10.30, 10.10.10.31|10 VLANs (mgmt, servers, users, wifi, voice, iot, cameras, guest, infra)|Managed by Catalyst Center">
    <rect x="260" y="316" width="185" height="40" rx="5" fill="#2d1f15" stroke="#FF6B35" stroke-width="1.5"/>
    <text x="352" y="334" text-anchor="middle" fill="#FF6B35" font-size="10" font-weight="600">Catalyst 9300 x2</text>
    <text x="352" y="348" text-anchor="middle" fill="#888" font-size="8">C9300-48UXM | Distribution</text>
  </g>

  <!-- BOS: ACI Fabric -->
  <g class="hoverable" data-tt-title="ACI Fabric (Boston Pod)" data-tt-body="APIC-BOS-01 | 2 Spines + 4 Leafs" data-tt-detail="APIC: 10.10.10.20 | Spine: N9K-C9336C-FX2|Leafs: N9K-C93180YC-FX (nodes 201-204)|5 EPGs: Servers, DBServers, WebDMZ, Management, Backup|Sourcetypes: cisco:aci:fault, event, audit">
    <rect x="60" y="366" width="185" height="40" rx="5" fill="#2d1f15" stroke="#FF6B35" stroke-width="1.5"/>
    <text x="152" y="384" text-anchor="middle" fill="#FF6B35" font-size="10" font-weight="600">ACI Fabric</text>
    <text x="152" y="398" text-anchor="middle" fill="#888" font-size="8">2 Spine + 4 Leaf | APIC</text>
  </g>

  <!-- BOS: Meraki Access -->
  <g class="hoverable" data-tt-title="Meraki Access (Boston)" data-tt-body="16 MR46 APs | 5 MS Switches" data-tt-detail="APs: Floor 1 (5), Floor 2 (5), Floor 3 (6)|Switches: 2x MS425-32 (core) + 3x MS225-48 (access)|SSIDs: FakeTShirtCo-Corp, Guest, IoT, Voice|8 MV cameras + 5 MT sensors">
    <rect x="260" y="366" width="185" height="40" rx="5" fill="#1F2833" stroke="#78BE20" stroke-width="1"/>
    <text x="352" y="384" text-anchor="middle" fill="#78BE20" font-size="10" font-weight="600">Meraki Access</text>
    <text x="352" y="398" text-anchor="middle" fill="#888" font-size="8">16 AP | 5 SW | 8 CAM | 5 SNS</text>
  </g>

  <!-- BOS: Servers -->
  <rect x="60" y="418" width="385" height="200" rx="5" fill="#0d1117" stroke="#333" stroke-width="1"/>
  <text x="72" y="436" fill="#66FCF1" font-size="11" font-weight="600">Servers (10)</text>

  <g class="hoverable" data-tt-title="DC-BOS-01" data-tt-body="Domain Controller | 10.10.20.10" data-tt-detail="Windows Server | AD/DNS/DHCP primary|Kerberos auth for all Boston servers|Scenarios: exfil (credential access)">
    <rect x="72" y="444" width="86" height="28" rx="3" fill="#0a1628" stroke="#0078D4" stroke-width="1"/><text x="115" y="462" text-anchor="middle" fill="#0078D4" font-size="9">DC-BOS-01</text>
  </g>
  <g class="hoverable" data-tt-title="DC-BOS-02" data-tt-body="Domain Controller | 10.10.20.11" data-tt-detail="Windows Server | AD/DNS/DHCP secondary|Replication partner for DC-BOS-01">
    <rect x="166" y="444" width="86" height="28" rx="3" fill="#0a1628" stroke="#0078D4" stroke-width="1"/><text x="209" y="462" text-anchor="middle" fill="#0078D4" font-size="9">DC-BOS-02</text>
  </g>
  <g class="hoverable" data-tt-title="FILE-BOS-01" data-tt-body="File Server | 10.10.20.20" data-tt-detail="Windows Server | SMB file shares|Exfil scenario: data staging target">
    <rect x="260" y="444" width="86" height="28" rx="3" fill="#0a1628" stroke="#0078D4" stroke-width="1"/><text x="303" y="462" text-anchor="middle" fill="#0078D4" font-size="9">FILE-BOS-01</text>
  </g>
  <g class="hoverable" data-tt-title="SQL-PROD-01" data-tt-body="SQL Database | 10.10.20.30" data-tt-detail="Windows Server | MSSQL production DB|Scenario: cpu_runaway (Days 11-12) backup job stuck|Generator: generate_mssql.py | mssql:errorlog">
    <rect x="354" y="444" width="82" height="28" rx="3" fill="#0a1628" stroke="#0078D4" stroke-width="1.5"/><text x="395" y="462" text-anchor="middle" fill="#0078D4" font-size="9">SQL-PROD-01</text>
  </g>
  <g class="hoverable" data-tt-title="APP-BOS-01" data-tt-body="e-Commerce API | 10.10.20.40" data-tt-detail="Windows Server | IIS/.NET API server|Serves WEB-01/02 via HTTP API">
    <rect x="72" y="480" width="86" height="28" rx="3" fill="#0a1628" stroke="#0078D4" stroke-width="1"/><text x="115" y="498" text-anchor="middle" fill="#0078D4" font-size="9">APP-BOS-01</text>
  </g>
  <g class="hoverable" data-tt-title="SAP-PROD-01" data-tt-body="SAP Application Server | 10.10.20.60" data-tt-detail="Linux (SUSE) | SAP S/4HANA application|Generator: generate_sap.py | sap:auditlog">
    <rect x="166" y="480" width="86" height="28" rx="3" fill="#1a0d05" stroke="#E95420" stroke-width="1"/><text x="209" y="498" text-anchor="middle" fill="#E95420" font-size="9">SAP-PROD-01</text>
  </g>
  <g class="hoverable" data-tt-title="SAP-DB-01" data-tt-body="SAP HANA Database | 10.10.20.61" data-tt-detail="Linux (SUSE) | In-memory HANA DB|Paired with SAP-PROD-01">
    <rect x="260" y="480" width="86" height="28" rx="3" fill="#1a0d05" stroke="#E95420" stroke-width="1"/><text x="303" y="498" text-anchor="middle" fill="#E95420" font-size="9">SAP-DB-01</text>
  </g>
  <g class="hoverable" data-tt-title="BASTION-BOS-01" data-tt-body="Bastion Host | 10.10.10.10" data-tt-detail="Linux | Management subnet jump box|SSH gateway for all server access">
    <rect x="354" y="480" width="82" height="28" rx="3" fill="#1a0d05" stroke="#E95420" stroke-width="1"/><text x="395" y="498" text-anchor="middle" fill="#E95420" font-size="8">BASTION-01</text>
  </g>
  <g class="hoverable" data-tt-title="WEB-01 (DMZ)" data-tt-body="Web Server | 172.16.1.10" data-tt-detail="Linux (Ubuntu) | Apache httpd|Public: 203.0.113.10 (NAT)|Scenarios: memory_leak (Days 7-10), ddos_attack (Days 18-19)|Generator: generate_access.py, generate_linux.py">
    <rect x="72" y="516" width="86" height="28" rx="3" fill="#1a0d05" stroke="#E95420" stroke-width="1.5"/><text x="115" y="534" text-anchor="middle" fill="#E95420" font-size="9">WEB-01</text>
  </g>
  <g class="hoverable" data-tt-title="WEB-02 (DMZ)" data-tt-body="Web Server | 172.16.1.11" data-tt-detail="Linux (Ubuntu) | Apache httpd|Public: 203.0.113.11 (NAT)|Secondary web server">
    <rect x="166" y="516" width="86" height="28" rx="3" fill="#1a0d05" stroke="#E95420" stroke-width="1"/><text x="209" y="534" text-anchor="middle" fill="#E95420" font-size="9">WEB-02</text>
  </g>

  <!-- BOS: Webex -->
  <g class="hoverable" data-tt-title="Webex Rooms (Boston)" data-tt-body="10 meeting rooms | Floors 1-3" data-tt-detail="Boardroom: Link (20p, Room Kit Pro + Board 85 Pro)|Conference: Zelda (12p), Mario (10p), Samus (8p), Luigi (8p)|Huddle: Yoshi (6p), Kirby (4p, PROBLEM ROOM)|Lab: Sonic (8p) | Visitor: Peach (6p), Toad (4p)">
    <rect x="60" y="630" width="185" height="36" rx="5" fill="#1F2833" stroke="#00BCF2" stroke-width="1"/>
    <text x="152" y="652" text-anchor="middle" fill="#00BCF2" font-size="10" font-weight="600">10 Webex Rooms</text>
  </g>

  <!-- BOS: Key Users -->
  <g class="hoverable" data-tt-title="Key Users (Boston)" data-tt-body="alex.miller (target) | CEO, CFO, CTO" data-tt-detail="alex.miller: Sr. Financial Analyst, Floor 2 | 10.10.30.55|john.smith: CEO, Floor 3 | sarah.wilson: CFO, Floor 2|mike.johnson: CTO, Floor 3|Primary exfil target: alex.miller">
    <rect x="260" y="630" width="185" height="36" rx="5" fill="#1F2833" stroke="#FF4444" stroke-width="1" stroke-dasharray="4,2"/>
    <text x="352" y="648" text-anchor="middle" fill="#C5C6C7" font-size="10">alex.miller</text>
    <text x="352" y="660" text-anchor="middle" fill="#FF8888" font-size="8">Primary Target (exfil)</text>
  </g>

  <!-- BOS: Meraki sensor counts -->
  <text x="72" y="560" fill="#888" font-size="9">Windows: 6 | Linux: 4</text>
  <text x="72" y="574" fill="#888" font-size="9">DMZ: WEB-01/02 | Mgmt: BASTION-01</text>

  <!-- ── ATLANTA HUB ── -->
  <rect x="540" y="268" width="360" height="530" rx="8" fill="#111822" stroke="#45A29E" stroke-width="1.5"/>
  <text x="720" y="290" text-anchor="middle" fill="#66FCF1" font-size="14" font-weight="700">ATLANTA HUB</text>
  <text x="720" y="304" text-anchor="middle" fill="#888" font-size="10">10.20.x.x | 43 employees | 2 floors</text>

  <!-- ATL: SD-WAN -->
  <g class="hoverable" data-tt-title="MX-ATL-01" data-tt-body="Meraki MX250 | SD-WAN Spoke" data-tt-detail="WAN: AT&T + Spectrum|AutoVPN to Boston hub|Serial: Q2ATL-0001-0001">
    <rect x="560" y="316" width="160" height="40" rx="5" fill="#1F2833" stroke="#78BE20" stroke-width="1.5"/>
    <text x="640" y="334" text-anchor="middle" fill="#78BE20" font-size="10" font-weight="600">MX-ATL-01</text>
    <text x="640" y="348" text-anchor="middle" fill="#888" font-size="8">MX250 | SD-WAN Spoke</text>
  </g>

  <!-- ATL: Catalyst -->
  <g class="hoverable" data-tt-title="Catalyst 9300 Switch" data-tt-body="CAT-ATL-DIST-01 | C9300-48UXM" data-tt-detail="IOS-XE 17.12.4 | Distribution|IP: 10.20.10.30 | 8 VLANs|Managed by Catalyst Center (BOS)">
    <rect x="735" y="316" width="150" height="40" rx="5" fill="#2d1f15" stroke="#FF6B35" stroke-width="1.5"/>
    <text x="810" y="334" text-anchor="middle" fill="#FF6B35" font-size="10" font-weight="600">Catalyst 9300</text>
    <text x="810" y="348" text-anchor="middle" fill="#888" font-size="8">C9300-48UXM | Distribution</text>
  </g>

  <!-- ATL: ACI Mini-Pod -->
  <g class="hoverable" data-tt-title="ACI Mini-Pod (Atlanta)" data-tt-body="1 Spine + 2 Leafs | Multi-site" data-tt-detail="Spine: SPINE-ATL-01 (N9K-C9332C, node 301)|Leafs: LEAF-ATL-01/02 (N9K-C93180YC-FX)|3 EPGs: ATLServers, ATLBackup, ATLMonitor|Managed by APIC-BOS-01 (multi-site)">
    <rect x="560" y="366" width="160" height="40" rx="5" fill="#2d1f15" stroke="#FF6B35" stroke-width="1"/>
    <text x="640" y="384" text-anchor="middle" fill="#FF6B35" font-size="10" font-weight="600">ACI Mini-Pod</text>
    <text x="640" y="398" text-anchor="middle" fill="#888" font-size="8">1 Spine + 2 Leaf</text>
  </g>

  <!-- ATL: Meraki Access -->
  <g class="hoverable" data-tt-title="Meraki Access (Atlanta)" data-tt-body="12 MR46 APs | 4 MS Switches" data-tt-detail="APs: Floor 1 (6), Floor 2 (6)|Switches: 2x MS425-32 (DC core) + 2x MS225-48 (access)|7 MV cameras + 7 MT sensors (DC focused)">
    <rect x="735" y="366" width="150" height="40" rx="5" fill="#1F2833" stroke="#78BE20" stroke-width="1"/>
    <text x="810" y="384" text-anchor="middle" fill="#78BE20" font-size="10" font-weight="600">Meraki Access</text>
    <text x="810" y="398" text-anchor="middle" fill="#888" font-size="8">12 AP | 4 SW | 7 CAM | 7 SNS</text>
  </g>

  <!-- ATL: Servers -->
  <rect x="560" y="418" width="325" height="110" rx="5" fill="#0d1117" stroke="#333" stroke-width="1"/>
  <text x="572" y="436" fill="#66FCF1" font-size="11" font-weight="600">Servers (3)</text>

  <g class="hoverable" data-tt-title="DC-ATL-01" data-tt-body="Domain Controller | 10.20.20.10" data-tt-detail="Windows Server | AD/DNS for Atlanta|Replicates with DC-BOS-01/02">
    <rect x="572" y="444" width="93" height="28" rx="3" fill="#0a1628" stroke="#0078D4" stroke-width="1"/><text x="618" y="462" text-anchor="middle" fill="#0078D4" font-size="9">DC-ATL-01</text>
  </g>
  <g class="hoverable" data-tt-title="BACKUP-ATL-01" data-tt-body="Backup Server | 10.20.20.20" data-tt-detail="Windows Server | Veeam backup target|Cross-site backup from SQL-PROD-01 (BOS)">
    <rect x="672" y="444" width="100" height="28" rx="3" fill="#0a1628" stroke="#0078D4" stroke-width="1"/><text x="722" y="462" text-anchor="middle" fill="#0078D4" font-size="8">BACKUP-ATL-01</text>
  </g>
  <g class="hoverable" data-tt-title="MON-ATL-01" data-tt-body="Monitoring Server | 10.20.20.30" data-tt-detail="Linux | Nagios/Grafana monitoring|Scenario: disk_filling (Days 1-5), 45% -> 98%|Generator: generate_linux.py">
    <rect x="780" y="444" width="93" height="28" rx="3" fill="#1a0d05" stroke="#E95420" stroke-width="1.5"/><text x="826" y="462" text-anchor="middle" fill="#E95420" font-size="9">MON-ATL-01</text>
  </g>
  <text x="572" y="496" fill="#888" font-size="9">Windows: 2 | Linux: 1</text>

  <!-- ATL: Webex -->
  <g class="hoverable" data-tt-title="Webex Rooms (Atlanta)" data-tt-body="7 meeting rooms | Floors 1-2" data-tt-detail="Training: Cortana (16p, PROBLEM ROOM)|Conference: Chief (10p), Kratos (8p), Lara (8p)|Operations: Ryu (6p)|Huddle: Pikachu (4p), Megaman (4p)">
    <rect x="560" y="540" width="160" height="36" rx="5" fill="#1F2833" stroke="#00BCF2" stroke-width="1"/>
    <text x="640" y="562" text-anchor="middle" fill="#00BCF2" font-size="10" font-weight="600">7 Webex Rooms</text>
  </g>

  <!-- ATL: Key User -->
  <g class="hoverable" data-tt-title="jessica.brown" data-tt-body="IT Administrator | Atlanta Floor 1" data-tt-detail="IP: 10.20.30.15 | ATL-WS-JBROWN01|Initial compromise in exfil scenario (Day 5)|Clicks phishing link -> credential theft">
    <rect x="735" y="540" width="150" height="36" rx="5" fill="#1F2833" stroke="#FF4444" stroke-width="1" stroke-dasharray="4,2"/>
    <text x="810" y="558" text-anchor="middle" fill="#C5C6C7" font-size="10">jessica.brown</text>
    <text x="810" y="570" text-anchor="middle" fill="#FF8888" font-size="8">Initial Compromise (exfil)</text>
  </g>

  <!-- ── AUSTIN OFFICE ── -->
  <rect x="980" y="268" width="420" height="530" rx="8" fill="#111822" stroke="#45A29E" stroke-width="1.5"/>
  <text x="1190" y="290" text-anchor="middle" fill="#66FCF1" font-size="14" font-weight="700">AUSTIN OFFICE</text>
  <text x="1190" y="304" text-anchor="middle" fill="#888" font-size="10">10.30.x.x | 39 employees | 1 floor</text>

  <!-- AUS: SD-WAN -->
  <g class="hoverable" data-tt-title="MX-AUS-01" data-tt-body="Meraki MX85 | SD-WAN Spoke" data-tt-detail="WAN: Verizon|AutoVPN to Boston hub|Serial: Q2AUS-0001-0001|Smallest site, branch-only">
    <rect x="1000" y="316" width="185" height="40" rx="5" fill="#1F2833" stroke="#78BE20" stroke-width="1.5"/>
    <text x="1092" y="334" text-anchor="middle" fill="#78BE20" font-size="10" font-weight="600">MX-AUS-01</text>
    <text x="1092" y="348" text-anchor="middle" fill="#888" font-size="8">MX85 | SD-WAN Spoke</text>
  </g>

  <!-- AUS: Meraki Access -->
  <g class="hoverable" data-tt-title="Meraki Access (Austin)" data-tt-body="8 MR46 APs | 2 MS Switches" data-tt-detail="APs: 8 on Floor 1|Switches: 1x MS250-48 (core) + 1x MS225-24 (access)|4 MV cameras + 2 MT sensors|No Catalyst / No ACI (branch only)">
    <rect x="1200" y="316" width="185" height="40" rx="5" fill="#1F2833" stroke="#78BE20" stroke-width="1"/>
    <text x="1292" y="334" text-anchor="middle" fill="#78BE20" font-size="10" font-weight="600">Meraki Access</text>
    <text x="1292" y="398" text-anchor="middle" fill="#888" font-size="8">8 AP | 2 SW | 4 CAM | 2 SNS</text>
  </g>

  <!-- AUS: No servers -->
  <rect x="1000" y="380" width="385" height="50" rx="5" fill="#0d1117" stroke="#333" stroke-width="1" stroke-dasharray="4,3"/>
  <text x="1192" y="400" text-anchor="middle" fill="#888" font-size="11">No Local Servers</text>
  <text x="1192" y="416" text-anchor="middle" fill="#666" font-size="9">All services via SD-WAN to Boston/Atlanta</text>

  <!-- AUS: Webex -->
  <g class="hoverable" data-tt-title="Webex Rooms (Austin)" data-tt-body="4 meeting rooms | Floor 1" data-tt-detail="Conference: Doom (12p, sunny room +5C), Crash (8p)|Demo: Jett (8p)|Huddle: Fox (6p)">
    <rect x="1000" y="450" width="185" height="36" rx="5" fill="#1F2833" stroke="#00BCF2" stroke-width="1"/>
    <text x="1092" y="472" text-anchor="middle" fill="#00BCF2" font-size="10" font-weight="600">4 Webex Rooms</text>
  </g>

  <!-- AUS: Key User -->
  <g class="hoverable" data-tt-title="brooklyn.white" data-tt-body="Sales Engineer | Austin Floor 1" data-tt-detail="IP: 10.30.30.20|Ransomware target (Days 8-9)|Phishing email -> EDR blocks in 10 minutes">
    <rect x="1200" y="450" width="185" height="36" rx="5" fill="#1F2833" stroke="#FF4444" stroke-width="1" stroke-dasharray="4,2"/>
    <text x="1292" y="468" text-anchor="middle" fill="#C5C6C7" font-size="10">brooklyn.white</text>
    <text x="1292" y="480" text-anchor="middle" fill="#FF8888" font-size="8">Ransomware Target</text>
  </g>

  <!-- AUS: No Catalyst/ACI note -->
  <text x="1192" y="520" text-anchor="middle" fill="#666" font-size="9" font-style="italic">No Catalyst switches or ACI (branch office)</text>

  <!-- ===== CONNECTIONS (Orthogonal routing via backbone) ===== -->

  <!-- Backbone to Boston (vertical stub) -->
  <path d="M 250,248 L 250,268" stroke="#45A29E" stroke-width="1.5"/>
  <!-- Backbone to Atlanta (vertical stub) -->
  <path d="M 720,248 L 720,268" stroke="#45A29E" stroke-width="1.5"/>
  <!-- Backbone to Austin (vertical stub) -->
  <path d="M 1190,248 L 1190,268" stroke="#45A29E" stroke-width="1.5"/>

  <!-- ASA to backbone center -->
  <!-- (already connected via line at y=194 to y=218) -->

  <!-- AutoVPN mesh lines (dashed green, horizontal in backbone) -->
  <line x1="250" y1="233" x2="720" y2="233" stroke="#78BE20" stroke-width="1" stroke-dasharray="5,3" opacity="0.5"/>
  <line x1="720" y1="233" x2="1190" y2="233" stroke="#78BE20" stroke-width="1" stroke-dasharray="5,3" opacity="0.5"/>

  <!-- Catalyst Center management to switches (orthogonal) -->
  <path d="M 1130,194 L 1130,210 L 352,210 L 352,316" stroke="#FF6B35" stroke-width="1" stroke-dasharray="4,3" opacity="0.5" marker-end="url(#arrow-mgmt)"/>
  <path d="M 1130,210 L 810,210 L 810,316" stroke="#FF6B35" stroke-width="1" stroke-dasharray="4,3" opacity="0.5" marker-end="url(#arrow-mgmt)"/>

  <!-- ===== LAYER 6: LOG GENERATORS (HTML below SVG) ===== -->
</svg>

<!-- Log Generators Legend (below SVG for richer formatting) -->
<div style="margin-top:20px;">
  <div class="section-title">24 Log Generators</div>
  <div class="gen-grid">
    <div class="gen-item"><span class="gen-name">Cisco ASA</span> - cisco:asa</div>
    <div class="gen-item"><span class="gen-name">Meraki MX/MR/MS/MV/MT</span> - meraki:*</div>
    <div class="gen-item"><span class="gen-name">Cisco Catalyst</span> - cisco:ios</div>
    <div class="gen-item"><span class="gen-name">Cisco ACI</span> - cisco:aci:*</div>
    <div class="gen-item"><span class="gen-name">Cisco Secure Access</span> - cisco:umbrella:*</div>
    <div class="gen-item"><span class="gen-name">Catalyst Center</span> - cisco:catalyst:*</div>
    <div class="gen-item"><span class="gen-name">AWS CloudTrail</span> - aws:cloudtrail</div>
    <div class="gen-item"><span class="gen-name">GCP Audit</span> - google:gcp:pubsub:message</div>
    <div class="gen-item"><span class="gen-name">Entra ID</span> - azure:aad:signin/audit</div>
    <div class="gen-item"><span class="gen-name">Exchange Online</span> - ms:o365:*</div>
    <div class="gen-item"><span class="gen-name">Office 365 Audit</span> - o365:management:activity</div>
    <div class="gen-item"><span class="gen-name">Cisco Webex</span> - cisco:webex:*</div>
    <div class="gen-item"><span class="gen-name">Webex TA</span> - cisco:webex:meetings:history</div>
    <div class="gen-item"><span class="gen-name">Webex API</span> - cisco:webex:* (5 types)</div>
    <div class="gen-item"><span class="gen-name">WinEventLog</span> - XmlWinEventLog</div>
    <div class="gen-item"><span class="gen-name">Sysmon</span> - XmlWinEventLog:Sysmon</div>
    <div class="gen-item"><span class="gen-name">Perfmon</span> - perfmon</div>
    <div class="gen-item"><span class="gen-name">MSSQL</span> - mssql:errorlog</div>
    <div class="gen-item"><span class="gen-name">Linux</span> - linux:* (vmstat/df/iostat/auth)</div>
    <div class="gen-item"><span class="gen-name">Apache Access</span> - access_combined</div>
    <div class="gen-item"><span class="gen-name">Orders</span> - retail:orders</div>
    <div class="gen-item"><span class="gen-name">ServiceBus</span> - azure:servicebus</div>
    <div class="gen-item"><span class="gen-name">SAP S/4HANA</span> - sap:auditlog</div>
    <div class="gen-item"><span class="gen-name">ServiceNow</span> - servicenow:incident</div>
  </div>
</div>
</div><!-- /diagram -->
</div><!-- /tab-overview -->

<!-- ========== TAB: SERVER CONNECTIONS ========== -->
<div id="tab-connections" class="tab-content">
<div class="diagram">
<svg viewBox="0 0 1440 1000" xmlns="http://www.w3.org/2000/svg" style="width:100%; height:auto;">
  <defs>
    <marker id="c-arrow" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#45A29E"/></marker>
    <marker id="c-arrow-win" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#0078D4"/></marker>
    <marker id="c-arrow-linux" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#E95420"/></marker>
    <marker id="c-arrow-data" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#FFD700"/></marker>
    <marker id="c-arrow-mgmt" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#FF6B35"/></marker>
  </defs>

  <!-- Legend for this diagram -->
  <text x="40" y="25" fill="#66FCF1" font-size="16" font-weight="700">Server Connections &amp; Data Flows</text>
  <text x="40" y="42" fill="#888" font-size="10">Logical connections between servers, showing authentication, data flows, and management paths</text>

  <!-- ===== INTERNET + PERIMETER (y=60-130) ===== -->
  <rect x="580" y="60" width="280" height="36" rx="5" fill="#1F2833" stroke="#C5C6C7" stroke-width="1"/>
  <text x="720" y="83" text-anchor="middle" fill="#C5C6C7" font-size="12" font-weight="600">INTERNET</text>

  <!-- ASA -->
  <g class="hoverable" data-tt-title="FW-EDGE-01" data-tt-body="Cisco ASA 5525-X | 203.0.113.1" data-tt-detail="ALL external traffic|NAT: 203.0.113.10 -> WEB-01, 203.0.113.11 -> WEB-02">
    <rect x="580" y="110" width="280" height="40" rx="5" fill="#1F2833" stroke="#45A29E" stroke-width="2"/>
    <text x="720" y="130" text-anchor="middle" fill="#66FCF1" font-size="12" font-weight="700">FW-EDGE-01</text>
    <text x="720" y="144" text-anchor="middle" fill="#888" font-size="9">ASA 5525-X | Perimeter | 203.0.113.1</text>
  </g>
  <line x1="720" y1="96" x2="720" y2="110" stroke="#45A29E" stroke-width="1.5" marker-end="url(#c-arrow)"/>

  <!-- Secure Access (cloud proxy) -->
  <g class="hoverable" data-tt-title="Cisco Secure Access" data-tt-body="Cloud-delivered security" data-tt-detail="DNS Security + SWG Proxy + Cloud Firewall|All user internet-bound traffic">
    <rect x="160" y="110" width="200" height="40" rx="5" fill="#2d1f15" stroke="#FF6B35" stroke-width="1.5"/>
    <text x="260" y="130" text-anchor="middle" fill="#FF6B35" font-size="11" font-weight="600">Cisco Secure Access</text>
    <text x="260" y="144" text-anchor="middle" fill="#888" font-size="9">DNS + SWG + CFFW</text>
  </g>
  <path d="M 360,130 L 580,130" stroke="#FF6B35" stroke-width="1" stroke-dasharray="4,3" opacity="0.5"/>

  <!-- ===== DMZ ZONE (y=170-230) ===== -->
  <rect x="60" y="170" width="340" height="60" rx="6" fill="#111822" stroke="#45A29E" stroke-width="1" stroke-dasharray="5,3"/>
  <text x="75" y="186" fill="#45A29E" font-size="10" font-weight="600">DMZ 172.16.1.0/24</text>

  <g class="hoverable" data-tt-title="WEB-01" data-tt-body="172.16.1.10 | Linux/Apache" data-tt-detail="Public: 203.0.113.10|Scenarios: memory_leak, ddos_attack, dead_letter_pricing|Generators: access, linux, orders, servicebus">
    <rect x="80" y="195" width="120" height="28" rx="4" fill="#1a0d05" stroke="#E95420" stroke-width="1.5"/>
    <text x="140" y="213" text-anchor="middle" fill="#E95420" font-size="10" font-weight="600">WEB-01</text>
  </g>
  <g class="hoverable" data-tt-title="WEB-02" data-tt-body="172.16.1.11 | Linux/Apache" data-tt-detail="Public: 203.0.113.11|Secondary web server">
    <rect x="220" y="195" width="120" height="28" rx="4" fill="#1a0d05" stroke="#E95420" stroke-width="1"/>
    <text x="280" y="213" text-anchor="middle" fill="#E95420" font-size="10" font-weight="600">WEB-02</text>
  </g>

  <!-- ASA to DMZ -->
  <path d="M 580,130 L 400,130 L 400,195 L 340,195" stroke="#45A29E" stroke-width="1.5" marker-end="url(#c-arrow)"/>

  <!-- ASA to Bastion (VPN/SSH management access) -->
  <path d="M 860,140 L 1105,140 L 1105,375" stroke="#45A29E" stroke-width="1.5" marker-end="url(#c-arrow)"/>
  <text x="970" y="135" fill="#45A29E" font-size="8" font-weight="600">VPN / SSH</text>

  <!-- ===== BOSTON CORE SERVERS (y=280-500) ===== -->
  <!-- Background box drawn first so all servers render on top -->
  <rect x="400" y="280" width="870" height="220" rx="6" fill="#111822" stroke="#333" stroke-width="1"/>
  <text x="415" y="297" fill="#66FCF1" font-size="11" font-weight="600">BOSTON CORE (10.10.20.x)</text>

  <!-- ===== AD AUTH BUS-BAR (y=252-265) ===== -->
  <rect x="420" y="252" width="730" height="14" rx="3" fill="#0a1628" stroke="#0078D4" stroke-width="1" opacity="0.6"/>
  <text x="785" y="263" text-anchor="middle" fill="#0078D4" font-size="8" font-weight="600">AD / Kerberos / LDAP Authentication Bus</text>

  <!-- DC-BOS-01 feeds the auth bus -->
  <g class="hoverable" data-tt-title="DC-BOS-01" data-tt-body="Domain Controller | 10.10.20.10" data-tt-detail="Primary AD/DNS/DHCP|Kerberos auth for all domain-joined servers|Replication: DC-BOS-02, DC-ATL-01">
    <rect x="420" y="310" width="150" height="45" rx="5" fill="#0a1628" stroke="#0078D4" stroke-width="2"/>
    <text x="495" y="330" text-anchor="middle" fill="#0078D4" font-size="11" font-weight="700">DC-BOS-01</text>
    <text x="495" y="346" text-anchor="middle" fill="#888" font-size="9">10.10.20.10 | AD Primary</text>
  </g>
  <line x1="495" y1="310" x2="495" y2="266" stroke="#0078D4" stroke-width="1.5"/>

  <g class="hoverable" data-tt-title="DC-BOS-02" data-tt-body="Domain Controller | 10.10.20.11" data-tt-detail="Secondary AD|Replication partner for DC-BOS-01">
    <rect x="420" y="365" width="150" height="35" rx="5" fill="#0a1628" stroke="#0078D4" stroke-width="1"/>
    <text x="495" y="387" text-anchor="middle" fill="#0078D4" font-size="10">DC-BOS-02 | 10.10.20.11</text>
  </g>
  <!-- DC replication -->
  <line x1="495" y1="355" x2="495" y2="365" stroke="#0078D4" stroke-width="1" stroke-dasharray="3,2"/>

  <!-- Row 1: Windows servers -->
  <g class="hoverable" data-tt-title="SQL-PROD-01" data-tt-body="SQL Database | 10.10.20.30" data-tt-detail="Windows Server | MSSQL|Scenario: cpu_runaway (Days 11-12)|Backup job stuck -> 100% CPU -> cascading failures|Generator: generate_mssql.py">
    <rect x="610" y="310" width="150" height="45" rx="5" fill="#0a1628" stroke="#0078D4" stroke-width="1.5"/>
    <text x="685" y="330" text-anchor="middle" fill="#0078D4" font-size="11" font-weight="600">SQL-PROD-01</text>
    <text x="685" y="346" text-anchor="middle" fill="#888" font-size="9">10.10.20.30 | MSSQL</text>
  </g>
  <g class="hoverable" data-tt-title="APP-BOS-01" data-tt-body="e-Commerce API | 10.10.20.40" data-tt-detail="Windows Server | IIS/.NET|API backend for WEB-01/02">
    <rect x="820" y="310" width="150" height="45" rx="5" fill="#0a1628" stroke="#0078D4" stroke-width="1.5"/>
    <text x="895" y="330" text-anchor="middle" fill="#0078D4" font-size="11" font-weight="600">APP-BOS-01</text>
    <text x="895" y="346" text-anchor="middle" fill="#888" font-size="9">10.10.20.40 | IIS/.NET</text>
  </g>
  <g class="hoverable" data-tt-title="FILE-BOS-01" data-tt-body="File Server | 10.10.20.20" data-tt-detail="Windows Server | SMB shares|Exfil scenario: data staging">
    <rect x="1030" y="310" width="150" height="45" rx="5" fill="#0a1628" stroke="#0078D4" stroke-width="1.5"/>
    <text x="1105" y="330" text-anchor="middle" fill="#0078D4" font-size="11" font-weight="600">FILE-BOS-01</text>
    <text x="1105" y="346" text-anchor="middle" fill="#888" font-size="9">10.10.20.20 | SMB</text>
  </g>

  <!-- Row 2: Linux servers -->
  <g class="hoverable" data-tt-title="SAP-PROD-01" data-tt-body="SAP Application Server | 10.10.20.60" data-tt-detail="Linux (SUSE) | S/4HANA app layer|Generator: generate_sap.py | sap:auditlog">
    <rect x="610" y="375" width="150" height="40" rx="5" fill="#1a0d05" stroke="#E95420" stroke-width="1.5"/>
    <text x="685" y="395" text-anchor="middle" fill="#E95420" font-size="11" font-weight="600">SAP-PROD-01</text>
    <text x="685" y="409" text-anchor="middle" fill="#888" font-size="9">10.10.20.60 | S/4HANA</text>
  </g>
  <g class="hoverable" data-tt-title="SAP-DB-01" data-tt-body="SAP HANA Database | 10.10.20.61" data-tt-detail="Linux (SUSE) | In-memory HANA DB|Paired with SAP-PROD-01">
    <rect x="820" y="375" width="150" height="40" rx="5" fill="#1a0d05" stroke="#E95420" stroke-width="1"/>
    <text x="895" y="395" text-anchor="middle" fill="#E95420" font-size="11" font-weight="600">SAP-DB-01</text>
    <text x="895" y="409" text-anchor="middle" fill="#888" font-size="9">10.10.20.61 | HANA</text>
  </g>
  <g class="hoverable" data-tt-title="BASTION-BOS-01" data-tt-body="Bastion Host | 10.10.10.10" data-tt-detail="Linux | Management subnet|SSH jump box for all Boston Core servers">
    <rect x="1030" y="375" width="150" height="40" rx="5" fill="#1a0d05" stroke="#E95420" stroke-width="1.5"/>
    <text x="1105" y="395" text-anchor="middle" fill="#E95420" font-size="11" font-weight="600">BASTION-BOS-01</text>
    <text x="1105" y="409" text-anchor="middle" fill="#888" font-size="9">10.10.10.10 | SSH GW</text>
  </g>

  <!-- Auth bus stubs (vertical lines from bus to each server) -->
  <line x1="685" y1="266" x2="685" y2="310" stroke="#0078D4" stroke-width="1" opacity="0.4"/>
  <line x1="895" y1="266" x2="895" y2="310" stroke="#0078D4" stroke-width="1" opacity="0.4"/>
  <line x1="1105" y1="266" x2="1105" y2="310" stroke="#0078D4" stroke-width="1" opacity="0.4"/>

  <!-- Bastion SSH management bus (horizontal bar below row 2) -->
  <rect x="490" y="430" width="540" height="10" rx="3" fill="#0a1628" stroke="#45A29E" stroke-width="1" opacity="0.4"/>
  <text x="760" y="455" text-anchor="middle" fill="#45A29E" font-size="7" opacity="0.6">SSH Management Bus</text>
  <!-- Bastion feeds the SSH bus -->
  <line x1="1105" y1="415" x2="1105" y2="430" stroke="#45A29E" stroke-width="1.5" opacity="0.6"/>
  <!-- SSH stubs up to each server column -->
  <line x1="685" y1="430" x2="685" y2="415" stroke="#45A29E" stroke-width="1" stroke-dasharray="4,3" opacity="0.4" marker-end="url(#c-arrow)"/>
  <line x1="895" y1="430" x2="895" y2="415" stroke="#45A29E" stroke-width="1" stroke-dasharray="4,3" opacity="0.4" marker-end="url(#c-arrow)"/>
  <line x1="495" y1="430" x2="495" y2="400" stroke="#45A29E" stroke-width="1" stroke-dasharray="4,3" opacity="0.4" marker-end="url(#c-arrow)"/>

  <!-- ===== DATA FLOW ARROWS ===== -->
  <!-- WEB-01 -> APP-BOS-01 (HTTP API) -->
  <path d="M 200,209 L 210,209 L 210,240 L 895,240 L 895,310" stroke="#FFD700" stroke-width="1.5" marker-end="url(#c-arrow-data)"/>
  <text x="550" y="236" fill="#FFD700" font-size="8" font-weight="600">HTTP API</text>

  <!-- APP -> SQL (DB queries) -->
  <path d="M 820,332 L 760,332" stroke="#FFD700" stroke-width="1.5" marker-end="url(#c-arrow-data)"/>
  <text x="788" y="325" fill="#FFD700" font-size="8">SQL</text>

  <!-- APP -> FILE (SMB) -->
  <path d="M 970,332 L 1030,332" stroke="#FFD700" stroke-width="1" marker-end="url(#c-arrow-data)"/>
  <text x="998" y="325" fill="#FFD700" font-size="8">SMB</text>

  <!-- SAP-PROD -> SAP-DB -->
  <path d="M 760,395 L 820,395" stroke="#FFD700" stroke-width="1.5" marker-end="url(#c-arrow-data)"/>
  <text x="788" y="390" fill="#FFD700" font-size="8">HANA</text>

  <!-- ===== ATLANTA SECTION (y=530-650) ===== -->
  <rect x="60" y="530" width="540" height="120" rx="6" fill="#111822" stroke="#333" stroke-width="1"/>
  <text x="75" y="550" fill="#66FCF1" font-size="11" font-weight="600">ATLANTA HUB (10.20.20.x)</text>

  <g class="hoverable" data-tt-title="DC-ATL-01" data-tt-body="Domain Controller | 10.20.20.10" data-tt-detail="Windows Server | AD/DNS for Atlanta|Replicates with DC-BOS-01/02">
    <rect x="80" y="560" width="140" height="40" rx="5" fill="#0a1628" stroke="#0078D4" stroke-width="1"/>
    <text x="150" y="580" text-anchor="middle" fill="#0078D4" font-size="10" font-weight="600">DC-ATL-01</text>
    <text x="150" y="594" text-anchor="middle" fill="#888" font-size="9">10.20.20.10</text>
  </g>
  <g class="hoverable" data-tt-title="BACKUP-ATL-01" data-tt-body="Backup Server | 10.20.20.20" data-tt-detail="Windows Server | Veeam|Cross-site backup from SQL-PROD-01">
    <rect x="240" y="560" width="140" height="40" rx="5" fill="#0a1628" stroke="#0078D4" stroke-width="1"/>
    <text x="310" y="580" text-anchor="middle" fill="#0078D4" font-size="10" font-weight="600">BACKUP-ATL-01</text>
    <text x="310" y="594" text-anchor="middle" fill="#888" font-size="9">10.20.20.20</text>
  </g>
  <g class="hoverable" data-tt-title="MON-ATL-01" data-tt-body="Monitoring Server | 10.20.20.30" data-tt-detail="Linux | Nagios/Grafana|Scenario: disk_filling (Days 1-5)|45% -> 98% disk usage">
    <rect x="400" y="560" width="140" height="40" rx="5" fill="#1a0d05" stroke="#E95420" stroke-width="1.5"/>
    <text x="470" y="580" text-anchor="middle" fill="#E95420" font-size="10" font-weight="600">MON-ATL-01</text>
    <text x="470" y="594" text-anchor="middle" fill="#888" font-size="9">10.20.20.30</text>
  </g>

  <!-- DC-ATL to DC-BOS replication (orthogonal) -->
  <path d="M 150,550 L 150,510 L 495,510 L 495,400" stroke="#0078D4" stroke-width="1" stroke-dasharray="4,3" opacity="0.5"/>
  <text x="320" y="505" fill="#0078D4" font-size="8" opacity="0.6">AD Replication</text>

  <!-- BACKUP-ATL to SQL-PROD (backup flow, orthogonal) -->
  <path d="M 310,550 L 310,515 L 685,515 L 685,355" stroke="#FFD700" stroke-width="1" stroke-dasharray="5,3" opacity="0.5"/>
  <text x="500" y="525" fill="#FFD700" font-size="8" opacity="0.6">SQL Backup</text>

  <!-- ===== SD-WAN MESH (y=530-650) ===== -->
  <rect x="640" y="530" width="300" height="120" rx="6" fill="#0d1a0d" stroke="#78BE20" stroke-width="1" stroke-dasharray="5,3"/>
  <text x="655" y="550" fill="#78BE20" font-size="11" font-weight="600">SD-WAN / AutoVPN Mesh</text>

  <g class="hoverable" data-tt-title="MX-BOS-01/02" data-tt-body="MX450 HA | Hub" data-tt-detail="AutoVPN concentrator|WAN: Comcast + AT&T">
    <rect x="660" y="560" width="110" height="36" rx="4" fill="#1F2833" stroke="#78BE20" stroke-width="1.5"/>
    <text x="715" y="582" text-anchor="middle" fill="#78BE20" font-size="10" font-weight="600">MX-BOS (HA)</text>
  </g>
  <g class="hoverable" data-tt-title="MX-ATL-01" data-tt-body="MX250 | Spoke" data-tt-detail="WAN: AT&T + Spectrum">
    <rect x="660" y="605" width="110" height="36" rx="4" fill="#1F2833" stroke="#78BE20" stroke-width="1"/>
    <text x="715" y="627" text-anchor="middle" fill="#78BE20" font-size="10">MX-ATL-01</text>
  </g>
  <g class="hoverable" data-tt-title="MX-AUS-01" data-tt-body="MX85 | Spoke" data-tt-detail="WAN: Verizon">
    <rect x="800" y="560" width="110" height="36" rx="4" fill="#1F2833" stroke="#78BE20" stroke-width="1"/>
    <text x="855" y="582" text-anchor="middle" fill="#78BE20" font-size="10">MX-AUS-01</text>
  </g>

  <!-- VPN mesh lines -->
  <!-- BOS <-> ATL (vertical) -->
  <line x1="715" y1="596" x2="715" y2="605" stroke="#78BE20" stroke-width="1.5" stroke-dasharray="4,3"/>
  <!-- BOS <-> AUS (horizontal) -->
  <line x1="770" y1="578" x2="800" y2="578" stroke="#78BE20" stroke-width="1.5" stroke-dasharray="4,3"/>
  <!-- ATL <-> AUS (L-shape: right from ATL, then up to AUS) -->
  <path d="M 770,623 L 855,623 L 855,596" stroke="#78BE20" stroke-width="1.5" stroke-dasharray="4,3" fill="none"/>

  <!-- ===== AUSTIN (y=530-650) ===== -->
  <rect x="980" y="530" width="420" height="120" rx="6" fill="#111822" stroke="#333" stroke-width="1"/>
  <text x="995" y="550" fill="#66FCF1" font-size="11" font-weight="600">AUSTIN OFFICE (No Local Servers)</text>
  <text x="995" y="568" fill="#888" font-size="10">All services accessed via SD-WAN tunnel to Boston/Atlanta</text>

  <g class="hoverable" data-tt-title="brooklyn.white" data-tt-body="Sales Engineer | 10.30.30.20" data-tt-detail="Ransomware target (Days 8-9)|Phishing -> EDR blocks in 10 min">
    <rect x="1000" y="585" width="180" height="30" rx="4" fill="#1F2833" stroke="#FF4444" stroke-width="1" stroke-dasharray="4,2"/>
    <text x="1090" y="604" text-anchor="middle" fill="#FF8888" font-size="10">brooklyn.white (ransomware target)</text>
  </g>

  <!-- ===== CLOUD DEPENDENCIES (y=690-810) ===== -->
  <rect x="60" y="690" width="1340" height="120" rx="6" fill="none" stroke="#4A90D9" stroke-width="1" stroke-dasharray="6,3" opacity="0.5"/>
  <text x="80" y="710" fill="#4A90D9" font-size="11" font-weight="600">Cloud Dependencies</text>

  <g class="hoverable" data-tt-title="Entra ID / M365" data-tt-body="Identity + Office 365" data-tt-detail="175 users | SSO + MFA|Sourcetypes: azure:aad:signin, audit">
    <rect x="80" y="725" width="170" height="35" rx="4" fill="#1F2833" stroke="#0078D4" stroke-width="1"/>
    <text x="165" y="747" text-anchor="middle" fill="#0078D4" font-size="10" font-weight="600">Entra ID / M365</text>
  </g>
  <g class="hoverable" data-tt-title="AWS" data-tt-body="CloudTrail | us-east-1" data-tt-detail="Account: 123456789012|Buckets: finance-data, backups-prod">
    <rect x="270" y="725" width="140" height="35" rx="4" fill="#1F2833" stroke="#FF9900" stroke-width="1"/>
    <text x="340" y="747" text-anchor="middle" fill="#FF9900" font-size="10" font-weight="600">AWS</text>
  </g>
  <g class="hoverable" data-tt-title="GCP" data-tt-body="Audit Logs | us-central1" data-tt-detail="Project: faketshirtcompany-prod-01">
    <rect x="430" y="725" width="140" height="35" rx="4" fill="#1F2833" stroke="#4285F4" stroke-width="1"/>
    <text x="500" y="747" text-anchor="middle" fill="#4285F4" font-size="10" font-weight="600">GCP</text>
  </g>
  <g class="hoverable" data-tt-title="Exchange Online" data-tt-body="Email for 175 employees" data-tt-detail="Sourcetype: ms:o365:reporting:messagetrace">
    <rect x="590" y="725" width="150" height="35" rx="4" fill="#1F2833" stroke="#0078D4" stroke-width="1"/>
    <text x="665" y="747" text-anchor="middle" fill="#0078D4" font-size="10" font-weight="600">Exchange Online</text>
  </g>
  <g class="hoverable" data-tt-title="ServiceNow" data-tt-body="ITSM - Incident Management" data-tt-detail="Auto-ticket creation on alerts|Sourcetype: servicenow:incident">
    <rect x="760" y="725" width="140" height="35" rx="4" fill="#1F2833" stroke="#81B5A1" stroke-width="1"/>
    <text x="830" y="747" text-anchor="middle" fill="#81B5A1" font-size="10" font-weight="600">ServiceNow</text>
  </g>
  <g class="hoverable" data-tt-title="Cisco Webex" data-tt-body="21 rooms across 3 sites" data-tt-detail="Meetings, quality, device health|Problem rooms: Kirby (BOS), Cortana (ATL)">
    <rect x="920" y="725" width="140" height="35" rx="4" fill="#1F2833" stroke="#00BCF2" stroke-width="1"/>
    <text x="990" y="747" text-anchor="middle" fill="#00BCF2" font-size="10" font-weight="600">Cisco Webex</text>
  </g>
  <g class="hoverable" data-tt-title="Meraki Dashboard" data-tt-body="Cloud-managed network" data-tt-detail="79 devices across 3 sites">
    <rect x="1080" y="725" width="150" height="35" rx="4" fill="#1F2833" stroke="#78BE20" stroke-width="1"/>
    <text x="1155" y="747" text-anchor="middle" fill="#78BE20" font-size="10" font-weight="600">Meraki Dashboard</text>
  </g>

  <!-- Connection legend -->
  <rect x="60" y="830" width="1340" height="60" rx="4" fill="#0d1117" stroke="#333" stroke-width="1"/>
  <text x="80" y="850" fill="#888" font-size="10" font-weight="600">Connection Legend:</text>
  <line x1="80" y1="870" x2="120" y2="870" stroke="#0078D4" stroke-width="1.5"/><text x="130" y="874" fill="#0078D4" font-size="9">AD Auth (Kerberos/LDAP)</text>
  <line x1="320" y1="870" x2="360" y2="870" stroke="#FFD700" stroke-width="1.5"/><text x="370" y="874" fill="#FFD700" font-size="9">Data Flow</text>
  <line x1="520" y1="870" x2="560" y2="870" stroke="#78BE20" stroke-width="1.5" stroke-dasharray="5,3"/><text x="570" y="874" fill="#78BE20" font-size="9">SD-WAN / VPN</text>
  <line x1="730" y1="870" x2="770" y2="870" stroke="#FF6B35" stroke-width="1.5" stroke-dasharray="4,3"/><text x="780" y="874" fill="#FF6B35" font-size="9">Management</text>
  <line x1="930" y1="870" x2="970" y2="870" stroke="#FF4444" stroke-width="1.5" stroke-dasharray="4,3"/><text x="980" y="874" fill="#FF4444" font-size="9">Threat / Attack Path</text>

</svg>
</div><!-- /diagram -->
</div><!-- /tab-connections -->

<!-- ========== TAB: BOSTON HQ ========== -->
<div id="tab-boston" class="tab-content">
  <h2 style="color:var(--accent); margin-bottom:5px;">Boston HQ</h2>
  <p style="color:var(--text); font-size:13px; margin-bottom:20px;">Headquarters | 10.10.x.x | 93 employees | 3 floors | 125 One Financial Center, Boston MA</p>

  <div class="section">
    <div class="section-title">Servers (10)</div>
    <div class="card-grid">
      <div class="card">
        <div class="card-title">Windows Servers (6)</div>
        <table>
          <tr><th>Hostname</th><th>IP</th><th>Role</th></tr>
          <tr><td><span class="os-win">DC-BOS-01</span></td><td>10.10.20.10</td><td>Domain Controller (Primary)</td></tr>
          <tr><td><span class="os-win">DC-BOS-02</span></td><td>10.10.20.11</td><td>Domain Controller (Secondary)</td></tr>
          <tr><td><span class="os-win">FILE-BOS-01</span></td><td>10.10.20.20</td><td>File Server (SMB)</td></tr>
          <tr><td><span class="os-win">SQL-PROD-01</span></td><td>10.10.20.30</td><td>SQL Database (MSSQL)</td></tr>
          <tr><td><span class="os-win">APP-BOS-01</span></td><td>10.10.20.40</td><td>e-Commerce API (IIS/.NET)</td></tr>
        </table>
      </div>
      <div class="card">
        <div class="card-title">Linux Servers (4)</div>
        <table>
          <tr><th>Hostname</th><th>IP</th><th>Role</th></tr>
          <tr><td><span class="os-linux">SAP-PROD-01</span></td><td>10.10.20.60</td><td>SAP Application Server</td></tr>
          <tr><td><span class="os-linux">SAP-DB-01</span></td><td>10.10.20.61</td><td>SAP HANA Database</td></tr>
          <tr><td><span class="os-linux">BASTION-BOS-01</span></td><td>10.10.10.10</td><td>Bastion Host (Mgmt subnet)</td></tr>
          <tr><td><span class="os-linux">WEB-01</span></td><td>172.16.1.10</td><td>Web Server (DMZ)</td></tr>
          <tr><td><span class="os-linux">WEB-02</span></td><td>172.16.1.11</td><td>Web Server (DMZ)</td></tr>
        </table>
        <p class="note">WEB-01/02 are in DMZ (172.16.1.0/24), NATted to 203.0.113.10/.11</p>
      </div>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Cisco Infrastructure</div>
    <div class="card-grid">
      <div class="card">
        <div class="card-title">ACI Fabric (Boston Pod) <span class="badge badge-cisco">CISCO</span></div>
        <table>
          <tr><th>Component</th><th>Name</th><th>Model</th><th>Node</th></tr>
          <tr><td>APIC</td><td>APIC-BOS-01</td><td>APIC Controller</td><td>10.10.10.20</td></tr>
          <tr><td>Spine</td><td>SPINE-BOS-01</td><td>N9K-C9336C-FX2</td><td>101</td></tr>
          <tr><td>Spine</td><td>SPINE-BOS-02</td><td>N9K-C9336C-FX2</td><td>102</td></tr>
          <tr><td>Leaf</td><td>LEAF-BOS-01</td><td>N9K-C93180YC-FX</td><td>201</td></tr>
          <tr><td>Leaf</td><td>LEAF-BOS-02</td><td>N9K-C93180YC-FX</td><td>202</td></tr>
          <tr><td>Leaf</td><td>LEAF-BOS-03</td><td>N9K-C93180YC-FX</td><td>203</td></tr>
          <tr><td>Leaf</td><td>LEAF-BOS-04</td><td>N9K-C93180YC-FX</td><td>204</td></tr>
        </table>
        <p class="note">5 EPGs: Servers, DBServers, WebDMZ, Management, Backup</p>
      </div>
      <div class="card">
        <div class="card-title">Catalyst Switches <span class="badge badge-cisco">CISCO</span></div>
        <table>
          <tr><th>Hostname</th><th>Model</th><th>IP</th><th>Role</th></tr>
          <tr><td>CAT-BOS-DIST-01</td><td>C9300-48UXM</td><td>10.10.10.30</td><td>Distribution Primary</td></tr>
          <tr><td>CAT-BOS-DIST-02</td><td>C9300-48UXM</td><td>10.10.10.31</td><td>Distribution Secondary</td></tr>
        </table>
        <p class="note">IOS-XE 17.12.4 | 10 VLANs | Managed by Catalyst Center</p>
      </div>
      <div class="card">
        <div class="card-title">Catalyst Center <span class="badge badge-cisco">CISCO</span></div>
        <table>
          <tr><th>Property</th><th>Value</th></tr>
          <tr><td>Hostname</td><td>CATCENTER-BOS-01</td></tr>
          <tr><td>IP</td><td>10.10.10.40</td></tr>
          <tr><td>Version</td><td>v2.3.7.9</td></tr>
          <tr><td>Managed Devices</td><td>3 (CAT-BOS-DIST-01/02, CAT-ATL-DIST-01)</td></tr>
        </table>
        <p class="note">Device health, network health, client health, issues</p>
      </div>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Meraki Devices</div>
    <div class="card-grid">
      <div class="card">
        <div class="card-title">SD-WAN (MX) - HA Pair</div>
        <table>
          <tr><th>Device</th><th>Model</th><th>Role</th><th>WAN</th></tr>
          <tr><td>MX-BOS-01</td><td>MX450</td><td>Primary</td><td>Comcast + AT&T</td></tr>
          <tr><td>MX-BOS-02</td><td>MX450</td><td>Secondary</td><td>Comcast + AT&T</td></tr>
        </table>
      </div>
      <div class="card">
        <div class="card-title">Access Points (16 MR46)</div>
        <table>
          <tr><th>Floor</th><th>Count</th><th>Areas</th></tr>
          <tr><td>Floor 1</td><td>5 APs</td><td>Reception, Lobby, Operations, Shipping, Break Room</td></tr>
          <tr><td>Floor 2</td><td>5 APs</td><td>Finance East/West, Marketing, HR, Cafeteria</td></tr>
          <tr><td>Floor 3</td><td>6 APs</td><td>Exec, CEO Office, Engineering E/W, Legal, Break Room</td></tr>
        </table>
      </div>
      <div class="card">
        <div class="card-title">Switches (5)</div>
        <table>
          <tr><th>Device</th><th>Model</th><th>Role</th></tr>
          <tr><td>MS-BOS-CORE-01/02</td><td>MS425-32</td><td>Core Stack</td></tr>
          <tr><td>MS-BOS-1F/2F/3F-IDF1</td><td>MS225-48</td><td>Access (per floor)</td></tr>
        </table>
      </div>
      <div class="card">
        <div class="card-title">Cameras (8) &amp; Sensors (5)</div>
        <table>
          <tr><th>Type</th><th>Count</th><th>Coverage</th></tr>
          <tr><td>MV12 Indoor</td><td>3</td><td>Lobby, Server Room, Boardroom</td></tr>
          <tr><td>MV32 Indoor Wide</td><td>3</td><td>MDF, Boardroom 2</td></tr>
          <tr><td>MV72 Outdoor</td><td>2</td><td>Loading Dock, Parking</td></tr>
          <tr><td>MT10 Temperature</td><td>2</td><td>Server Room, MDF</td></tr>
          <tr><td>MT11 Humidity</td><td>1</td><td>MDF</td></tr>
          <tr><td>MT20 Door</td><td>2</td><td>Server Room, MDF</td></tr>
        </table>
      </div>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Webex Rooms (10)</div>
    <div class="card-grid">
      <div class="card" style="grid-column: span 2;">
        <table>
          <tr><th>Room</th><th>Floor</th><th>Device</th><th>Model</th><th>Capacity</th><th>Type</th><th>Notes</th></tr>
          <tr><td>Link</td><td>3</td><td>WEBEX-BOS-3F-LINK</td><td>Room Kit Pro + Board 85 Pro</td><td>20</td><td>Boardroom</td><td>Sunny room (+4C afternoon)</td></tr>
          <tr><td>Zelda</td><td>2</td><td>WEBEX-BOS-2F-ZELDA</td><td>Room Kit + Board 55</td><td>12</td><td>Conference</td><td></td></tr>
          <tr><td>Mario</td><td>2</td><td>WEBEX-BOS-2F-MARIO</td><td>Room Kit</td><td>10</td><td>Conference</td><td></td></tr>
          <tr><td>Samus</td><td>2</td><td>WEBEX-BOS-2F-SAMUS</td><td>Room Kit</td><td>8</td><td>Conference</td><td></td></tr>
          <tr><td>Luigi</td><td>3</td><td>WEBEX-BOS-3F-LUIGI</td><td>Room Kit</td><td>8</td><td>Conference</td><td></td></tr>
          <tr><td>Sonic</td><td>3</td><td>WEBEX-BOS-3F-SONIC</td><td>Board 55</td><td>8</td><td>Lab</td><td></td></tr>
          <tr><td>Yoshi</td><td>3</td><td>WEBEX-BOS-3F-YOSHI</td><td>Room Kit Mini</td><td>6</td><td>Huddle</td><td>After-hours activity</td></tr>
          <tr><td>Peach</td><td>1</td><td>WEBEX-BOS-1F-PEACH</td><td>Desk Pro</td><td>6</td><td>Visitor</td><td></td></tr>
          <tr><td style="color:var(--threat)">Kirby</td><td>3</td><td>WEBEX-BOS-3F-KIRBY</td><td>Desk Pro</td><td>4</td><td>Huddle</td><td style="color:var(--threat)">PROBLEM: WiFi congestion, old equipment</td></tr>
          <tr><td>Toad</td><td>1</td><td>WEBEX-BOS-1F-TOAD</td><td>Room Kit Mini</td><td>4</td><td>Visitor</td><td></td></tr>
        </table>
      </div>
    </div>
  </div>
</div><!-- /tab-boston -->

<!-- ========== TAB: ATLANTA HUB ========== -->
<div id="tab-atlanta" class="tab-content">
  <h2 style="color:var(--accent); margin-bottom:5px;">Atlanta Hub</h2>
  <p style="color:var(--text); font-size:13px; margin-bottom:20px;">IT / Regional Hub | 10.20.x.x | 43 employees | 2 floors | 400 Peachtree Center, Atlanta GA</p>

  <div class="section">
    <div class="section-title">Servers (3)</div>
    <div class="card-grid">
      <div class="card">
        <table>
          <tr><th>Hostname</th><th>IP</th><th>Role</th><th>OS</th></tr>
          <tr><td><span class="os-win">DC-ATL-01</span></td><td>10.20.20.10</td><td>Domain Controller</td><td>Windows</td></tr>
          <tr><td><span class="os-win">BACKUP-ATL-01</span></td><td>10.20.20.20</td><td>Backup Server (Veeam)</td><td>Windows</td></tr>
          <tr><td><span class="os-linux">MON-ATL-01</span></td><td>10.20.20.30</td><td>Monitoring (Nagios/Grafana)</td><td>Linux</td></tr>
        </table>
        <p class="note">MON-ATL-01: disk_filling scenario target (Days 1-5, 45% -> 98%)</p>
      </div>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Cisco Infrastructure</div>
    <div class="card-grid">
      <div class="card">
        <div class="card-title">ACI Mini-Pod <span class="badge badge-cisco">CISCO</span></div>
        <table>
          <tr><th>Component</th><th>Name</th><th>Model</th><th>Node</th></tr>
          <tr><td>Spine</td><td>SPINE-ATL-01</td><td>N9K-C9332C</td><td>301</td></tr>
          <tr><td>Leaf</td><td>LEAF-ATL-01</td><td>N9K-C93180YC-FX</td><td>401</td></tr>
          <tr><td>Leaf</td><td>LEAF-ATL-02</td><td>N9K-C93180YC-FX</td><td>402</td></tr>
        </table>
        <p class="note">3 EPGs: ATLServers, ATLBackup, ATLMonitor | Multi-site managed by APIC-BOS-01</p>
      </div>
      <div class="card">
        <div class="card-title">Catalyst Switch <span class="badge badge-cisco">CISCO</span></div>
        <table>
          <tr><th>Hostname</th><th>Model</th><th>IP</th><th>Role</th></tr>
          <tr><td>CAT-ATL-DIST-01</td><td>C9300-48UXM</td><td>10.20.10.30</td><td>Distribution</td></tr>
        </table>
        <p class="note">IOS-XE 17.12.4 | 8 VLANs | Managed by Catalyst Center (BOS)</p>
      </div>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Meraki Devices</div>
    <div class="card-grid">
      <div class="card">
        <div class="card-title">SD-WAN + Access</div>
        <table>
          <tr><th>Type</th><th>Count</th><th>Details</th></tr>
          <tr><td>MX250</td><td>1</td><td>MX-ATL-01 | WAN: AT&T + Spectrum</td></tr>
          <tr><td>MR46 APs</td><td>12</td><td>Floor 1: 6, Floor 2: 6</td></tr>
          <tr><td>MS Switches</td><td>4</td><td>2x MS425-32 (DC Core) + 2x MS225-48 (Access)</td></tr>
        </table>
      </div>
      <div class="card">
        <div class="card-title">Cameras (7) &amp; Sensors (7)</div>
        <table>
          <tr><th>Type</th><th>Count</th><th>Coverage</th></tr>
          <tr><td>MV12 Indoor</td><td>2</td><td>Lobby, IDF</td></tr>
          <tr><td>MV32 Indoor Wide</td><td>4</td><td>DC Row A/B, DC Entrance, DC Cage</td></tr>
          <tr><td>MV72 Outdoor</td><td>1</td><td>Parking</td></tr>
          <tr><td>MT10 Temperature</td><td>4</td><td>DC Row A/B (front/back)</td></tr>
          <tr><td>MT11 Humidity</td><td>2</td><td>DC Row A/B</td></tr>
          <tr><td>MT20 Door</td><td>1</td><td>DC Entrance</td></tr>
        </table>
      </div>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Webex Rooms (7)</div>
    <div class="card-grid">
      <div class="card" style="grid-column: span 2;">
        <table>
          <tr><th>Room</th><th>Floor</th><th>Device</th><th>Model</th><th>Capacity</th><th>Type</th><th>Notes</th></tr>
          <tr><td style="color:var(--threat)">Cortana</td><td>2</td><td>WEBEX-ATL-2F-CORTANA</td><td>Room Kit Pro</td><td>16</td><td>Training</td><td style="color:var(--threat)">PROBLEM: Bandwidth limited, echo issues</td></tr>
          <tr><td>Chief</td><td>2</td><td>WEBEX-ATL-2F-CHIEF</td><td>Room Kit + Board 55</td><td>10</td><td>Conference</td><td>Sunny room (+3.5C afternoon)</td></tr>
          <tr><td>Kratos</td><td>1</td><td>WEBEX-ATL-1F-KRATOS</td><td>Room Kit</td><td>8</td><td>Conference</td><td></td></tr>
          <tr><td>Lara</td><td>2</td><td>WEBEX-ATL-2F-LARA</td><td>Board 55</td><td>8</td><td>Lab</td><td></td></tr>
          <tr><td>Ryu</td><td>1</td><td>WEBEX-ATL-1F-RYU</td><td>Room Kit</td><td>6</td><td>Operations</td><td></td></tr>
          <tr><td>Pikachu</td><td>2</td><td>WEBEX-ATL-2F-PIKACHU</td><td>Desk Pro</td><td>4</td><td>Huddle</td><td>After-hours activity</td></tr>
          <tr><td>Megaman</td><td>2</td><td>WEBEX-ATL-2F-MEGAMAN</td><td>Desk Pro</td><td>4</td><td>Huddle</td><td></td></tr>
        </table>
      </div>
    </div>
  </div>
</div><!-- /tab-atlanta -->

<!-- ========== TAB: AUSTIN OFFICE ========== -->
<div id="tab-austin" class="tab-content">
  <h2 style="color:var(--accent); margin-bottom:5px;">Austin Office</h2>
  <p style="color:var(--text); font-size:13px; margin-bottom:20px;">Sales / Engineering Office | 10.30.x.x | 39 employees | 1 floor | 200 Congress Ave, Austin TX</p>

  <div class="section">
    <div class="section-title">Servers</div>
    <div class="card">
      <p style="color:#888; font-style:italic; text-align:center; padding:20px;">No local servers -- all services accessed via SD-WAN tunnel to Boston HQ and Atlanta Hub</p>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Meraki Devices</div>
    <div class="card-grid">
      <div class="card">
        <div class="card-title">SD-WAN + Access</div>
        <table>
          <tr><th>Type</th><th>Count</th><th>Details</th></tr>
          <tr><td>MX85</td><td>1</td><td>MX-AUS-01 | WAN: Verizon</td></tr>
          <tr><td>MR46 APs</td><td>8</td><td>Floor 1: 8 APs</td></tr>
          <tr><td>MS250-48</td><td>1</td><td>Core switch</td></tr>
          <tr><td>MS225-24</td><td>1</td><td>Access switch</td></tr>
        </table>
      </div>
      <div class="card">
        <div class="card-title">Cameras (4) &amp; Sensors (2)</div>
        <table>
          <tr><th>Type</th><th>Count</th><th>Coverage</th></tr>
          <tr><td>MV12 Indoor</td><td>2</td><td>Entrance, Server Room</td></tr>
          <tr><td>MV72 Outdoor</td><td>2</td><td>Parking Front/Back</td></tr>
          <tr><td>MT10 Temperature</td><td>1</td><td>Server Room</td></tr>
          <tr><td>MT20 Door</td><td>1</td><td>Server Room</td></tr>
        </table>
      </div>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Network Note</div>
    <div class="card">
      <p style="color:#888; font-style:italic;">No Catalyst switches or ACI fabric -- branch office uses Meraki-only network stack. All campus switching via Meraki MS, all security via Meraki MX + Cisco Secure Access.</p>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Webex Rooms (4)</div>
    <div class="card-grid">
      <div class="card" style="grid-column: span 2;">
        <table>
          <tr><th>Room</th><th>Floor</th><th>Device</th><th>Model</th><th>Capacity</th><th>Type</th><th>Notes</th></tr>
          <tr><td>Doom</td><td>1</td><td>WEBEX-AUS-1F-DOOM</td><td>Room Kit + Board 55</td><td>12</td><td>Conference</td><td>Sunny room (+5C afternoon)</td></tr>
          <tr><td>Crash</td><td>1</td><td>WEBEX-AUS-1F-CRASH</td><td>Room Kit</td><td>8</td><td>Conference</td><td></td></tr>
          <tr><td>Jett</td><td>1</td><td>WEBEX-AUS-1F-JETT</td><td>Room Kit</td><td>8</td><td>Demo</td><td></td></tr>
          <tr><td>Fox</td><td>1</td><td>WEBEX-AUS-1F-FOX</td><td>Room Kit Mini</td><td>6</td><td>Huddle</td><td></td></tr>
        </table>
      </div>
    </div>
  </div>
</div><!-- /tab-austin -->

<!-- ========== TAB: CLOUD & SAAS ========== -->
<div id="tab-cloud" class="tab-content">
  <h2 style="color:var(--accent); margin-bottom:5px;">Cloud &amp; SaaS Services</h2>
  <p style="color:var(--text); font-size:13px; margin-bottom:20px;">Cloud infrastructure, identity, collaboration, and SaaS platforms</p>

  <div class="card-grid">
    <div class="card">
      <div class="card-title">Cisco Secure Access <span class="badge badge-cisco">CISCO</span></div>
      <table>
        <tr><th>Component</th><th>Details</th></tr>
        <tr><td>DNS Security</td><td>175 employees, 100K-120K queries/day</td></tr>
        <tr><td>SWG Proxy</td><td>25K-40K events/day</td></tr>
        <tr><td>Cloud Firewall</td><td>8K events/day</td></tr>
        <tr><td>ZTNA/RAVPN</td><td>73 VPN users</td></tr>
        <tr><td>DLP</td><td>Finance policy enabled</td></tr>
        <tr><td>Data Centers</td><td>IAD, ORD, DFW, SJC, ATL</td></tr>
      </table>
      <p class="note">Sourcetypes: cisco:umbrella:dns, proxy, firewall, audit</p>
    </div>

    <div class="card">
      <div class="card-title">Entra ID / Microsoft 365 <span class="badge badge-cloud">CLOUD</span></div>
      <table>
        <tr><th>Property</th><th>Value</th></tr>
        <tr><td>Tenant</td><td>theFakeTshirtCompany.com</td></tr>
        <tr><td>Users</td><td>175 + service accounts</td></tr>
        <tr><td>Enterprise Apps</td><td>17 registered</td></tr>
        <tr><td>Security Groups</td><td>19</td></tr>
        <tr><td>Licensing</td><td>Microsoft 365 E3</td></tr>
        <tr><td>MFA</td><td>Enabled (all users)</td></tr>
      </table>
      <p class="note">Sourcetypes: azure:aad:signin, azure:aad:audit, o365:management:activity</p>
    </div>

    <div class="card">
      <div class="card-title">AWS <span class="badge badge-cloud">CLOUD</span></div>
      <table>
        <tr><th>Property</th><th>Value</th></tr>
        <tr><td>Account ID</td><td>123456789012</td></tr>
        <tr><td>Primary Region</td><td>us-east-1</td></tr>
        <tr><td>Secondary Region</td><td>us-west-2</td></tr>
        <tr><td>S3 Buckets</td><td>finance-data, backups-prod</td></tr>
      </table>
      <p class="note">Sourcetype: aws:cloudtrail</p>
    </div>

    <div class="card">
      <div class="card-title">GCP <span class="badge badge-cloud">CLOUD</span></div>
      <table>
        <tr><th>Property</th><th>Value</th></tr>
        <tr><td>Project</td><td>faketshirtcompany-prod-01</td></tr>
        <tr><td>Region</td><td>us-central1</td></tr>
        <tr><td>GCS Bucket</td><td>confidential-docs</td></tr>
      </table>
      <p class="note">Sourcetype: google:gcp:pubsub:message</p>
    </div>

    <div class="card">
      <div class="card-title">Cisco Webex <span class="badge badge-cisco">CISCO</span></div>
      <table>
        <tr><th>Property</th><th>Value</th></tr>
        <tr><td>Total Rooms</td><td>21 across 3 sites</td></tr>
        <tr><td>Boston</td><td>10 rooms (4-20 capacity)</td></tr>
        <tr><td>Atlanta</td><td>7 rooms (4-16 capacity)</td></tr>
        <tr><td>Austin</td><td>4 rooms (6-12 capacity)</td></tr>
        <tr><td>Problem Rooms</td><td>Kirby (BOS), Cortana (ATL)</td></tr>
      </table>
      <p class="note">Sourcetypes: cisco:webex:events, meetings:history, 5 API types</p>
    </div>

    <div class="card">
      <div class="card-title">Meraki Dashboard <span class="badge badge-cisco">CISCO</span></div>
      <table>
        <tr><th>Device Type</th><th>Total</th><th>Distribution</th></tr>
        <tr><td>MX (SD-WAN)</td><td>4</td><td>BOS: 2 (HA), ATL: 1, AUS: 1</td></tr>
        <tr><td>MR (APs)</td><td>36</td><td>BOS: 16, ATL: 12, AUS: 8</td></tr>
        <tr><td>MS (Switches)</td><td>11</td><td>BOS: 5, ATL: 4, AUS: 2</td></tr>
        <tr><td>MV (Cameras)</td><td>19</td><td>BOS: 8, ATL: 7, AUS: 4</td></tr>
        <tr><td>MT (Sensors)</td><td>14</td><td>BOS: 5, ATL: 7, AUS: 2</td></tr>
      </table>
      <p class="note">Total: 79 physical devices + 21 door + 18 temp sensors in meeting rooms</p>
    </div>

    <div class="card">
      <div class="card-title">Exchange Online <span class="badge badge-cloud">CLOUD</span></div>
      <table>
        <tr><th>Property</th><th>Value</th></tr>
        <tr><td>Users</td><td>175 mailboxes</td></tr>
        <tr><td>Service</td><td>Microsoft Exchange Online</td></tr>
      </table>
      <p class="note">Sourcetype: ms:o365:reporting:messagetrace</p>
    </div>

    <div class="card">
      <div class="card-title">ServiceNow <span class="badge badge-existing">ITSM</span></div>
      <table>
        <tr><th>Property</th><th>Value</th></tr>
        <tr><td>Module</td><td>Incident Management</td></tr>
        <tr><td>Integration</td><td>Auto-ticket on threshold alerts</td></tr>
      </table>
      <p class="note">Sourcetype: servicenow:incident</p>
    </div>
  </div>
</div><!-- /tab-cloud -->

<!-- ========== TAB: SCENARIOS ========== -->
<div id="tab-scenarios" class="tab-content">
  <h2 style="color:var(--accent); margin-bottom:5px;">Scenarios (10)</h2>
  <p style="color:var(--text); font-size:13px; margin-bottom:20px;">Injected scenarios across 31 days of generated data. All events tagged with <code style="color:var(--accent)">demo_id</code> field for Splunk filtering.</p>

  <!-- 31-day timeline -->
  <div style="margin-bottom:30px;">
    <div class="section-title">Scenario Timeline (31 Days)</div>
    <div style="background:#111822; border-radius:8px; padding:15px 20px; border:1px solid var(--border);">
      <!-- Day labels -->
      <div style="display:flex; font-size:9px; color:#666; margin-bottom:8px;">
        <div style="width:60px; flex-shrink:0;"></div>
        <div style="flex:1; display:flex; justify-content:space-between;">
          <span>Day 1</span><span>5</span><span>10</span><span>15</span><span>20</span><span>25</span><span>31</span>
        </div>
      </div>
      <!-- Attack row -->
      <div class="timeline-row">
        <div class="timeline-row-label" style="color:var(--threat);">Attack</div>
        <div class="timeline-row-bars">
          <div class="timeline-bar" style="left:0%; width:45.2%; background:var(--threat);">exfil (Days 1-14)</div>
          <div class="timeline-bar" style="left:22.6%; width:6.5%; background:var(--threat); opacity:0.6;">ransom (8-9)</div>
          <div class="timeline-bar" style="left:64.5%; width:9.7%; background:var(--threat);">phishing (21-23)</div>
        </div>
      </div>
      <!-- Ops row -->
      <div class="timeline-row">
        <div class="timeline-row-label" style="color:var(--cloud);">Ops</div>
        <div class="timeline-row-bars">
          <div class="timeline-bar" style="left:0%; width:16.1%; background:var(--cloud);">disk (1-5)</div>
          <div class="timeline-bar" style="left:19.4%; width:12.9%; background:var(--cloud);">mem_leak (7-10)</div>
          <div class="timeline-bar" style="left:32.3%; width:6.5%; background:var(--cloud);">cpu (11-12)</div>
          <div class="timeline-bar" style="left:48.4%; width:3.2%; background:var(--cloud);">pricing</div>
        </div>
      </div>
      <!-- Network row -->
      <div class="timeline-row">
        <div class="timeline-row-label" style="color:var(--cisco);">Network</div>
        <div class="timeline-row-bars">
          <div class="timeline-bar" style="left:16.1%; width:3.2%; background:var(--cisco);">fw (6)</div>
          <div class="timeline-bar" style="left:38.7%; width:3.2%; background:var(--cisco);">cert (13)</div>
          <div class="timeline-bar" style="left:54.8%; width:6.5%; background:var(--cisco);">ddos (18-19)</div>
        </div>
      </div>
      <!-- Legend -->
      <div style="display:flex; gap:20px; margin-top:8px; font-size:10px; padding-left:60px;">
        <span><span style="color:var(--threat);">&#9632;</span> Attack</span>
        <span><span style="color:var(--cloud);">&#9632;</span> Ops</span>
        <span><span style="color:var(--cisco);">&#9632;</span> Network</span>
      </div>
    </div>
  </div>

  <!-- Scenario cards -->
  <div class="section">
    <div class="section-title">Attack Scenarios <span class="badge badge-attack">ATTACK</span></div>
    <div class="card-grid">
      <div class="card">
        <div class="card-title">exfil <span class="badge badge-attack">Days 1-14</span></div>
        <p style="color:var(--text); font-size:12px; margin-bottom:8px;">APT-style data exfiltration over 14 days (phishing -> privilege abuse -> exfil)</p>
        <table>
          <tr><th>Phase</th><th>Days</th><th>Activity</th></tr>
          <tr><td>Recon</td><td>1-4</td><td>Port scanning, phishing emails sent</td></tr>
          <tr><td>Initial Access</td><td>5</td><td>jessica.brown clicks phishing link (ATL)</td></tr>
          <tr><td>Lateral Movement</td><td>6-8</td><td>ATL to BOS credential pivot</td></tr>
          <tr><td>Persistence</td><td>9-11</td><td>Backdoor, data staging (FILE-BOS-01)</td></tr>
          <tr><td>Exfiltration</td><td>12-14</td><td>Cloud storage theft (alex.miller)</td></tr>
        </table>
        <p class="note">Sources: asa, entraid, aws, gcp, perfmon, wineventlog, exchange, office_audit, servicenow, mssql, sysmon, secure_access, catalyst, aci</p>
      </div>
      <div class="card">
        <div class="card-title">ransomware_attempt <span class="badge badge-attack">Days 8-9</span></div>
        <p style="color:var(--text); font-size:12px; margin-bottom:8px;">Ransomware via phishing - detected and stopped by EDR in 10 minutes</p>
        <table>
          <tr><th>Property</th><th>Value</th></tr>
          <tr><td>Target</td><td>brooklyn.white (Sales Engineer, Austin)</td></tr>
          <tr><td>Vector</td><td>Phishing email with malicious attachment</td></tr>
          <tr><td>Outcome</td><td>Blocked by EDR within 10 minutes</td></tr>
        </table>
        <p class="note">Sources: asa, exchange, wineventlog, meraki, servicenow, office_audit, sysmon, secure_access</p>
      </div>
      <div class="card">
        <div class="card-title">phishing_test <span class="badge badge-attack">Days 21-23</span></div>
        <p style="color:var(--text); font-size:12px; margin-bottom:8px;">IT-run phishing awareness campaign after exfil incident</p>
        <table>
          <tr><th>Property</th><th>Value</th></tr>
          <tr><td>Target</td><td>All 175 employees</td></tr>
          <tr><td>Emails Sent</td><td>175 simulated phishing</td></tr>
          <tr><td>Click Rate</td><td>~31% (55 users)</td></tr>
          <tr><td>Credential Submit</td><td>~10% (18 users)</td></tr>
        </table>
        <p class="note">Sources: exchange, entraid, wineventlog, office_audit, servicenow, secure_access</p>
      </div>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Ops Scenarios <span class="badge badge-ops">OPS</span></div>
    <div class="card-grid">
      <div class="card">
        <div class="card-title">disk_filling <span class="badge badge-ops">Days 1-5</span></div>
        <p style="color:var(--text); font-size:12px;">Server disk gradually filling up (MON-ATL-01: 45% -> 98%)</p>
        <p class="note">Sources: linux, servicenow</p>
      </div>
      <div class="card">
        <div class="card-title">memory_leak <span class="badge badge-ops">Days 7-10</span></div>
        <p style="color:var(--text); font-size:12px;">Application memory leak causing OOM crash Day 10 at 14:00 (WEB-01)</p>
        <p class="note">Sources: linux, asa, access, orders, sap, servicenow, catalyst_center</p>
      </div>
      <div class="card">
        <div class="card-title">cpu_runaway <span class="badge badge-ops">Days 11-12</span></div>
        <p style="color:var(--text); font-size:12px;">SQL backup job stuck at 100% CPU, cascading DB failures (SQL-PROD-01)</p>
        <p class="note">Sources: perfmon, wineventlog, asa, access, servicenow, mssql, aci, catalyst_center</p>
      </div>
      <div class="card">
        <div class="card-title">dead_letter_pricing <span class="badge badge-ops">Day 16</span></div>
        <p style="color:var(--text); font-size:12px;">ServiceBus dead-letter queue causes wrong product prices (WEB-01, 4-6h)</p>
        <p class="note">Sources: servicebus, orders, access, servicenow</p>
      </div>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Network Scenarios <span class="badge badge-network">NETWORK</span></div>
    <div class="card-grid">
      <div class="card">
        <div class="card-title">ddos_attack <span class="badge badge-network">Days 18-19</span></div>
        <p style="color:var(--text); font-size:12px;">Volumetric HTTP flood targeting WEB-01/02 (50K req/s, 6-hour mitigation)</p>
        <p class="note">Sources: asa, meraki, access, perfmon, linux, servicenow, catalyst, aci, catalyst_center</p>
      </div>
      <div class="card">
        <div class="card-title">firewall_misconfig <span class="badge badge-network">Day 6</span></div>
        <p style="color:var(--text); font-size:12px;">ACL misconfiguration on FW-EDGE-01 causing 2-hour outage (10:15-12:05)</p>
        <p class="note">Sources: asa, access, servicenow, catalyst</p>
      </div>
      <div class="card">
        <div class="card-title">certificate_expiry <span class="badge badge-network">Day 13</span></div>
        <p style="color:var(--text); font-size:12px;">SSL certificate expires on FW-EDGE-01 causing 7-hour outage (00:00-07:00)</p>
        <p class="note">Sources: asa, access, servicenow</p>
      </div>
    </div>
  </div>
</div><!-- /tab-scenarios -->

<!-- ========== JAVASCRIPT ========== -->
<script>
// Tab switching
function showTab(name) {
  document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(el => el.classList.remove('active'));
  const tab = document.getElementById('tab-' + name);
  if (tab) tab.classList.add('active');
  // Find the clicked tab button
  document.querySelectorAll('.tab').forEach(el => {
    if (el.getAttribute('onclick') && el.getAttribute('onclick').includes("'" + name + "'")) {
      el.classList.add('active');
    }
  });
}

// Tooltip system
(function() {
  const tooltip = document.getElementById('tooltip');
  const ttTitle = tooltip.querySelector('.tt-title');
  const ttBody = tooltip.querySelector('.tt-body');
  const ttDetail = tooltip.querySelector('.tt-detail');

  document.addEventListener('mouseover', function(e) {
    const hoverable = e.target.closest('.hoverable');
    if (!hoverable) return;

    const title = hoverable.getAttribute('data-tt-title');
    const body = hoverable.getAttribute('data-tt-body');
    const detail = hoverable.getAttribute('data-tt-detail');

    if (!title) return;

    ttTitle.textContent = title;
    ttBody.innerHTML = body ? body.replace(/\|/g, '<br>') : '';
    ttDetail.innerHTML = detail ? detail.replace(/\|/g, '<br>') : '';
    ttDetail.style.display = detail ? 'block' : 'none';

    tooltip.style.display = 'block';
    tooltip.style.opacity = '1';
  });

  document.addEventListener('mousemove', function(e) {
    if (tooltip.style.display === 'none') return;
    let x = e.clientX + 15;
    let y = e.clientY + 15;
    const rect = tooltip.getBoundingClientRect();
    // Clamp to viewport
    if (x + rect.width > window.innerWidth - 10) {
      x = e.clientX - rect.width - 15;
    }
    if (y + rect.height > window.innerHeight - 10) {
      y = e.clientY - rect.height - 15;
    }
    tooltip.style.left = x + 'px';
    tooltip.style.top = y + 'px';
  });

  document.addEventListener('mouseout', function(e) {
    const hoverable = e.target.closest('.hoverable');
    if (!hoverable) return;
    // Check if we're moving to a child element
    if (hoverable.contains(e.relatedTarget)) return;
    tooltip.style.display = 'none';
    tooltip.style.opacity = '0';
  });
})();
</script>

</body>
</html>
