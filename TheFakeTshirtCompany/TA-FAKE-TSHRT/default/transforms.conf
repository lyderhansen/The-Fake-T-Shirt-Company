##############################################################################################################
#
# transforms.conf for Demo Environment
#
# Host extraction and field extraction transforms for :demo sourcetypes
#
##############################################################################################################


##############################################################################################################
# INDEXED FIELD EXTRACTION — demo_id (for tstats acceleration)
##############################################################################################################

# Extract demo_id at index time so it's available in TSIDX for tstats queries.
# Matches both KV format (demo_id=exfil) and JSON format ("demo_id": "exfil")
[extract_demo_id_indexed]
REGEX = (?:"demo_id":\s*"([^"]+)"|demo_id=(\S+))
FORMAT = IDX_demo_id::$1$2
WRITE_META = true
DEPTH_LIMIT = 99999
LOOKAHEAD = 99999


##############################################################################################################
# SEARCH-TIME FIELD EXTRACTION — demo_id
##############################################################################################################

# Extract demo_id at search time as a regular field.
# This is needed because KV_MODE=AUTO can conflict with other CIM field extractions,
# causing demo_id to not be extracted reliably. This explicit REPORT- extraction
# works independently of KV_MODE settings.
# Matches both KV format (demo_id=exfil) and JSON format ("demo_id": "exfil")
[extract_demo_id_search]
REGEX = (?:"demo_id":\s*"([^"]+)"|demo_id=(\S+))
FORMAT = demo_id::$1$2


##############################################################################################################
# HOST EXTRACTION
##############################################################################################################

# Extract host from demo_host field (Windows Perfmon)
# Matches: demo_host=HOSTNAME
[perfmon_set_host_from_event]
REGEX=demo_host=(\S+)
DEST_KEY = MetaData:Host
FORMAT = host::$1

# Extract host from Cisco IOS-XE syslog (hostname between seq and timestamp)
# Format: <PRI>seq: HOSTNAME: Mon DD YYYY HH:MM:SS.mmm: ...
[catalyst_host_extraction]
REGEX = >\d+:\s+([\w-]+):
DEST_KEY = MetaData:Host
FORMAT = host::$1

[FAKE_st_perfmon_network_interface]
REGEX = object=Network(\s|$)
DEST_KEY = MetaData:Sourcetype
FORMAT = sourcetype::FAKE:Perfmon:Network_Interface

[FAKE_st_perfmon_generic_object]
REGEX = object=(LogicalDisk|Memory|Processor)(\s|$)
DEST_KEY = MetaData:Sourcetype
FORMAT = sourcetype::FAKE:Perfmon:$1

[FAKE_st_perfmon_sqlserver_sql_statistics]
REGEX = object=SQLServer:SQL\sStatistics
DEST_KEY = MetaData:Sourcetype
FORMAT = sourcetype::FAKE:Perfmon:SQLServer:sql_statistics

[FAKE_st_perfmon_sqlserver_buffer_manager]
REGEX = object=SQLServer:Buffer\sManager
DEST_KEY = MetaData:Sourcetype
FORMAT = sourcetype::FAKE:Perfmon:SQLServer:buffer_manager

[FAKE_st_perfmon_sqlserver_locks]
REGEX = object=SQLServer:Locks
DEST_KEY = MetaData:Sourcetype
FORMAT = sourcetype::FAKE:Perfmon:SQLServer:locks

[extract_perfmon_sqlserver_fields]
REGEX = object=SQLServer:(.+?)\s+counter="([^"]+)"\s+instance=(\S*)\s+[Vv]alue=([\d.]+)
FORMAT = sql_component::$1 counter::$2 instance::$3 value::$4


# Extract host from Linux log format
# Format: YYYY-MM-DD HH:MM:SS hostname rest_of_log
# Example: 2026-01-01 12:34:56 WEB-01 CPU all 25.00 ...
[set_host_from_linux_fake]
#REGEX = ^\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}\s(\S+)
REGEX = ^\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}\shost=(.+?)\s
DEST_KEY = MetaData:Host
FORMAT = host::$1


[set_host_from_auth_log]
# Auth.log format: "Jan  5 14:23:45 <hostname> sshd[1234]..."
REGEX = ^[A-Z][a-z]{2}\s+\d+\s[\d:]+\s(\S+)\s
DEST_KEY = MetaData:Host
FORMAT = host::$1

[set_host_from_asa_syslog_fake]
#REGEX = ^\w{3}\s+\d{1,2}\s+\d{2}:\d{2}:\d{2}\s+(\S+)\s+%ASA
#REGEX = ^\<\d+?\>\w{3}\s+\d{1,2}\s+\d+\s+\d{2}:\d{2}:\d{2}\.\d{3}\s+(\S+)\s+%ASA
REGEX = \w{3}\s+\d{1,2}\s+\d+\s+\d{2}:\d{2}:\d{2}\.\d{3}\s+(\S+)\s+%ASA
DEST_KEY = MetaData:Host
FORMAT = host::$1

[set_host_from_wineventlog]
REGEX=ComputerName=(.*)\n
DEST_KEY = MetaData:Host
FORMAT = host::$1

[set_source_from_logname]
REGEX = LogName=(.+)
DEST_KEY = MetaData:Source
FORMAT = source::WinEventLog:$1



##############################################################################################################
# SYSMON MESSAGE FIELD EXTRACTIONS (from Message body — key: value pairs)
##############################################################################################################

[extract_sysmon_image]
REGEX = (?m)^Image:\s+(.+)$
FORMAT = Image::$1

[extract_sysmon_commandline]
REGEX = (?m)^CommandLine:\s+(.+)$
FORMAT = CommandLine::$1

[extract_sysmon_user]
REGEX = (?m)^User:\s+(.+)$
FORMAT = User::$1

[extract_sysmon_parentimage]
REGEX = (?m)^ParentImage:\s+(.+)$
FORMAT = ParentImage::$1

[extract_sysmon_parentcommandline]
REGEX = (?m)^ParentCommandLine:\s+(.+)$
FORMAT = ParentCommandLine::$1

[extract_sysmon_targetfilename]
REGEX = (?m)^TargetFilename:\s+(.+)$
FORMAT = TargetFilename::$1

[extract_sysmon_targetobject]
REGEX = (?m)^TargetObject:\s+(.+)$
FORMAT = TargetObject::$1

[extract_sysmon_queryname]
REGEX = (?m)^QueryName:\s+(.+)$
FORMAT = QueryName::$1

[extract_sysmon_sourceip]
REGEX = (?m)^SourceIp:\s+(.+)$
FORMAT = SourceIp::$1

[extract_sysmon_destinationip]
REGEX = (?m)^DestinationIp:\s+(.+)$
FORMAT = DestinationIp::$1

[extract_sysmon_destinationport]
REGEX = (?m)^DestinationPort:\s+(.+)$
FORMAT = DestinationPort::$1

[extract_sysmon_protocol]
REGEX = (?m)^Protocol:\s+(.+)$
FORMAT = Protocol::$1


##############################################################################################################
# WINDOWS PERFMON FIELD EXTRACTIONS
##############################################################################################################

# Perfmon:Processor fields
# Format: MM/DD/YYYY HH:MM:SS demo_host=HOST object=Processor counter="% Processor Time" instance=_Total value=XX.XX
[extract_perfmon_processor_fields]
REGEX = object=Processor\s+counter="?([^"]+)"?\s+instance=(\S+)\s+value=([\d.]+)
FORMAT = counter::$1 instance::$2 value::$3

# Perfmon:Memory fields
# Format: MM/DD/YYYY HH:MM:SS demo_host=HOST object=Memory counter="Available MBytes" value=XXXX
[extract_perfmon_memory_fields]
REGEX = object=Memory\s+counter="?([^"]+)"?\s+(?:instance=(\S+)\s+)?value=([\d.]+)
FORMAT = counter::$1 instance::$2 value::$3

# Perfmon:LogicalDisk fields
# Format: MM/DD/YYYY HH:MM:SS demo_host=HOST object=LogicalDisk counter="% Free Space" instance=C: value=XX.XX
[extract_perfmon_disk_fields]
REGEX = object=LogicalDisk\s+counter="?([^"]+)"?\s+instance=(\S+)\s+value=([\d.]+)
FORMAT = counter::$1 instance::$2 value::$3

# Perfmon:Network_Interface fields
# Format: MM/DD/YYYY HH:MM:SS demo_host=HOST object=Network Interface counter="Bytes Total/sec" instance=Intel... value=XXXX
[extract_perfmon_network_fields]
REGEX = object=Network(?:\s+Interface)?\s+counter="?([^"]+)"?\s+instance="?([^"]+)"?\s+value=([\d.]+)
FORMAT = counter::$1 instance::$2 value::$3



##############################################################################################################
# MSSQL - https://splunkbase.splunk.com/app/2648
#############################################################################################################

[logon_events_user]
REGEX = (?<event_source>Logon)\s+Login\s+(?<login_action>\w+)\s+for\s+user\s+['"]?(?<user>[^'"]+)['"]?.\s*(Reason\s?:?)?\s*(?<reason>[^\[\n]*)(\[CLIENT:\s*<?(?<src>[^>\]]*)>?\])?

[logon_events_general]
REGEX = (?<event_source>Logon)\s*(?<message>[^\[\n]*)(\[CLIENT:\s*<?(?<src>[^>\]]*)>?\])?

[logon_events]
REGEX = (?<event_source>Logon)\s*Error\s*:?\s*(?<error_code>[0-9]*)\s*,\s*Severity\s*:?\s*(?<severity>[0-9]*)\s*,\s*State\s*:?\s*(?<state>[0-9]*)

[spid_dbcc]
REGEX = (?<event_source>spid\w*)\s*DBCC\s*(?<dbcc_command_details>.*)\s*executed\s*by\s*(?<user>[^ ]*)\s*found\s*(?<found_errors>\d*)\s*errors\s*and\s*repaired\s*(?<repaired_errors>\d*)\s*errors\.?\s*Elapsed\s*time:?\s*(?<elapsed_time>.*\s*seconds)\.\s*(?<message>.*)

[spid_instance]
REGEX = (?<event_source>spid\w*).*process\s*ID\s*of\s*(?<process_id>\w*)\s*(at|since)\s*(?<local_time>[\d\/ :PAM]*)\(\s*local\s*\)\s*(?<utc_time>[\d\/ :PAM]*)\(\s*UTC\s*\)\s*\.(?<message>.*)

[db_backup]
REGEX = (?<event_source>Backup)\s*Database\s*backed\s*up\.?\s*Database\s*:?\s*(?<database>\w+)\s*,\s*creation\s*date\(time\)\s*:?\s*(?<creation_date_time>[\w\/:\(\)\s]*)\s*,\s*pages\s*dumped\s*:?\s*(?<pages_dumped>\d*)\s*,\s*first\s*LSN\s*:?\s*(?<first_lsn>[\w:]*)\s*,\s*last\s*LSN\s*:?\s*(?<last_lsn>[\w:]*)\s*,\s*number\s*of\s*dump\s*devices\s*:?\s*(?<number_of_dump_devices>\d*)\s*,\s*device\s*information\s*:?\s*(?<device_information>.*(?=\.\s*This))\.\s*(?<message>.*)

[db_backup_diff]
REGEX = (?<event_source>Backup)\s*Database\s*differential\s*changes\s*were\s*backed\s*up\.?\s*Database\s*:?\s*(?<database>\w+)\s*,\s*creation\s*date\(time\)\s*:?\s*(?<creation_date_time>[\w\/:\(\)\s]*)\s*,\s*pages\s*dumped\s*:?\s*(?<pages_dumped>\d*)\s*,\s*first\s*LSN\s*:?\s*(?<first_lsn>[\w:]*)\s*,\s*last\s*LSN\s*:?\s*(?<last_lsn>[\w:]*)\s*,\s*full\s*backup\s*LSN\s*:?\s*(?<full_backup_lsn>[\w:]*)\s*,\s*number\s*of\s*dump\s*devices\s*:?\s*(?<number_of_dump_devices>\d*)\s*,\s*device\s*information\s*:?\s*(?<device_information>.*(?=\.\s*This))\.\s*(?<message>.*)

[server_general]
REGEX = ^(\d+\-\d+\-\d+\s*\d+:\d+:\d+\.\d+)\s*(?<event_source>Server)\s*(?<message>.*)

# Generic MSSQL error extraction — matches Error/Severity/State after any event_source prefix
# Covers Logon, Server, spid* prefixes (logon_events only matches Logon prefix)
[mssql_error_general]
REGEX = (?:Logon|Server|spid\w*)\s+Error\s*:\s*(?<error_code>\d+)\s*,\s*Severity\s*:\s*(?<severity>\d+)\s*,\s*State\s*:\s*(?<state>\d+)

[audit_key_value_extractions]
REGEX = ,?\s*([^\s\=]+)="(.*?[^,]*)"
FORMAT = $1::$2

[multi_value_with_quotation]
REGEX = ([^\s\=]+)="([^"]+)"
FORMAT = $1::$2
MV_ADD = True

[multi_value_without_quotation]
REGEX = ([^\s\=]+)=([^\s"]+)
FORMAT = $1::$2
MV_ADD = True

[first_level_value_with_quotation]
REGEX = ([^\s\=]+)="([^"]+)"
FORMAT = $1::$2


##############################################################################################################
# LINUX METRICS FIELD EXTRACTIONS
##############################################################################################################

# Linux cpu fields (sar-style)
# Format: 2026-01-01 12:34:56 WEB-01 CPU all 25.00 0.00 10.00 5.00 0.00 60.00
# Fields: timestamp hostname CPU cpu_instance pctUser pctNice pctSystem pctIowait pctSteal pctIdle
[extract_linux_cpu_fields]
REGEX = CPU\s+(\S+)\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)
FORMAT = cpu_instance::$1 pctUser::$2 pctNice::$3 pctSystem::$4 pctIowait::$5 pctSteal::$6 pctIdle::$7

# Linux vmstat fields
# Format: 2026-01-01 12:34:56 WEB-01 procs r=1 b=0 memory swpd=0 free=12345 buff=12345 cache=12345
[extract_linux_vmstat_fields]
REGEX = procs\s+r=(\d+)\s+b=(\d+)\s+memory\s+swpd=(\d+)\s+free=(\d+)\s+buff=(\d+)\s+cache=(\d+)
FORMAT = procs_r::$1 procs_b::$2 swpd::$3 memFree::$4 buff::$5 cache::$6

# Linux df fields
# Format: 2026-01-01 12:34:56 WEB-01 Filesystem=/dev/sda1 Size=100G Used=50G Avail=50G UsePct=50% MountedOn=/
[extract_linux_df_fields]
REGEX = Filesystem=(\S+)\s+Size=(\S+)\s+Used=(\S+)\s+Avail=(\S+)\s+UsePct=(\S+)\s+MountedOn=(\S+)
FORMAT = Filesystem::$1 Size::$2 Used::$3 Avail::$4 UsePct::$5 MountedOn::$6

# Linux iostat fields
# Format: 2026-01-01 12:34:56 WEB-01 Device=sda rrqm/s=0.00 wrqm/s=0.00 r/s=10.00 w/s=5.00 %util=15.00
[extract_linux_iostat_fields]
REGEX = Device=(\S+)\s+rrqm/s=([\d.]+)\s+wrqm/s=([\d.]+)\s+r/s=([\d.]+)\s+w/s=([\d.]+)\s+%util=([\d.]+)
FORMAT = Device::$1 rrqm_s::$2 wrqm_s::$3 r_s::$4 w_s::$5 util::$6

# Linux interfaces fields
# Format: 2026-01-01 12:34:56 WEB-01 Iface=eth0 rxBytes=12345 txBytes=12345 rxPackets=123 txPackets=123
[extract_linux_interfaces_fields]
REGEX = Iface=(\S+)\s+rxBytes=(\d+)\s+txBytes=(\d+)\s+rxPackets=(\d+)\s+txPackets=(\d+)
FORMAT = Iface::$1 rxBytes::$2 txBytes::$3 rxPackets::$4 txPackets::$5


##############################################################################################################
# WEB ACCESS LOG FIELD EXTRACTIONS
##############################################################################################################

# Apache Combined Log Format
# Format: 10.0.5.20 - - [15/Jan/2026:12:34:56 +0000] "GET /api/users HTTP/1.1" 200 1234 "-" "Mozilla/5.0"
[extract_access_combined_fields]
REGEX = ^(\S+)\s+(\S+)\s+(\S+)\s+\[[^\]]+\]\s+"(\S+)\s+(\S+)\s+(\S+)"\s+(\d+)\s+(\d+)\s+"([^"]*)"\s+"([^"]*)"
FORMAT = clientip::$1 ident::$2 user::$3 method::$4 uri::$5 http_version::$6 status::$7 bytes::$8 referer::$9 useragent::$10


##############################################################################################################
# SOURCETYPE ROUTING (optional - for generic Perfmon input)
##############################################################################################################

# Route Perfmon events to specific sourcetypes based on object field
[route_perfmon_processor]
REGEX = object=Processor(\s|$)
DEST_KEY = MetaData:Sourcetype
FORMAT = sourcetype::Perfmon:Processor:demo

[route_perfmon_memory]
REGEX = object=Memory(\s|$)
DEST_KEY = MetaData:Sourcetype
FORMAT = sourcetype::Perfmon:Memory:demo

[route_perfmon_logicaldisk]
REGEX = object=LogicalDisk(\s|$)
DEST_KEY = MetaData:Sourcetype
FORMAT = sourcetype::Perfmon:LogicalDisk:demo

[route_perfmon_network]
REGEX = object=Network(\s|$)
DEST_KEY = MetaData:Sourcetype
FORMAT = sourcetype::Perfmon:Network_Interface:demo

[customer_lookup]
batch_index_query = 0
case_sensitive_match = 1
filename = customer_lookup.csv


##############################################################################################################
# O365 exchange
##############################################################################################################


[extract_messagetrace_src_user_domain_demo]
SOURCE_KEY = SenderAddress
REGEX = @(?<src_user_domain>\S*)

[extract_messagetrace_recipient_domain_demo]
SOURCE_KEY = RecipientAddress
REGEX = @(?<recipient_domain>\S*)

##############################################################################################################
#GCP
##############################################################################################################

[gcp_pubsub_activity_sourcetype_demo]
REGEX = \"logName":\s*?"[a-z\-\/0-9]*?cloudaudit\.googleapis\.com%2Factivity"
FORMAT = sourcetype::FAKE:google:gcp:pubsub:audit:admin_activity
DEST_KEY = MetaData:Sourcetype

[gcp_pubsub_data_access_sourcetype_demo]
REGEX = \"logName":\s*?"[a-z\-\/0-9]*?cloudaudit\.googleapis\.com%2Fdata_access"
FORMAT = sourcetype::FAKE:google:gcp:pubsub:audit:data_access
DEST_KEY = MetaData:Sourcetype

[set_host_from_gcp_project]
REGEX = \"project_id\": \"([\w\-\s]+)\"
DEST_KEY = MetaData:Host
FORMAT = host::$1

# GCP CIM Change data model - extract updated_user and updated_value
# user1: from serviceData.policyDelta.bindingDeltas (IAM policy changes)
[gcp_change_updated_user1_demo]
REGEX = \"member\"\s*:\s*\"(?:user:|serviceAccount:)([^\"]+)\"
FORMAT = updated_user::$1

# user2: from request body member field (alternative IAM format)
[gcp_change_updated_user2_demo]
REGEX = \"principalEmail\"\s*:\s*\"([^\"]+)\"
FORMAT = updated_user::$1

# value1: from request body (role, permission, or config change)
[gcp_change_updated_value1_demo]
REGEX = \"role\"\s*:\s*\"([^\"]+)\"
FORMAT = updated_value::$1

# value2: from policyDelta action (ADD/REMOVE binding)
[gcp_change_updated_value2_demo]
REGEX = \"action\"\s*:\s*\"([^\"]+)\"
FORMAT = updated_value::$1


##############################################################################################################
#Meraki
##############################################################################################################

[set_meraki_host_from_devicename]
REGEX = \"deviceName\": \"([\w\-\s]+)\",
DEST_KEY = MetaData:Host
FORMAT = host::$1

# Meraki CIM lookup definitions (match official Splunk_TA_cisco_meraki)
[cisco_meraki_accesspoints_action_lookup]
filename = cisco_meraki_accesspoints_action_lookup.csv

[cisco_meraki_accesspoints_change_type_object_object_category_result_lookup]
filename = cisco_meraki_accesspoints_change_type_object_object_category_result_lookup.csv

[cisco_meraki_accesspoints_object_attrs_lookup]
filename = cisco_meraki_accesspoints_object_attrs_lookup.csv

[cisco_meraki_cameras_lookup]
filename = cisco_meraki_cameras_lookup.csv

[cisco_meraki_securityappliances_action_lookup]
filename = cisco_meraki_securityappliances_action_lookup.csv

[cisco_meraki_securityappliances_change_type_result_lookup]
filename = cisco_meraki_securityappliances_change_type_result_lookup.csv

[cisco_meraki_securityappliances_object_object_category_lookup]
filename = cisco_meraki_securityappliances_object_object_category_lookup.csv

[cisco_meraki_switches_action_lookup]
filename = cisco_meraki_switches_action_lookup.csv

[cisco_meraki_switches_change_type_object_lookup]
filename = cisco_meraki_switches_change_type_object_lookup.csv

[cisco_meraki_switches_result_lookup]
filename = cisco_meraki_switches_result_lookup.csv

[cisco_meraki_organizationsecurity_lookup]
filename = cisco_meraki_organizationsecurity_lookup.csv


##############################################################################################################
# ERP — SAP S/4HANA
##############################################################################################################

# Extract fields from SAP audit log pipe-delimited format (search-time)
# Format: timestamp|host|dialog_type|user|tcode|status|description|document_number|details
# Note: demo_id is handled at index-time via TRANSFORMS-demo_id, not here
[extract_sap_auditlog_fields]
REGEX = ^[^|]+\|([^|]+)\|([^|]*)\|([^|]*)\|([^|]*)\|([^|]*)\|([^|]*)\|([^|]*)\|([^|]*)
FORMAT = sap_host::$1 dialog_type::$2 user::$3 tcode::$4 status::$5 description::$6 document_number::$7 details::$8

# --- Inventory movements (MIGO) — search-time extraction from _raw ---
# Matches both formats:
#   "Mvt 101 (GR for PO), material M-0058 "Ethical Hacker Joggers", qty 278"
#   "Mvt 301: Stock Transfer Between Plants, M-0035 "Work From Home Tee", qty 55, storage loc BOS1"
[extract_sap_inventory]
REGEX = Mvt\s+(\d+).*?(?:material\s+)?(M-\d+)\s+"([^"]+)".*?qty\s+(\d+)(?:.*?storage loc\s+(\w+))?
FORMAT = mvt_type::$1 material_id::$2 material_name::$3 qty::$4 storage_loc::$5

# --- Sales orders (VA01) ---
[extract_sap_sales_order]
REGEX = Sales order for customer\s+([\w-]+),\s+(\d+)\s+items,\s+total\s+\$([\d,.]+),\s+ref\s+(ORD-[\d-]+)
FORMAT = customer_id::$1 item_count::$2 order_total::$3 web_order_id::$4

# --- tshirtcid correlation (VA01, VL01N, VF01 -- web order tracking cookie) ---
[extract_sap_tshirtcid]
REGEX = tshirtcid=([\w-]+)
FORMAT = tshirtcid::$1

# --- Financial amounts (FB01, F-28, VF01, ME21N, billing) ---
[extract_sap_amount]
REGEX = \$([\d,]+\.\d{2})
FORMAT = amount::$1

# --- Price changes (MM02) ---
[extract_sap_price_change]
REGEX = Price changed from \$([\d.]+) to \$([\d.]+) for (M-\d+)\s+"([^"]+)"
FORMAT = old_price::$1 new_price::$2 material_id::$3 material_name::$4

# --- Purchase orders (ME21N) ---
[extract_sap_purchase_order]
REGEX = PO to\s+([^(]+?)\s+\(([^)]+)\)
FORMAT = vendor_name::$1 vendor_category::$2

# --- Login/Logout/Auth session fields ---
[extract_sap_session]
REGEX = Client\s+(\d+)
FORMAT = sap_client::$1

[extract_sap_terminal]
REGEX = terminal\s+(T\d+)
FORMAT = terminal::$1

[extract_sap_session_duration]
REGEX = session duration\s+(\d+)\s+min
FORMAT = session_duration::$1

[extract_sap_login_failure]
REGEX = reason:\s+(.+)
FORMAT = login_failure_reason::$1


##############################################################################################################
# CISCO SECURE ACCESS CSV FIELD EXTRACTIONS
# These are headerless CSVs -- REPORT transforms extract fields positionally
##############################################################################################################

# DNS v10: 16 columns
[umbrella_dns_fields]
DELIMS = ","
FIELDS = "Timestamp","Most_Granular_Identity","Identities","InternalIp","ExternalIp","Action","QueryType","ResponseCode","Domain","Categories","Most_Granular_Identity_Type","Identity_Types","Blocked_Categories","Policy_ID","Country","Request_ID"
CLEAN_KEYS = false

# Proxy v5: 26 columns
[umbrella_proxy_fields]
DELIMS = ","
FIELDS = "Timestamp","Policy_Identity_Label","Internal_Client_IP","External_Client_IP","Destination_IP","Content_Type","Action","URL","Referer","User_Agent","Status_Code","Request_Size","Response_Size","Response_Body_Size","SHA256","Categories","AV_Detections","PUAs","AMP_Disposition","Threat_Name","Threat_Reason","Identity_Type","File_Name","Identities","Identity_Types","Request_Method"
CLEAN_KEYS = false

# Firewall: 14 columns
[umbrella_firewall_fields]
DELIMS = ","
FIELDS = "Timestamp","OriginID","Identity","Identity_Type","Direction","IP_Protocol","Packet_Size","Source_IP","Source_Port","Destination_IP","Destination_Port","Data_Center","Policy_ID","Verdict"
CLEAN_KEYS = false


##############################################################################################################
# LOOKUP DEFINITIONS
##############################################################################################################

# Cisco ASA lookups
# NOTE: cisco_asa_messageid.csv exists in lookups/ as reference data but has no
# transform definition wired up. It maps ASA message IDs to descriptions.
# Kept for future use (e.g., automatic_lookup or dashboard enrichment).

[cisco_asa_action_lookup]
batch_index_query = 0
case_sensitive_match = 1
filename = cisco_asa_action_lookup.csv

[cisco_asa_change_analysis_lookup]
batch_index_query = 0
case_sensitive_match = 1
filename = cisco_asa_change_analysis_lookup.csv

[cisco_asa_severity_lookup]
batch_index_query = 0
case_sensitive_match = 1
filename = cisco_asa_severity_lookup.csv

[cisco_asa_syslog_severity_lookup]
batch_index_query = 0
case_sensitive_match = 1
filename = cisco_asa_syslog_severity_lookup.csv

[cisco_asa_vendor_class_lookup]
batch_index_query = 0
case_sensitive_match = 1
filename = cisco_asa_vendor_class_lookup.csv

[cisco_asa_protocol_version]
batch_index_query = 0
case_sensitive_match = 1
filename = cisco_asa_protocol_version.csv

# Windows lookups
[windows_severity_lookup]
batch_index_query = 0
case_sensitive_match = 1
filename = windows_severity_lookup.csv

[windows_signature_lookup]
batch_index_query = 0
case_sensitive_match = 1
filename = windows_signature_lookup.csv

# O365 Exchange lookups
[splunk_ta_o365_cim_messagetrace_action]
batch_index_query = 0
case_sensitive_match = 1
filename = splunk_ta_o365_cim_messagetrace_action.csv


##############################################################################################################
# Cisco ASA extractions
##############################################################################################################

[cisco_asa_log_level_message_id]
REGEX = %(?:ASA|FTD)-(?<log_level>\d+)-(?<message_id>\d+)

[cisco_asa_message_id_302014_302016]
REGEX = -30201[46]:\s*(\S+)\s+(\S+)\s+connection\s+(\d+)\s+for\s+([^:\s]+)\s*:\s*(?:((?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))\s*\/\s*(\d{1,5})(?:\s*\(\s*(?:([\S^\\]+)\\)?([\w\-_@\.]+)\s*\))?\s+to\s+([^:\s]+)\s*:\s*(?:((?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))\s*\/\s*(\d{1,5})(?:\s*\(\s*(?:([\S^\\]+)\\)?([\w\-_]+)\s*\))?\s+[Dd]uration:?\s*(?:(\d+)[dD])?\s*(\d+)[Hh]?\s*:\s*(\d+)[Mm]?\s*:\s*(\d+)[Ss]?\s+bytes\s+(\d+)\s*(?:(.+?(?=\s+from))\s+from\s+(\S+)|([^\(]+))?\s*(?:\(\s*([^\)\s]+)\s*\))?
FORMAT = action::$1 transport::$2 session_id::$3 src_interface::$4 src_ip::$5 src_host::$6 src_port::$7 src_nt_domain::$8 src_user::$9 dest_interface::$10 dest_ip::$11 dest_host::$12 dest_port::$13 dest_nt_domain::$14 dest_user::$15 duration_day::$16 duration_hour::$17 duration_minute::$18 duration_second::$19 bytes::$20 reason::$21 teardown_initiator::$22 reason::$23 user::$24

[cisco_asa_message_id_302013_302015]
REGEX = -30201[35]:\s*(\S+)\s+(\w+)\s+(\S+)(?:\s+connection)?\s+(\d+)\s+for\s+([^:\s]+)\s*:\s*(?:((?:[\d+\.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))\s*\/\s*(\d+)\s*(?:\(\s*(?:((?:[\d+\.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))\s*\/\s*(\d+)\s*\)(?:\s*\(\s*(?:([\S^\\\[]+)\s*[\\\[]\s*)?([^\s\|\)]+)(?:[^\]]+\])?(?:,\s*\S*)?\))?\s+to\s+([^:\s]+)\s*:\s*(?:((?:[\d+\.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))\s*\/\s*(\d{1,5})\s*\(\s*(?:((?:[\d+\.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))\s*\/\s*(\d+)\s*\)(?:\s*\(\s*(?:([\S^\\]+)\\)?([\w\-_]+)\s*\))?(?:\s*\(\s*([^\)\s]+)\s*\))?|\(\s*(\S+)\s*\))
FORMAT = action::$1 direction::$2 transport::$3 session_id::$4 src_interface::$5 src_ip::$6 src_host::$7 src_port::$8 src_translated_ip::$9 src_translated_host::$10 src_translated_port::$11 src_nt_domain::$12 src_user::$13 dest_interface::$14 dest_ip::$15 dest_host::$16 dest_port::$17 dest_translated_ip::$18 dest_translated_host::$19 dest_translated_port::$20 dest_nt_domain::$21 user::$22 user::$23 user::$24

[cisco_asa_message_id_305013]
REGEX = -305013:\s*(?<rule>.+)\s+rules\s+matched\s+for\s+forward\s+and\s+reverse\s+flows\s*;\s*Connection(?:\s*for)?\s+(?<transport>\S+)\s+src\s+(?<src_interface>[^:\s]+)(\(\))?\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d{1,5})\s*(?:\s*\(\s*(?:(?<src_nt_domain>[\S^\\]+)\\)?(?<src_user>[\w\-_]+)\s*\))?\s+dst\s+(?<dest_interface>[^:\s]+)\s*:\s*(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d{1,5})\s*(?:\s*\(\s*(?:(?<dest_nt_domain>[\S^\\]+)\\)?(?<dest_user>[\w\-_]+)\s*\))?\s+(?<action>\S+)

[cisco_asa_message_id_305011_305012]
REGEX = -30501[12]:\s*(?<action>\S+)\s+(?:dynamic|static)\s+(?<transport>\S+)\s+translation\s+from\s+(?<src_interface>[^:\(\s]+)(?:\s*\(\s*(?<rule>[^\)\s]+)\s*\))?\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d{1,5})(?:\s*\(\s*(?:(?<src_nt_domain>[\S^\\]+)\\)?(?<user>[\w\-_]+)\s*\))?\s+to\s+(?<dest_interface>[^:\s]+)\s*:\s*(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d{1,5})(?:\s+[Dd]uration:?\s*(?:(?<duration_day>\d+)[dD])?\s*(?<duration_hour>\d+)[Hh]?\s*:\s*(?<duration_minute>\d+)[Mm]?\s*:\s*(?<duration_second>\d+)[Ss]?)?

[cisco_asa_message_id_106023]
REGEX = -106023:\s*(?<action>\S+)\s+(?<transport>\S+(?:\s+[\S]+)?)\s+src(?:\s+(?<src_interface>[^:\s]+)\s*:\s*(?:(?<src_ip>(?:[\d+\.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>[^\s\/\(]+))(?:\s*\/\s*(?<src_port>\d{1,5}))?)?(?:\s*\(\s*(?:(?:(?<src_nt_domain>[\S^\\]+)\\)?(?<src_user>[\w\-_]+)\s*,)?\s*(?<src_sg_info>[^\)\s]+)\s*\))?\s+dst\s+(?<dest_interface>[^:\s]+)\s*:\s*(?:(?<dest_ip>(?:[\d+\.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>[^\s\/\(]+))(?:\s*\/\s*(?<dest_port>\d+))?(?:\s*\(\s*(?:(?:(?<dest_nt_domain>[\S^\\]+)\\)?(?<dest_user>[\w\-_]+)\s*,)?\s*(?<dest_sg_info>[^\)\s]+)\s*\))?(?:(?:\s+|\s*\(\s*)type\s+(?<icmp_type>\d+)\s*,\s*code\s*(?<icmp_code>\d+)\s*\)?)?\s+by\s+(?<access_group>\S+)\s+(?:\'\s*|\"\s*)?(?<rule>(?<rule_id>[^\"\s]+))(?:\s*\'|\s*\")?\s+(?<hash_codes>[^\]]+\])

[cisco_asa_message_id_106015_106016_106017]
REGEX = -10601[5-7]:\s*(\S+)\s+(?:(\S+)\s*\(\s*no\s+connection\s*\)|(?:IP)\s+(?:spoof|due\s+to\s+Land\s+Attack))?\s+from\s+\(?\s*(?:((?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|([^\s\/\)]+))(?:\s*\/\s*(\d{1,5}))?\s*\)?\s+to\s+(?:((?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|([^\s\/]+))(?:\s*\/\s*(\d{1,5})\s+flags\s+(.+?(?=\s+on)))?(?:\s+on\s+interface\s+(.+?)[\.\s]*$)?$
FORMAT = action::$1 transport::$2 protocol::ip src_ip::$3 src_host::$4 src_port::$5 dest_ip::$6 dest_host::$7 dest_port::$8 tcp_flag::$9 dest_interface::$10

[cisco_asa_message_id_106012]
REGEX = -106012:\s*(\S+)\s+IP\s+from\s+(?:((?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))\s+to\s+(?:((?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))\s*,\s*IP\s+options\s*\:?\s+(?:hex\.?|['"]([^"]+)['"])
FORMAT = action::$1 src_ip::$2 src_host::$3 dest_ip::$4 dest_host::$5 ip_options::$6 transport::"icmp"

[cisco_asa_message_id_106100_106103]
REGEX = -10610[03]:\s*access-list\s+(?<rule_id>\S+)\s*(?<action>\S+)?\s+(?<transport>\S+)\s+(for\s+user\s+['"]?(?<user>[^\s'"]+)['"]?\s+)?(?<src_interface>[^\/\s]+)\s*\/\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>[^\(\s]+))\s*\(?\s*(?<src_port>\d{1,5})\s*\)?\s*(?:\(\s*(?:(?<src_nt_domain>[\S^\\]+)\\)?(?<src_user>[\w\-_]+)\s*,?\s*(?<src_sg_info>[^\)\s]+)\s*\))?\s*(?:\-\>)?\s*(?<dest_interface>[^\/\s]+)\s*\/\s*(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>[^\(\s]+))\s*\(?\s*(?<dest_port>\d{1,5})\s*\)?(?:\s*\(\s*(?:(?<dest_nt_domain>[\S^\\]+)\\)?(?<dest_user>[\w\-_.]+)\s*,?\s*(?<dest_sg_info>[^\)\s]+)?\s*\))?\s+hit-cnt\s+(?<hit_cnt>\d+)\s*\(?\s*(?:first\s+hit|(?<hit_cnt_interval>\d+)\s*-second\s+interval)\s*\)?\s+(?<hash_codes>[^]]+])

[cisco_asa_message_id_109025]
REGEX = -109025:\s*Authorization\s+(?<action>\S+)\s*\(\s*acl\s*=\s*(?<rule_id>[^\)\s]+)\s*\)\s+for\s+user\s+\'\s*(?<user>[^\'\s]+)\s*\'\s+from\s+(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d{1,5})\s+to\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d{1,5})\s+on\s+interface\s+(?<dest_interface>\S+)\s+using\s+(?<transport>\S+)

[cisco_asa_message_id_110002]
REGEX = -110002:\s*(?<vendor_action>\S+)\s+to\s+locate\s+(?<direction>[Ee]gress)\s+interface\s+for\s+(?<transport>\S+)\s+from\s+(?<src_interface>[^:\s]+)\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d{1,5})\s+to\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d{1,5})

[cisco_asa_message_id_111008]
REGEX = -111008:\s*User\s+['"]?\s*([^'"\s]+)\s*['"]?\s+(\S+)\s+(?:the\s+(?:command\s+['"]?\s*([^'"]+)['"]?|(?:['"]\s*([^'"]+)['"]|(.+?(?=\s+command)))\s+command)|cmd\s*:\s*(.+?)[\s\.]*$)
FORMAT = user::$1 action::$2 command::$3 command::$4 command::$5 command::$6

[cisco_asa_message_id_111010]
REGEX = -111010:\s*User\s+['"]?(?<user>[^'"\s]+)['"]?\s*,\s*running\s+['"]?(?<process_name>[^'"\s]+)['"]?\s+from\s+IP\s+(?<src_ip>[^,\s]+)\s*,\s*(?<vendor_action>\S+)\s+['"]?(?<parent_process_name>[^'"]+)['"]?$

[cisco_asa_message_id_113003]
REGEX = -113003:\s*AAA\s+group\s+policy\s+for\s+user\s+(?<user>\S+)\s+is\s+being\s+(?<action>\S+)\s+to\s+(?<object>.+?)[\.\s]*$

[cisco_asa_message_id_113008_113009_113011_113012]
REGEX = -1130(?:1[12]|0[89]):\s*AAA\s+(?:user\s+authentication\s+(?<action>[^:\s]+)\s*:|.+?(?=\s+group\s+policy)\s+group\s+policy\s+\(?\s*(?<group_policy>[^\)]+)(?=(?:\)\sfor\suser|\sfor\suser)))?.+?(?=user)user\s*=?\s*['"]?(?<user>[^'"\s]+)

[cisco_asa_message_id_113019]
REGEX = -113019:\s*Group\s*=\s*(?<Group>[^,]+)\s*,\s*Username\s*=\s*(?<user>[^,\s]+)\s*,\s*IP\s*=\s*(?<src_ip>\S+)\s*,\s*Session\s+disconnected\s*.\s*Session\s+Type\s*:\s*(?<signature>[^,\s]+)\s*,\s*[Dd]uration:?\s*(?:(?<duration_day>\d+)[dD])?\s*(?<duration_hour>\d+)[Hh]?\s*:\s*(?<duration_minute>\d+)[Mm]?\s*:\s*(?<duration_second>\d+)[Ss]?\s*,\s*Bytes\s+xmt\s*:\s*(?<bytes_out>\d+)\s*,\s*Bytes\s+rcv\s*:\s*(?<bytes_in>\d+)\s*,\s*Reason\s*:\s*(?<reason>.+)

[cisco_asa_message_id_113039]
REGEX = -113039:\s*Group\s*<?(?<Group>[^>]+)>?\s*User\s*(?:\<\s*)?(?<user>[^\>\s]+)(?:\s*\>)?\s+IP\s*<?(?<src_ip>[^\>,\s]+)>?\s+(?<signature>\S+)

[cisco_asa_message_id_302020_302021_inbound]
REGEX = -30202[01]:\s*(?<action>\S+)(?:\s+(?<direction>[Ii]nbound))\s+(?<transport>\w+)\s+connection\s+for\s+faddr\s+(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>[^\/\s]+))(?:\s*\/\s*(?<src_port>\d+)\s*)?(?:\s*\(\s*(?:(?<src_nt_domain>[\S^\\]+)\\)?(?<src_user>[\w\-_$&+,:;=?@#|'<>.^*()%!\-\s]+)\s*\))?\s+gaddr\s+(?:(?<dest_public_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_public_host>[^\/\s]+))(?:\s*\/\s*(?<dest_public_port>\d+)\s*)?\s+laddr\s+(?:(?<dest_ip>(?:\d+\.\d+\.\d+\.\d+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>[^\/\s]+))(?:\s*\/\s*(?<dest_port>\d+)\s*)?(?:\s*\(\s*(?:(?<dest_nt_domain>[\S^\\]+)\\)?(?<dest_user>[\w\-_$&+,:;=?@#|'<>.^*()%!\-\s]+)\s*\))?(?:\s*type\s+(?<icmp_type>\d+)\s+code\s+(?<icmp_code>\d+))?

[cisco_asa_message_id_302020_302021_outbound]
REGEX = -30202[01]:\s*(?<action>\S+)(?:\s+(?<direction>[Oo]utbound))?\s+(?<transport>\w+)\s+connection\s+for\s+faddr\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>[^\/\s]+))(?:\s*\/\s*(?<dest_port>\d+)\s*)?(?:\s*\(\s*(?:(?<dest_nt_domain>[\S^\\]+)\\)?(?:(?<dest_user>[\w\.\@]+)[\w\-_$&+,:;=?@#|'<>.^*()%!\s]*)\s*\))?\s+gaddr\s+(?:(?<src_public_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_public_host>[^\/\s]+))(?:\s*\/\s*(?<src_public_port>\d+)\s*)?\s+laddr\s+(?:(?<src_ip>(?:\d+\.\d+\.\d+\.\d+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>[^\/\s]+))(?:\s*\/\s*(?<src_port>\d+)\s*)?(?:\s*\(\s*(?:(?<src_nt_domain>[\S^\\]+)\\)?(?:(?<src_user>[\w\.\@]+)[\w\-_$&+,:;=?@#|'<>.^*()%!\s]*)\s*\))?(?:\s*type\s+(?<icmp_type>\d+)\s+code\s+(?<icmp_code>\d+))?

[cisco_asa_message_id_304001]
REGEX = -304001:\s*(?:([^@\s]+)\s*@)?\s*(?:((?:\d+\.\d+\.\d+\.\d+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))(?:\s*\(\s*(?:([\S^\\]+)\\)?([\w\-_]+)\s*\))?\s+(\S+)\s+URL\s+(?:((?:\d+.\d+.\d+.\d+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))\s*:\s*(\S+)
FORMAT = user::$1 src_ip::$2 src_host::$3 src_nt_domain::$4 src_user::$5 action::$6 dest_ip::$7 dest_host::$8 url::$9 transport::"tcp"

[cisco_asa_message_id_338301]
REGEX = -338301:\s*(?<action>\S+)\s+DNS\s+reply\s+for\s+(?:domain|name)\s+(?<domain_name>\S+)\s+from\s+(?<src_interface>\w+)\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d+)\s+to\s+(?<dest_interface>\w+)\s*:\s*(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d+)\s*,\s*matched\s+(?<matched_list>(?<rule>.*))

[cisco_asa_message_id_338302]
REGEX = -338302:\s*Address\s+(?<ip_address>\S+)\s+[dD]iscovered\s+for\s+domain\s+(?<dest_nt_domain>\S+)\s+from\s+(?<matched_list>[^,\.\s]+)

[cisco_asa_message_id_400013_400032]
REGEX = -4000(?:32|13):?\s*IPS\s*:\s*(?<signature_id>\d+)\s+(?<signature>(?<transport>\S+).+?(?=\s+from))\s+from\s+(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s+to\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s+on\s+interface\s+(?<dest_interface>\S+)

[cisco_asa_message_id_502103]
REGEX = -502103:\s*(?<result>(?<object_category>[Uu]ser)\s+priv\s+level\s+changed\s*):\s*Uname\s*:\s*(?<user>\S+)\s+From\s*:\s*(?<old_privilege_level>\d+)\s+To\s*:\s*(?<new_privilege_level>\d+)

[cisco_asa_message_id_602303_602304_inbound]
REGEX = -60230[34]:\s*(?<signature>\S+)\s*:\s*An\s+(?<direction>[Ii]nbound)\s+(?<tunnel_type>.+?(?=\s+SA))\s+SA\s*\(\s*SPI=\s*(?<SPI>[^\)]+)\s*\)\s*between\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s+and\s+(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s+\(\s*(?:user\s*=\s*)?(?<user>\S+)\s*\)\s+has\s+been\s+(?<vendor_action>\w+)

[cisco_asa_message_id_602303_602304_outbound]
REGEX = -60230[34]:\s*(?<signature>\S+)\s*:\s*An\s+(?<direction>[Oo]utbound)\s+(?<tunnel_type>.+?(?=\s+SA))\s+SA\s*\(\s*SPI=\s*(?<SPI>[^\)]+)\s*\)\s*between\s+(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s+and\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s+\(\s*(?:user\s*=\s*)?(?<user>\S+)\s*\)\s+has\s+been\s+(?<vendor_action>\w+)

[cisco_asa_message_id_713049]
REGEX = -713049:\s*(?:Group\s*=\s*([^,]+)\s*,\s*(?:Username\s*=\s*([^,]+)\s*,\s*)?\s*IP\s*=\s*([^,]+)\s*,\s*)?Security\s+negotiation\s+complete\s+for\s+(?:(.+(?:(?=\s+type)|(?=\s+Group)))\s+(?:type\s*\(([^\)]+)\s*\)|Group\s*\([^\)]+\))|User\s*\(\S+\))\s*\S+\s*,\s*Inbound\s+SPI\s*=\s*(\w+)\s*,\s*Outbound\s+SPI\s*=\s*(\w+)
FORMAT = Group::$1 user::$2 ip_address::$3 tunnel_type::$4 Group::$5 inbound_spi::$6 outbound_spi::$7

[cisco_asa_message_id_713075]
REGEX = -713075:\s*(?:Group\s*=\s*(?<Group>.+)\s*,\s*Username\s*=\s*(?<user>\S+)\s*,\s*IP\s*=\s*(?<ip_address>[^,\s]+)\s*,\s*)?Overriding\s+Initiator's\s+IP[Ss]ec\s+rekeying\s+duration\s+from\s+(?<larger_value>\d+)\s+to\s+(?<smaller_value>\d+)\s+seconds

[cisco_asa_message_id_713119]
REGEX = -713119:\s*Group(?:\s*=)?\s*(?<Group>[^,]+)\s*,?(?:\s*Username\s*=\s*(?<user>\S+),)?\s+IP(?:\s*=)?\s*(?<ip_address>[^,\s]+)

[cisco_asa_message_id_713120]
REGEX = -713120:\s*(?:Group(?:\s*=\s*)?(?<Group>[^,]+)\s*,?\s*(?:Username\s*=\s*(?<user>\S+)\s*,\s*)?IP\s*=\s*(?<ip_address>[^,\s]+)\s*,\s*?\s*)?PHASE\s+2\s+COMPLETED\s*(?:\(\s*msgid\s*=\s*(?<msgid>\S+)\s*\))

[cisco_asa_message_id_713130]
REGEX = -713130:\s*(?:Group\s*=\s*(?<Group>.+)\s*,\s*Username\s*=\s*(?<user>\S+)\s*,\s*IP\s*=\s*(?<ip_address>[^,\s]+)\s*,\s*)?Received\s+unsupported\s+transaction\s+mode\s+attribute\s*:\s*(?<attribute_id>\d+)

[cisco_asa_message_id_713172]
REGEX = -713172:\s*(?:Group\s*=\s*(?<Group>.+)\s*,\s*IP\s*=\s*(?<ip_address>[^,\s]+))?

[cisco_asa_message_id_713184]
REGEX = -713184:\s*(?:Group\s*=\s*(?<Group>.+)\s*,\s*Username\s*=\s*(?<user>\S+)\s*,\s*IP\s*=\s*(?<ip_address>[^,\s]+)\s*,\s*)?Client\s+Type\s*:\s*(?<client_type>\w+)\s*Client\s+Application\s+Version\s*:\s*(?<client_app_version>\S+)

[cisco_asa_message_id_713228]
REGEX = -713228:\s*Group\s*=\s*(?<Group>[^,]+)\s*,\s*Username\s*=\s*(?<user>\S+)\s*,\s*IP\s*=\s*(?<src_ip>[^,\s]+),?\s*Assigned\s+private\s*IP\s+address\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s+to\s+remote\s+user

[cisco_asa_message_id_713905]
REGEX = -713905:\s*(?:Group\s*=\s*(?<Group>.+)\s*,\s*Username\s*=\s*(?<user>\S+)\s*,\s*IP\s*=\s*(?<ip_address>[^,\s]+)\s*,.+expire\s+in\s+(?<expiration_sec>\d+))?

[cisco_asa_message_id_716038]
REGEX = -716038:\s*Group\s+<?(?<Group>[^\>]+)>?\s+User\s+<?(?<user>[^\>\s]+)>?\s+IP\s+<?(?<src_ip>[^>\s]+)>?\s+Authentication\s*\:\s*(?<action>\S+)\s*,\s*Session\s+Type\s*:\s*(?<app>[^.]+)

[cisco_asa_message_id_716039]
REGEX = -716039:\s*(?:Group\s+\<([^\>]+)\>\s+User\s+\<([^\>]+)\>\s+IP\s+\<([^\>]+)\>\s+)?Authentication\s*\:\s*([^,]+)\s*,(?:\s*group\s*=\s*(.+)\s+user\s*=\s*([^,\s]+)\s*,?)?\s*Session\s*Type\s*:\s*(.+?)[\s\.]*$
FORMAT = Group::$1 user::$2 src_ip::$3 action::$4 Group::$5 user::$6 signature::$7

[cisco_asa_message_id_722051]
REGEX = -722051:\s*Group\s+(?:\<\s*)?(?<Group>[^\>]+)(?:\>\s*)?\s+User\s+(?:\<\s*)?(?<user>[^\>\s]+)(?:\s*\>)?\s+IP\s+(?:\<\s*)?(?<src_ip>[^\>\s]+)(?:\>\s*)?\s+IPv4\s+[Aa]ddress\s+(?:\<\s*)?(?<assigned_ipv4>[^\>\s]+)(?:\>\s*)?\s+IPv6\s+[Aa]ddress\s+(?:\<\s*)?(?<assigned_ipv6>[^\>\s]+)(?:\>\s*)?\s+(?<vendor_action>\S+)

[cisco_asa_message_id_733100]
REGEX = -733100:\s*\[(?<object>[^\]]+)\]\s+drop\s+rate(?:\s*\-?\s*|\s+)(?<rate_id>\d+)\s+exceeded\.\s*Current\s+burst\s+rate\s+is\s+(?<current_burst_rate>\d+)\s+per\s+second\s*,\s*max\s+configured\s+rate\s+is\s+(?<max_config_burst_rate>\d+)\s*;\s*Current\s+average\s+rate\s+is\s+(?<current_avg_rate>\d+)\s+per\s+second\s*,\s+max\s+configured\s+rate\s+is\s+(?<max_config_cumulative_rate>\d+)\s*;\s*Cumulative\s+total\s+count\s+is\s+(?<total_count>\d+)

[cisco_asa_message_id_805001_805002_805003]
REGEX = -80500[1-3]:\s*(\S+)?\s*(?:Flow(?:\s+is\s+no\s+longer|\s+could\s+not\s+be)?\s+offloaded\s*(?::|for)|Offloaded\s+(\S+)\s+Flow\s+for)\s+connection\s+(\d+)(?:\s+from)?\s+([^:\s]+)\s*:\s*(?:((?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))\s*\/\s*(\d+)\s*\(\s*(?:((?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))\s*\/\s*(\d+)\s*\)(?:\s+to)?\s*([^:\s]+)\s*:\s*(?:((?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))\s*\/\s*(\d+)\s*\(\s*(?:((?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))\s*\/\s*(\d+)\s*\)\s*(\S+)?
FORMAT = transport::$1 transport::$2 session_id::$3 src_interface::$4 src_ip::$5 src_host::$6 src_port::$7 src_translated_ip::$8 src_translated_host::$9 src_translated_port::$10 dest_interface::$11 dest_ip::$12 dest_host::$13 dest_port::$14 dest_translated_ip::$15 dest_translated_host::$16 dest_translated_port::$17 transport::$18

[cisco_asa_message_id_419002]
REGEX = -419002:(?:\s*Received)?\s*(?:d|D)uplicate\s+(?<transport>\S+)\s+SYN\s+from\s+(?<src_interface>[^\:\s]+)\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d{1,5})\s+to\s+(?<dest_interface>[^\:\s]+)\s*:\s*(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d{1,5})\s*with

[cisco_asa_message_id_607001_608001]
REGEX = -60[78]001:\s*(?<action>\S+)\s+(?:SIP|Skinny)\s+(?<connection_type>.+?(?=\s+secondary))\s+secondary\s+channel\s+for\s+(?<src_interface>[^:\s]+)\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>[^\s\/]+))(?:\s*\/\s*(?<src_port>\d{1,5}))?\s+to\s+(?<dest_interface>[^:\s]+)\s*:\s*(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s+from\s+(?<message>.*)\s+message

[cisco_asa_message_id_716014_716015]
REGEX = -71601[45]:\s*Group\s+(?<Group>.+)\s+User\s+(?<user>\S+)\s+(?<action>\S+)\s+file\s+(?<file_name>.+?)[\s\.]*$

[cisco_asa_message_id_716016]
REGEX = -716016:\s*Group\s+(?<Group>.+)\s+User\s+(?<user>\S+)\s+(?<action>\S+)\s+file\s+(?<old_file_name>\S+)\s+to\s+(?<file_name>.+?)[\s\.]*$

[cisco_asa_message_id_106001]
REGEX = -106001:\s*(?<direction>[Ii]nbound)\s+(?<transport>\S+)\s+connection\s+(?<action>\S+)\s+from\s+(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d{1,5})\s+to\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d{1,5})\s+flags\s+(?<tcp_flag>.+)\s+on\s+interface\s+(?<dest_interface>\S+)

[cisco_asa_message_id_313001_313004]
REGEX = -31300[14]:\s*(?<action>\S+)\s+(?<transport>\S+)\s+type\s*=\s*(?<icmp_type>[^,\s]+)\s*(?:,\s*code\s*=\s*(?<icmp_code>\d+))?,?\s*from\s+(?:laddr\s+)?(?:(?<src_ip>(?:[\d+\.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s+on\s+interface\s+(?<dest_interface>\S+)(?:\s+to\s+(?:(?<dest_ip>(?:[\d+\.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*:\s*no)?

[cisco_asa_message_id_303002]
REGEX = -303002:\s*(\S+)\s+connection\s+from\s+([^:\s]+)\s*:\s*(?:((?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))\s*\/\s*(\d+)\s+to\s+([^:\s]+)\s*:\s*(?:((?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))\s*\/\s*(\d+)\s*,\s*user\s+(\S+)\s+(\S+)\s+file\s+(.+?)[\s\.]*$
FORMAT = app::$1 src_interface::$2 src_ip::$3 src_host::$4 src_port::$5 dest_interface::$6 dest_ip::$7 dest_host::$8 dest_port::$9 user::$10 vendor_action::$11 file_name::$12 transport::"tcp"

[cisco_asa_message_id_710002_710003_710005_710006]
REGEX = -71000[2356]:\s*(?<transport>\S+)\s+\S+\s+(?<action>\S+)\s+(?:by\s+ACL\s+)?from\s+(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>[^\s\/]+))(?:\s*\/\s*(?<src_port>\d+))?\s+to\s+(?<dest_interface>[^:\s]+)\s*:\s*(?:(?<dest_ip>(?:\d+.\d+.\d+.\d+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>[^\s\/]+))(?:\s*\/\s*(?<service>\S+))?

[cisco_asa_message_id_302010]
REGEX = -302010:\s*(?<connections_in_use>\S+)\s+in\s+use\s*,\s*(?<most_used_connections>\S+)

[cisco_asa_message_id_500004]
REGEX = -500004:\s*Invalid\s+transport\s+field\s+for\s+protocol\s*=\s*(?<transport>[^,\s]+)\s*,\s*from\s+(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d+)\s+to\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d+)

[cisco_asa_message_id_106020_106021]
REGEX = -10602[01]:\s*(\S+)\s+(?:IP\s+teardrop\s+fragment\s*\(\s*size\s*=\s*(\d+)\s*,\s*offset\s*=\s*(\d+)\s*\)|protocol\s+reverse\s+path\s+check)?\s+from\s+(?:((?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))\s+to\s+(?:((?:\d+\.\d+\.\d+\.\d+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))(?:\s+on\s+interface\s+(\S+))?
FORMAT = action::$1 size::$2 offset::$3 src_ip::$4 src_host::$5 dest_ip::$6 dest_host::$7 dest_interface::$8 transport::"icmp"

[cisco_asa_message_id_419003]
REGEX = -419003:\s*Cleared\s+(?<transport>\S+)\s+urgent\s+flag\s+from\s+(?<src_interface>[^:\s]+)\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d+)\s+to\s+(?<dest_interface>[^:\s]+)\s*:\s*(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d+)\.?

[cisco_asa_message_id_711004]
REGEX = -711004:\s*Task\s+ran\s+for\s+(?<cpu_hog_length>\d+)\s+msec\s*,\s*Process\s*=\s*(?<process_name>[^,\s]+)\s*,\s*PC\s*=\s*(?<instruction_pointer>[^,\s]+)\s*,\s*Call\s+stack\s*=\s*(?<stack_trace>\S+)?

[cisco_asa_message_id_313009]
REGEX = -313009:\s*(?<action>\S+)\s+invalid\s+(?<transport>\S+)\s+code\s+(?<icmp_code>[^,\s]+)\s*,\s*for\s+(?<src_interface>[^:\s]+)\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d+)\s*\(\s*(?:(?<src_translated_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_translated_host>\S+))\s*\/\s*(?<src_translated_port>\d+)\s*\)\s+to\s+(?<dest_interface>[^:\s]+)\s*:\s*(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d+)\s*\(\s*(?:(?<dest_translated_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_translated_host>\S+))\s*\/\s*(?<dest_translated_port>\d+)\s*\)\s*(?<user>\w+)?\s*,\s+ICMP\s+id\s+(?<icmp_id>[^,\s]+)\s*,\s*ICMP\s+type\s+(?<icmp_type>\S+)

[cisco_asa_message_id_500003]
REGEX = -500003:\s*Bad\s+(?<transport>\S+)\s+hdr\s+length\s*\(\s*hdrlen\s*=\s*(?<header_length>\d+)\s*,\s*pktlen\s*=\s*(?<packet_length>\d+)\s*\)\s*from\s+(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d+)\s+to\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d+)\s*,\s*flags\s*:\s*(?<tcp_flag>[^,]+)\s*,\s*on\s+interface\s+(?<dest_interface>\S+)

[cisco_asa_message_id_106006_106007]
REGEX = -10600[67]:\s*(?<action>\S+)\s+(?<direction>[Ii]nbound)\s+(?<transport>\S+)\s+from\s+(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d+)\s+to\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d+)(?:\s+on\s+interface\s+(?<dest_interface>.+?)[\s\.]*$)?

[cisco_asa_message_id_106014]
REGEX = -106014:\s*(?<action>\S+)\s+(?<direction>[Ii]nbound)\s+(?<transport>\S+)\s+src\s+(?<src_interface>[^:\s]+)\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s+(?:\(\s*(?:(?:(?<src_nt_domain>[\S^\\]+)\\)?(?<src_user>[\w\-_]+)\s*,)?\s*(?<src_sg_info>[^\)\s]+)\s*\)\s+)?dst\s+(?<dest_interface>[^:\s]+)\s*:\s*(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s+(?:\(\s*(?:(?:(?<dest_nt_domain>[\S^\\]+)\\)?(?<dest_user>[\w\-_]+)\s*,)?\s*(?<dest_sg_info>[^\)\s]+)\s*\)\s+)?\(\s*type\s+(?<icmp_type>[^,\s]+)\s*,\s*code\s+(?<icmp_code>[^\)\s]+)\s*\)

[cisco_asa_message_id_113004_113005]
REGEX = -11300[45]:\s*AAA\s+user\s+(?:authentication|(?<signature>\S+))\s+(?<action>\S+)\s*:(?:\s*reason\s*=\s*(?<reason>.*[^:\s])\s*:)?\s*server\s*=\s*(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*[:,]\s*[uU]ser\s*=\s*(?<user>[^:\s]+)(?:\s*:\s*user\s+IP\s*=\s*(?<src_ip>\S+))?

[cisco_asa_message_id_314001]
REGEX = -314001:\s*(?<action>Pre-(?:allocate|allocated))\s+RTSP\s+(?<transport>\S+)\s+backconnection\s+for\s+(?<src_interface>[^:\s]+)\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s+to\s+(?<dest_interface>[^:\s]+)\s*:\s*(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d+)

[cisco_asa_message_id_402119]
REGEX = -402119:\s*IPSEC\s*:\s*Received\s+an\s+(?<transport>\S+)\s+packet\s*\(\s*SPI\s*=\s*(?<SPI>[^\s,]+)\s*,\s*sequence\s+number\s*=\s*(?<sequence_number>[^\s\)]+)\s*\)\s+from\s+(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\((?:user\s*=\s*)?\s*(?<user>[^\s\)]+)\s*\)\s+to\s+(?:(?<dest_ip>(?:\d+\.\d+\.\d+\.\d+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s+that

[cisco_asa_message_id_602101]
REGEX = -602101:\s*PMTU\s*-\s*D\s+packet\s+(?<bytes>\d+)\s+bytes\s+greater\s+than\s+effective\s+mtu\s+(?<effective_mtu>\d+)\s*,?\s*dest_addr\s*=\s*(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*,\s*src_addr\s*=\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*,\s*prot\s*=\s*(?<transport>\S+)

[cisco_asa_message_id_611101]
REGEX = -611101:\s*User\s+authentication\s+(?<action>[^:\s]+)\s*:\s*IP\s*(?:,|[Aa]ddress)\s*:?\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*(?::|,)\s*Uname\s*:\s*(?<user>\S+)

[cisco_asa_message_id_702307]
REGEX = -702307:\s*IPSEC\s*:\s*An\s+(?<direction>\w+)\s+(?<tunnel_type>.+?(?=\s+SA))\s+SA\s*\(\s*SPI\s*=\s*(?<SPI>[^\)\s]+)\s*\)\s+between\s+(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s+and\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\(\s*(?:user\s*=\s*)?(?<user>[^\)\s]+)\s*\)

[cisco_asa_message_id_713041]
REGEX = -713041:(?:\s*Group\s*=\s*(?<Group>[^,]+)\s*,\s*IP\s*=\s*(?<ip_address>[^,\s]+)\s*,)?\s*IKE\s+Initiator\s*:\s*\S+\s+Phase\s+(?<phase>\d+)\s*,\s*Intf\s+(?<interface_number>[^,\s]+)\s*,\s*IKE\s+Peer\s+(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s+local\s+Proxy\s+Address\s+(?:(?<local_proxy_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<local_proxy_host>\S+))\s*,\s*remote\s+Proxy\s+Address\s+(?:(?<remote_proxy_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<remote_proxy_host>\S+))\s*,\s*Crypto\s+map\s*\(\s*(?<crypto_map_tag>[^\s\)]+)\s*\)

[cisco_asa_message_id_713121]
REGEX = -713121:(?:\s*IP\s*=\s*(?<dest_ip>[^,\s]+)\s*,)?\s*Keep\s*-\s*alive\s+type\s+for\s+this\s+connection\s*:\s*(?<keepalive_type>\S+)

[cisco_asa_message_id_713236]
REGEX = -713236:(?:\s*IP\s*=\s*(?<dest_ip>[^,\s]+)\s*,)?\s*IKE_DECODE\s+(?<message>\S+)\s+Message\s*\(\s*msgid\s*=\s*(?<msgid>[^\)\s]+)\s*\)\s+with\s+payloads\s*:(?:.*)total\s+length\s*:\s*(?<total_payload_length>\d+)

[cisco_asa_message_id_713903]
REGEX = -713903:\s*(?:IKE\s+Receiver\s*:\s*Runt\s+ISAKMP\s+packet\s+discarded\s+on\s+Port\s+(?<dest_port>\d{1,5})\s+from\s+(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*:\s*(?<src_port>\d{1,5})|(?<IKE_error_message>.+?(?=\s+reason))\s+reason\s+(?<reason>.+?)[\.\s]*$)

[cisco_asa_message_id_713906]
REGEX = -713906:\s*(?:Group\s*=\s*(?<Group>[^,]+)\s*,\s*IP\s*=\s*(?<ip_address>[^,\s]+)\s*,\s*Active\s+unit\s+activates\s+new\s+SA\s+for\s+remote\s+peer\s+(?:(?<peer_address>(?:\d+\.\d+\.\d+\.\d+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<peer_host>.+?))[\.\s]*$)?

[cisco_asa_message_id_714002_714004_714006]
REGEX = -71400[246]:(?:\s*Group\s*=\s*(?<Group>[^,]+)\s*,\s*IP\s*=\s*(?<src_ip>[^,\s]+)\s*,)?\s*IKE\s+Initiator\s+\S+(?:\s+1st|\s+3rd)?\s+QM(?:\s+pkt)?\s*:\s*msg\s+id\s*=\s*(?<msgid>[^\.\s]+)

[cisco_asa_message_id_714011]
REGEX = -714011:(?:\s*Group\s*=\s*(?<Group>[^,]+)\s*,\s*IP\s*=\s*(?<dest_ip>[^,\s]+)\s*,)?\s*(?<display_id_info>.+?)[\s\.]*$

[cisco_asa_message_id_715001]
REGEX = -715001:(?:\s*Group\s*=\s*(?<Group>[^,]+)\s*,\s*IP\s*=\s*(?<ip_address>[^,\s]+)\s*,)?\s*(?<desc>.+?)[\s\.]*$

[cisco_asa_message_id_715006_715007]
REGEX = -71500[67]:(?:\s*Group\s*=\s*(?<Group>[^,]+)\s*,\s*IP\s*=\s*(?<dest_ip>[^,\s]+)\s*,)?\s*IKE\s+got\s+(?:SPI\s+from\s+key\s+engine|a\s+KEY_ADD\s+msg\s+for\s+SA)\s*:\s*SPI\s*=\s*(?<SPI>[^\.\s]+)

[cisco_asa_message_id_715009]
REGEX = -715009:(?:\s*Group\s*=\s*(?<Group>[^,]+)\s*,\s*IP\s*=\s*(?<ip_address>[^,\s]+)\s*,)?\s*IKE\s+Deleting\s+SA\s*:\s*Remote\s+Proxy\s+(?:(?<remote_proxy_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<remote_proxy_host>\S+))\s*,\s*Local\s+Proxy\s+(?:(?<local_proxy_ip>(?:\d+\.\d+\.\d+\.\d+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<local_proxy_host>\S+))

[cisco_asa_message_id_715038]
REGEX = -715038:(?:\s*IP\s*=\s*(?<ip_address>[^,\s]+)\s*,)?\s*(?<action>\S+)\s+(?<spoofing_information>.+)\s+Vendor\s+ID\s+payload\s*\(\s*version\s*:\s*(?<version>\d+(?:\.\d+)*)\s*,\s*capabilities\s*:\s*(?<capabilities>[^\)\s]+)\s*\)

[cisco_asa_message_id_715046]
REGEX = -715046:\s*Group\s*=\s*(?<Group>[^,]+)\s*,(?:\s*Username\s*=\s*(?<user>[^,\s]+)\s*,)?\s*IP\s*=\s*(?<src_ip>[^,\s]+)\s*,\s*(?<action>\S+)\s+(?<payload_description>.+)\s+payload

[cisco_asa_message_id_715047]
REGEX = -715047:(?:\s*IP\s*=\s*(?<dest_ip>[^,\s]+)\s*,)?\s*(?<action>\S+)\s+(?<payload_description>.+)\s+payload

[cisco_asa_message_id_715048]
REGEX = -715048:(?:\s*IP\s*=\s*(?<src_ip>[^,\s]+)\s*,)?\s*Send\s+(?<vid_type>.+)\s+VID

[cisco_asa_message_id_715049]
REGEX = -715049:(?:\s*IP\s*=\s*(?<dest_ip>[^,\s]+)\s*,)?\s*Received\s+(?<vid_type>.+)\s+VID

[cisco_asa_message_id_715065]
REGEX = -715065:\s*(?:IP\s*=\s*(?<ip_address>\S+),\s+)?IKE\s+(?<state_machine>\S+)\s+(?<subtype>\S+)\s+FSM\s+error\s+history\s*\(\s*struct\s+(?<data_structure_address>[^\)\s]+)\s*\)\s+\<?state\>?\s*,\s*\<?event\>?\s*:\s*(?<state_event_pairs>.+?)[\.\s]*$

[cisco_asa_message_id_715076]
REGEX = -715076:\s*(?:Group\s*=\s*(?<Group>[^,]+)\s*,\s*IP\s*=\s*(?<ip_address>[^,\s]+))?

[cisco_asa_message_id_715077]
REGEX = -715077:(?:\s*Group\s*=\s*(?<Group>[^,]+)\s*,\s*IP\s*=\s*(?<dest_ip>[^,\s]+)\s*,)?\s*Pitcher\s*:\s*(?<pitcher_msg>[^,]+)\s*,\s*spi\s+(?<SPI>\S+)

[cisco_asa_message_id_715080]
REGEX = -715080:(?:\s*Group\s*=\s*(?<Group>[^,]+)\s*,\s*IP\s*=\s*(?<ip_address>[^,\s]+)\s*,|\s*VPN\s*:)?\s*(?<action>\S+)\s+P(?<phase>\d+)\s+rekey\s+timer\s*:\s*(?<rekey_timer>\d+)\s+seconds

[cisco_asa_message_id_716001_716002]
REGEX = -71600[12]:\s*Group\s+(?:\<\s*)?(?<Group>[^\>]+)(?:\s*\>)?\s+User\s+(?:\<\s*)?(?<user>[^\s\>]+)(?:\s*\>)?\s+IP\s+(?:\<\s*)?(?<src_ip>[^\s\>]+)(?:\s*\>)?\s+(?<signature>\S+)\s+session\s+(?<vendor_action>\w+)(\s*:\s*(?<reason>.+?)[\s\.]*$)?

[cisco_asa_message_id_716058_716059]
REGEX = -71605[89]:\s*Group\s+(?:\<\s*)?(?<Group>[^\>]+)(?:\s*\>)?\s+User\s+(?:\<\s*)?(?<user>[^\s\>]+)(?:\s*\>)?\s+IP\s+(?:\<\s*)?(?<src_ip>[^\s\>]+)(?:\s*\>)?\s+(?<signature>\S+)\s+session\s+(?<vendor_action>resumed)?

[cisco_asa_message_id_716603]
REGEX = -716603:\s*Received\s+(?<bytes_in>\d+)\s+KB\s+Hostscan\s+data\s+from\s+IP\s+(?:\<\s*)?(?:(?<src_ip>(?:\d+\.\d+\.\d+\.\d+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>[^\s\>]+))

[cisco_asa_message_id_717009]
REGEX = -717009:\s*Certificate\s+validation\s+([^\.\s]+)\s*\.\s*(?:Reason\s*:\s*(.+?)[\s\.]*$|([\S+\s+]*subject\s+name\s*:\s*(cn\s*=\s*([^,]+)\s*,\s*ou\s*=\s*(?:[^,]+)\s*,\s*o\s*=\s*([^,]+))\s*,\s*serialNumber\s*=\s*([^,]+)\s*,\s*issuer\s+name\s*:\s*(cn\s*=\s*([^,]+)\s*,\s*o\s*=\s*(\S+))))
FORMAT = ssl_is_valid::$1 reason::$2 reason::$3 ssl_subject::$4 ssl_subject_common_name::$5 ssl_subject_organization::$6 ssl_serial::$7 ssl_issuer::$8 ssl_issuer_common_name::$9 ssl_issuer_organization::$10

[cisco_asa_message_id_717016]
REGEX = -717016:\s*Removing\s+expired\s+CRL\s+from\s+the\s+CRL\s+cache\s*\.\s*Issuer\s*:\s*(?<ssl_issuer>(?:cn\s*=\s*(?<ssl_issuer_common_name>[^,]+))?.+)

[cisco_asa_message_id_717022]
REGEX = -717022:\s*Certificate\s+was\s+successfully\s+(?<ssl_is_valid>[^\.\s]+)\s*\.\s*serial\s+number\s*:\s*(?<ssl_serial>[^,\s]+)\s*,\s*subject\s*name\s*:\s*(?<ssl_subject>cn\s*=\s*(?<ssl_subject_common_name>[^,\s]+).*)(?<!\.)

[cisco_asa_message_id_717024]
REGEX = -717024:\s*Checking\s+CRL\s+from\s+trustpoint\s*:\s*(?<trustpoint_name>\S+)\s+for\s+(?<reason>.+?)[\.\s]*$

[cisco_asa_message_id_717025]
REGEX = -717025:\s*Validating\s+certificate\s+chain\s+containing\s+(?<number_of_certs>\d+)

[cisco_asa_message_id_717027]
REGEX = -717027:\s*Certificate\s+chain\s+(?<ssl_is_valid>\S+)\s+validation\s*\.\s*(?<reason>.+?)[\.\s]*$

[cisco_asa_message_id_717028]
REGEX = -717028:\s*Certificate\s+chain\s+was\s+successfully\s+(?<ssl_is_valid>\S+)\s+(?<additional_info>.+?)[\s\.]*$

[cisco_asa_message_id_717029]
REGEX = -717029:\s*Identified\s+client\s+certificate\s+within\s+certificate\s+chain\s*.\s*serial\s+number\s*:\s*(?<ssl_serial>\w+)\s*,\s*subject\s+name\s*:\s*(?<ssl_subject>(?:cn\s*=\s*(?<ssl_subject_common_name>[^,\s]+).*)(?<!\.))

[cisco_asa_message_id_717030]
REGEX = -717030:\s*Found\s+a\s+suitable\s+trustpoint\s+(?<trustpoint_name>\S+)

[cisco_asa_message_id_717036]
REGEX = -717036:\s*[\S+\s+]*serial\s+number\s*:\s*(?<ssl_serial>[^,\s]+)\s*,\s*subject\s+name\s*:\s*(?<ssl_subject>cn\s*=\s*(?<ssl_subject_common_name>[^,\s]+))\s*,\s*issuer_name\s*:\s*(?<ssl_issuer>cn\s*=\s*(?<ssl_issuer_common_name>[^,]+).+?)[\s\.]*$

[cisco_asa_message_id_717037]
REGEX = -717037:\s*Tunnel\s+group\s+search\s+using\s+certificate\s+maps\s+(?<ssl_is_valid>\S+)\s+for\s+peer\s+certificate\s*:\s*(?<certificate_identifier>(?:serial\s+number\s*:\s*(?<ssl_serial>[^,\s]+)\s*,\s*subject\s+name\s*:\s*(?<ssl_subject>cn\s*=\s*(?<ssl_subject_common_name>[^,\s]+))\s*,\s*issuer\s*\_?name\s*:\s*(?<ssl_issuer>cn\s*=\s*(?<ssl_issuer_common_name>[^,]+).+?))|.+?)[\s\.]*$

[cisco_asa_message_id_717056]
REGEX = -717056:\s*Attempting\s+(?<revocation_check_type>\S+)\s+revocation\s+check\s+from\s+(?<src_interface>[^:\s]+)\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d{1,5})\s+to\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d{1,5})\s+using\s+(?<transport>\w+)

[cisco_asa_message_id_720041]
REGEX = -720041:\s*\(\s*VPN\s*-\s*(?<unit>[^\)\s]+)\s*\)\s+Sending\s+(?<message_type>.+)\s+message\s*(?<msgid>\d+)?(?:\s+user\s+(?<user>[^,\s]+)\s*,\s*IP\s+(?<src_ip>\S+))?\s+to

[cisco_asa_message_id_722001_722003]
REGEX = -72200[13]:\s*IP\s+(?:\<\s*)?(?<src_ip>[^\>\s]+)(?:\s*\>)?

[cisco_asa_message_id_722010_722011_722012]
REGEX = -72201[012]:\s*Group\s+(?:\<\s*)?(?<Group>[^\>]+)(?:\s*\>)?\s+User\s+(?:\<\s*)?(?<user>[^\>\s]+)(?:\s*\>)?\s+IP\s+(?:\<\s*)?(?<src_ip>[^\s\>]+)(?:\s*\>)?\s+SVC\s+Message\s*:\s*(?<message_type>\d+)\s*\/\s*\S+\s*:\s*(?<message>.+?)[\s\.]*$

[cisco_asa_message_id_722022]
REGEX = -722022:\s*Group\s+(?:\<\s*)?(?<Group>[^\>]+)(?:\s*\>)?\s+User\s+(?:\<\s*)?(?<user>[^\>\s]+)(?:\s*\>)?\s+IP\s+(?:\<\s*)?(?<src_ip>[^\s\>]+)(?:\s*\>)?\s+(?<transport>\S+)(?:\s+(?<signature>SVC))?\s+connection\s+(?<vendor_action>\S+)

[cisco_asa_message_id_722023]
REGEX = -722023:\s*Group\s+(?:\<\s*)?(?<Group>[^\>]+)(?:\s*\>)?\s+User\s+(?:\<\s*)?(?<user>[^\>\s]+)(?:\s*\>)?\s+IP\s*(?:\<\s*)?(?<src_ip>[^\>\s]+)(?:\s*\>)?(?:\s+(?<transport>\S+))?\s+(?<signature>\S+)\s+connection\s+(?<vendor_action>\S+)

[cisco_asa_message_id_722028]
REGEX = -722028:\s*Group\s+(?:\<\s*)?(?<Group>[^\>]+)(?:\s*\>)?\s+User\s+(?:\<\s*)?(?<user>[^\>\s]+)(?:\s*\>)?\s+IP\s+(?:\<\s*)?(?<src_ip>[^\>\s]+)(?:\s*\>)?\s+Stale\s+(?<signature>\S+)\s+connection\s+(?<vendor_action>\w+)

[cisco_asa_message_id_722029]
REGEX = -722029:\s*Group\s+(?:<\s*)?(?<Group>[^\>]+)(?:\s*>)?\s+User\s+(?:<\s*)?(?<user>[^\>\s]+)(?:\s*>)?\s+IP\s+(?:<\s*)?(?<src_ip>[^\>\s]+)(?:\s*>)?\s+(?<signature>\S+)\s+Session\s+(?<vendor_action>\S+)\s*:\s*Conns\s*:\s*(?<total_connections>\d+)\s*,\s*DPD\s+Conns\s*:\s*(?<number_of_reconnections>\d+)\s*,\s*Comp\s+resets\s*:\s*(?<compression_resets>\d+)\s*,\s*Dcmp\s+resets\s*:\s*(?<decompression_resets>\d+)\.?

[cisco_asa_message_id_722030]
REGEX = -722030:\s*Group\s+(?:<\s*)?(?<Group>[^>]+)(?:\s*>)?\s+User\s+(?:<\s*)?(?<user>[^>\s]+)(?:\s*>)?\s*IP\s+(?:<\s*)?(?<src_ip>[^>\s]+)(?:\s*>)?\s+(?<signature>\S+)\s+Session\s+(?<vendor_action>\S+)\s*:\s*In\s*:\s*(?<inbound_data_bytes>\d+)\s*\(\s*\+(?<inbound_control_bytes>\d+)\s*\)\s*bytes\s*,\s*(?<inbound_data_packets>\d+)\s*\(\s*\+(?<inbound_control_packets>\d+)\s*\)\s*packets\s*,\s*(?<dropped_inbound_packets>\d+)

[cisco_asa_message_id_722031]
REGEX = -722031:\s*Group\s+(?:<\s*)?(?<Group>[^>]+)(?:\s*>)?\s*User\s+(?:<\s*)?(?<user>[^>\s]+)(?:\s*>)?\s+IP\s+(?:<\s*)?(?<src_ip>[^>\s]+)(?:\s*>)?\s+(?<signature>\S+)\s+Session\s+(?<vendor_action>\S+)\s*:\s*Out\s*:\s*(?<outbound_data_bytes>\d+)\s+\(\s*\+(?<outbound_control_bytes>\d+)\s*\)\s*bytes\s*,\s*(?<outbound_data_packets>\d+)\s*\(\s*\+(?<outbound_control_packets>\d+)\s*\)\s*packets\s*,\s*(?<dropped_outbound_packets>\d+)

[cisco_asa_message_id_722032_722033_722034]
REGEX = -72203[2-4]:\s*Group\s+(?:\<\s*)?(?<Group>[^\>]+)(?:\s*\>)?\s+User\s+(?:\<\s*)?(?<user>[^\>\s]+)(?:\s*\>)?\s+IP\s+(?:\<\s*)?(?<src_ip>[^>\s]+)(?:\s*\>)?\s+\S+\s*(?<transport>\S+)?\s+SVC\s+connection(?:\s+(?<vendor_action>\S+))?

[cisco_asa_message_id_722036]
REGEX = -722036:\s*Group\s+(?:<\s*)?(?<Group>[^\>]+)(?:\s*>)?\s+User\s+(?:<\s*)?(?<user>[^\>\s]+)(?:\s*>)?\s+IP\s+(?:<\s*)?(?<src_ip>[^\>\s]+)(?:\s*>)?\s+Transmitting\s+large\s+packet\s+(?<bytes_out>\d+)\s*\(\s*threshold\s*(?<threshold>\d+)\s*\)

[cisco_asa_message_id_722037]
REGEX = -722037:\s*Group\s+(?:\<\s*)?(?<Group>[^\>]+)(?:\s*\>)?\s+User\s+(?:\<\s*)?(?<user>[^\>\s]+)(?:\s*\>)?\s+IP\s+(?:\<\s*)?(?<src_ip>[^\>\s]+)(?:\s*\>)?\s+(?<signature>\S+)\s+(?<vendor_action>\S+)\s+connection\s*:\s*(?<reason>.+?)[\s\.]*$

[cisco_asa_message_id_722041]
REGEX = -722041:\s*TunnelGroup\s+(?:\<\s*)?(?<tunnel_group>[^\>\s]+)(?:\s*\>)?\s+GroupPolicy\s+(?:\<\s*)?(?<group_policy>[^\>]+)(?:\s*\>)?\s+User\s+(?:\<\s*)?(?<user>[^\>\s]+)(?:\s*\>)?\s+IP\s+(?:\<\s*)?(?<src_ip>[^\>\s]+)(?:\s*\>)?

[cisco_asa_message_id_722053_722055]
REGEX = -72205[35]:\s*Group\s+(?:\<\s*)?([^\>]+)(?:\s*\>)?\s+User\s+(?:\<\s*)?([^\>\s]+)(?:\s*\>)?\s+IP\s+(?:\<\s*)?([^\>\s]+)(?:\s*\>)?(?:\s+Unknown)?\s+(?:client\s+(?:\<\s*)?([^\>]+)(?:\s*\>)?\s+connection|Client\s+Type\s*:\s+(.+))
FORMAT = Group::$1 user::$2 src_ip::$3 user_agent::$4 user_agent::$5

[cisco_asa_message_id_725001_725002]
REGEX = -72500[12]:\s*(?:Starting|Device\s+completed)\s+SSL\s+handshake\s+with\s+(?<peer_type>\S+)\s+(?<src_interface>[^:\s]+)\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\S+)\s+to\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\S+)\s+for

[cisco_asa_message_id_725003]
REGEX = -725003:\s*SSL\s+(?<peer_type>\S+)\s+(?<src_interface>[^:\s]+)\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d{1,5})\s+to\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d{1,5})\s+\s*(?<signature>.+?)[\s\.]*$

[cisco_asa_message_id_725006_725007]
REGEX = -72500[67]:\s*(?:Device\s+(\S+)\s+)?SSL\s+\S+\s+with\s+(\S+)\s+([^:\s]+)\s*:\s*(?:((?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))\s*\/\s*(\d{1,5})(?:\s+to\s+(?:((?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(\S+))\s*\/\s*(\d{1,5}))?(?:\s+(\w+))?
FORMAT = vendor_action::$1 peer_type::$2 src_interface::$3 src_ip::$4 src_host::$5 src_port::$6 dest_ip::$7 dest_host::$8 dest_port::$9 vendor_action::$10

[cisco_asa_message_id_725008]
REGEX = -725008:\s*SSL\s+(?<peer_type>\S+)\s+(?<src_interface>[^:\s]+)\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d{1,5})\s+to\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d{1,5})\s+proposes\s+the\s+following\s+(?<supported_ciphers>\d+)\s+cipher(?:\(s\))?\.?

[cisco_asa_message_id_725010]
REGEX = -725010:\s*Device\s+supports\s+the\s+following\s+(?<supported_ciphers>\d+)\s+

[cisco_asa_message_id_725011]
REGEX = -725011:?\s*Cipher\s*\[\s*(?<order>\d+)\s*\]\s*:\s*(?<cipher_name>.+)

[cisco_asa_message_id_725012]
REGEX = -725012:\s*Device\s+chooses\s+cipher\s+(?<cipher_name>.+?(?=\s+for))\s+for\s+the\s+SSL\s+session\s+with\s+(?<peer_type>\S+)\s+(?<src_interface>[^:\s]+)\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d{1,5})\s+to\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d{1,5})

[cisco_asa_message_id_725014]
REGEX = -725014(?::)?\s*SSL\s+lib\s+error\s*\.\s*Function\s*:\s*(?<function>\S+)\s+Reason\s*:\s*(?<reason>.+?)[\s\.]*$

[cisco_asa_message_id_725016]
REGEX = -725016:\s*Device\s+selects\s+trust-point\s+(?<trust_point_name>\S+)\s+for\s+(?<peer_type>\S+)\s+(?<src_interface>[^:\s]+)\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d{1,5})\s+to\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d{1,5})

[cisco_asa_message_id_725017]
REGEX = -725017:\s*No\s+certificates\s+received\s+during\s+the\s+handshake\s+with\s+(?<remote_device>\S+)\s+(?<src_interface>[^\s\:]+)\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d{1,5})\s+to\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d{1,5})\s+for\s+(?<protocol_version>\S+)\s+session

[cisco_asa_message_id_734001]
REGEX = -734001:\s*DAP\s*:\s*User\s+(?<user>[^,\s]+)\s*,\s*Addr\s*(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*,\s*Connection\s*(?<type>[^:]+)\s*:.+this\s+connection\s*:\s*(?<DAP_record_names>.+)

[cisco_asa_message_id_734003]
REGEX = -734003:\s*DAP\s*:\s*User\s*(?<user>[^,\s]+)\s*,\s*Addr\s*(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*:\s*Session\s*Attribute\s*(?::\s*|\s+)(?<endpoint_attribute_name>[^\/\s]+)\s*(?:\/|=)\s*\"?\s*(?<endpoint_value>(?:\w+\s+)*[\w+\.]+)\s*\"?

[cisco_asa_message_id_737001]
REGEX = -737001:\s*IPAA\s*:\s*Session\s*=\s*(?<session>[^,\s]+)\s*,\s*Received\s+message\s+\'?\s*(?<message_type>[^']+)\s*\'?

[cisco_asa_message_id_737003_737006]
REGEX = -73700[36]:\s*IPAA\s*:\s*Session\s*=\s*(?<session>[^,\s]+)\s*,\s*(?:DHCP\s+configured\s*,\s*no\s+viable\s+servers\s+found|Local\s+pool\s+request\s+succeeded)\s+for\s+tunnel-group\s+\'?(?<tunnel_group>(?:\w+\s+)*\w+)\'?

[cisco_asa_message_id_737016]
REGEX = -737016:\s*IPAA\s*:\s*Session\s*=\s*(?<session>[^,\s]+)\s*,\s*Freeing\s+local\s+pool\s+(?:(?<pool_name>\S+)\s+)?address\s+(?:(?<ip_address>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<host_name>\S+))$

[cisco_asa_message_id_737026]
REGEX = -737026:\s*IPAA\s*:\s*Session\s*=\s*(?<session>[^,\s]+)\s*,\s*Client\s+assigned\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s+from\s+local\s+pool(?:\s+(?<pool_name>\S+))?

[cisco_asa_message_id_737034]
REGEX = -737034:\s*IPAA\s*:\s*Session\s*=\s*(?<session>[^,\s]+)\s*,\s*(?<ip_version>\S+)\s+address\s*:\s*(?<explanation>.+)

[cisco_asa_message_id_737035]
REGEX = -737035:\s*IPAA\s*:\s*Session\s*=\s*(?<session>[^,\s]+)\s*,\s*\'?\s*(?<message_type>[^']+)\'?

[cisco_asa_message_id_746012_746013]
REGEX = -74601[23]:\s*user-identity\s*:\s*\S+\s+IP-User\s+mapping\s+(?:(?<ip_address>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<host_name>\S+))\s*-\s*(?<domain_name>[^\\\s]+)\s*\\\s*(?<user>\S+)\s+(?<result>\S+)\s*-\s*(?<reason>.+)

[cisco_asa_message_id_746014_746015]
REGEX = -74601[45]:\s*user-identity\s*:\s*\[\s*FQDN\s*\]\s+(?<fqdn>\S+)\s+\S+\s+(?:(?<ip_address>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<host_name>\S+))

[cisco_asa_message_id_746016]
REGEX = -746016:\s*user-identity\s*:\s*DNS\s+lookup\s+(?:for\s+(?<fqdn>\S+)\s+)?failed\s*,\s*reason\s*:\s*(?<reason>.+)

[cisco_asa_message_id_713154]
REGEX = -713154:\s*DNS\s+lookup\s+for\s+(?<peer_description>(?:\S+\s+)*\S+)\s+Server\s*\[\s*(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\]\s+(?<answer>[^\!\s]+)

[cisco_asa_message_id_713160_713162_713163]
REGEX = -71316[023]:\s*Remote\s+user\s*\(\s*session\s*Id\s*-\s*(?<session_id>\S+)\s*\)\s+has\s+been\s+(?<action>\S+)

[cisco_asa_message_id_713166]
REGEX = -713166:\s*Headend\s*security\s+gateway\s+has\s+(?<vendor_action>\S+).+check\s+configured

[cisco_asa_message_id_713167]
REGEX = -713167:\s*Remote\s+peer\s+has\s+(?<vendor_action>\S+)\s+

[cisco_asa_message_id_713185]
REGEX = -713185:\s*Error\s*:\s*Username\s+too\s+long\s*-\s*connection\s+(?<action>\w+)

[cisco_asa_message_id_713198]
REGEX = -713198:\s*User\s+Authorization\s+(?<vendor_action>[^:\s]+)\s*:\s*(?<user>\S+)

[cisco_asa_message_id_713199]
REGEX = -713199:\s*[\S\s]*\s+counter\s*\(\s*(?<counter>\d+)\s*\)\!

[cisco_asa_message_id_500001_500002]
REGEX = -50000[12]:\s*(?<object>(?:ActiveX|Java)\s+content)\s+in\s+(?<object_category>java\s+script)\s+is\s+(?<action>\S+)\s*:\s*src\s+(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s+dest\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s+on\s+interface\s+(?<dest_interface>\S+)

[cisco_asa_message_id_502101_502102]
REGEX = -50210[12]:\s*(?<result>(?:New)?\s*(?<object_category>[Uu]ser)\s+(?<action>\S+)\s+(?:to|from)\s+(?<object_path>local)\s+dbase\s*):\s*Uname\s*:\s*(?<user>\S+)\s+Priv\s*:\s*(?<privilege_level>\S+)\s+Encpass\s*:\s*(?<encrypted_password>\S+)

[cisco_asa_message_id_502111_502112]
REGEX = -50211[12]:\s*(?<result>(?:New\s+)?(?<object_category>[Gg]roup\s+policy)\s+(?<action>\S+)\s*):\s*name\s*:\s*(?<object>\S+)\s+Type\s*:\s*(?<policy_type>\S+)

[cisco_asa_message_id_504001_504002]
REGEX = -50400[12]:\s*(?<object>Security\s+context)\s+(?<context_name>\S+)\s+was\s+(?<action>\S+)

[cisco_asa_message_id_505001_to_505006]
REGEX = -50500[1-6]:\s*(?<result>(?<object_category>\S+)\s+(?<object>\S+)\s+(?:is\s+)?(?<action>[^\.\s]*)[\s]?[^.]*)

[cisco_asa_message_id_505007]
REGEX = -505007:\s*(?<object_category>\S+)\s+(?<object_id>\S+)\s+(?:(?:in\s+slot\s+)?(?<slot_num>\d+)\s+)?is\s+(?<action>[^\.\s]+)

[cisco_asa_message_id_505008]
REGEX = -505008:\s*Module\s+(?<object_id>\S+)\s+(?:(?:in\s+slot\s+)?(?<slot_num>\d+)\s+)?(?<object_category>\S+)\s+is\s+being\s+(?<action>\S+)\s+to\s+(?<new_app_version>\S+)\s*\(\s*currently\s+(?<old_app_version>[^\s\)]+)\s*\)

[cisco_asa_message_id_505009]
REGEX = -505009:\s*(?<result>Module\s+(?<object_id>\S+)\s+(?<object_category>\S+)\s+was\s+(?<vendor_action>\S+)\s+to\s+(?<new_app_version>.+?)[\s\.]*$)

[cisco_asa_message_id_505010]
REGEX = -505010:\s*Module\s+(?<object_id>\S+)\s+slot\s+(?<slot_num>\S+)\s+(?<action>\w+)

[cisco_asa_message_id_505011]
REGEX = -505011:\s*Module\s+(?<object>[^,\s]+)

[cisco_asa_message_id_505012]
REGEX = -505012:\s*Module\s+(?<object_id>[^\s,]+)(?:\s+in\s+slot\s+(?<slot_num>\d+))?\s*,\s*application\s+(?<action>\S+)\s+(?<app_name>[^\s,]+)\s*,\s*version\s+(?<app_version>\S+)

[cisco_asa_message_id_505013]
REGEX = -505013:\s*Module\s+(?<object_id>[^\s,]+)(?:\s+in\s+slot\s+(?<slot_num>\d+))?\s+application\s+(?<action>\S+)\s+from\s*:\s*(?<old_app_name>\S+)\s+version\s+(?<old_app_version>\S+)\s+to\s*:\s*(?<new_app_name>\S+)\s+version\s+(?<new_app_version>.+?)[\s\.]*$

[cisco_asa_message_id_505014]
REGEX = -505014:\s*Module\s+(?<object_id>[^\s,]+)(?:\s+in\s+slot\s+(?<slot_num>\d+))?\s*,\s*application\s+down\s+(?<app_name>[^\s,]+)\s*,\s*version\s+(?<app_version>\S+)\s+(?<reason>.+)

[cisco_asa_message_id_505015]
REGEX = -505015:\s*Module\s+(?<object_id>[^\s,]+)(?:\s+in\s+slot\s+(?<slot_num>\d+))?\s*,\s*(?<result>(?<object_category>\S+)\s+(?<action>\S+)\s+(?<app_name>[^,\s]+))\s*,\s*version\s+(?<app_version>\S+)

[cisco_asa_message_id_505016]
REGEX = -505016:\s*Module\s+(?<object_id>[^\s,]+)(?:\s+in\s+slot\s+(?<slot_num>\d+))?\s+application\s+(?<action>\S+)\s+from\s*:\s*(?<old_app_name>\S+)\s+version\s+(?<old_app_version>\S+)\s+state\s+(?<old_state>\S+)\s+to\s*:\s*(?<new_app_name>\S+)\s+(?<new_app_version>\S+)\s+state\s+(?<new_state>[^\s.]+)

[cisco_asa_message_id_751025]
REGEX = -751025:\s*Local\s*:\s*(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*:\s*(?<dest_port>\d+)\s+Remote\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*:\s*(?<src_port>\d+)\s+Username\s*:\s*(?<user>.+?(?=\s+Group))\s+Group\s*:\s*(?<Group>.+)\s+IPv4\s+[Aa]ddress\s*=\s*(?<assigned_ipv4>\S+)\s+IPv6\s+[Aa]ddress\s*=\s*(?<assigned_ipv6>\S+)\s+(?<vendor_action>\S+)

[cisco_asa_message_id_751026]
REGEX = -751026:\s*Local\s*:\s*(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*:\s*(?<dest_port>\d+)\s+Remote\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*:\s*(?<src_port>\d+)\s+Username\s*:\s*(?<user>.+?(?=\s+IKEv2))\s+IKEv2\s+Client\s+OS\s*:\s*(?<client_os>.+?(?=\s+Client))\s+Client\s*:\s*(?<client_name>\S+)\s+(?<client_version>.+?)[\s\.]*$

[cisco_asa_message_id_313005]
REGEX = -313005:\s*No\s+matching\s+connection\s+for\s+(?<transport>\S+)\s+error\s+message\s*:\s*(?<message>icmp\s+src\s+(?<src_interface>[^:\s]+)\s*:\s*(?:(?<src_ip>(?:[\d+\.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>[^\s\(]+))(?:\s*\(\s*(?:(?<src_nt_domain>[\S^\\]+)\\)?(?<src_user>[\w\-_]+)\s*\))?\s+dst\s+(?<dest_interface>[^:\s]+)\s*:\s*(?:(?<dest_ip>(?:[\d+\.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>[^\s\(]+))\s*\(\s*type\s+(?<icmp_type>\d+)\s*,\s*code\s+(?<icmp_code>\d+)\s*\))\s+on\s+(?<interface_name>\S+)\s+interface\s*\.\s*Original\s+IP\s+payload\s*:\s*(?<orig_transport>\S+)\s+src\s+(?<orig_src_ip>[^\/\s]+)\s*\/\s*(?<src_port>\d{1,5})\s+dst\s+(?<orig_dest_ip>[^\/\s]+)\s*\/\s*(?<dest_port>\d{1,5})

[cisco_asa_message_id_110003]
REGEX = -110003:\s*Routing\s+failed\s+to\s+locate\s+next[\-\s]hop\s+for\s+(?<protocol>\S+)\s+from\s+(?<src_interface>[^:]+)\s*:\s*(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d{1,5})\s+to\s+(?<dest_interface>[^:]+)\s*:\s*(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d{1,5})

[cisco_asa_message_id_405001]
REGEX = -405001:\s*(?<signature>.+?)\s+from\s+(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_mac>\S+)\s+on\s+interface\s+(?<dest_interface>\S+)\s+with\s+existing\s+ARP\s+entry\s+(?:(?<dest_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_mac>\S+)

[cisco_asa_message_id_338002]
REGEX = -338002:\s*Dynamic\s+[Ff]ilter\s+monitored\s+(?<rule>blacklist)ed\s+(?<transport>\S+)\s+traffic\s+from\s+(?<src_interface>[^:\s]+)\s*:\s*(?:(?<src_ip>(?:[\d.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>\S+))\s*\/\s*(?<src_port>\d+)\s*\(\s*(?:(?<src_translated_ip>(?:[\d.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_translated_host>\S+))\s*\/\s*(?<src_translated_port>\d+)\s*\)\s+to\s+(?<dest_interface>[^:\s]+)\s*:\s*(?:(?<dest_ip>(?:[\d.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>\S+))\s*\/\s*(?<dest_port>\d+)\s*\(\s*(?:(?<dest_translated_ip>(?:[\d.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_translated_host>\S+))\s*\/\s*(?<dest_translated_port>\d+)\s*\)\s*,\s+destination\s+(?:(?<malicious_ip>(?:[\d.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<malicious_host>\S+))\s+resolved\s+from\s+(?:dynamic|local)\s+list\s*:\s+(?<domain_name>[^,\s]+)\s*,\s+threat-level\s*:\s*(?<vendor_severity>\S+)\s*,\s+category\s*:\s+(?<vendor_category>\S+)

[cisco_asa_message_id_109031]
REGEX = -109031: NT Domain Authentication Failed:\s+(?<reason>\w+ guest login for\s+(?<user>\w+))

[cisco_asa_message_id_113021]
REGEX = -113021: Attempted (?<app>\w+) login failed\.? (?<reason>[Uu]ser '?(?<user>\w+)'? did NOT have appropriate Admin Rights)

[cisco_asa_message_id_605004_605005]
REGEX = -60500[45]: Login\s+(?:\w+) from\s+(?:(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<src_host>[^\s\/]+))(?:\s*\/\s*(?<src_port>\d+))?\s+to\s+(?<dest_interface>[^:\s]+)\s*:\s*(?:(?<dest_ip>(?:\d+.\d+.\d+.\d+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))|(?<dest_host>[^\s\/]+))(?:\s*\/\s*(?<app>\S+))? for user\s+"(?<user>\w+|.*)"

[cisco_asa_message_id_716047]
REGEX = -716047: Group dummy_group User (?<user>\w+) IP\s+(?<src>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*)) (?<reason>User ACL dummy_ACL from AAA ignored, (?<app>AV-PAIR) ACL used instead)

[cisco_asa_message_id_772002]
REGEX = -772002: PASSWORD: (?<app>\w+) login warning, user (?<user>\w+), cause: (?<reason>password expired)

[cisco_asa_message_id_772003_772004]
REGEX = -77200[34]: PASSWORD:\s+(?<app>\w+|\w+\W+\w+) login failed, user\s+(?<user>\w+), IP\s+(?<src_ip>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*)), cause: (?<reason>password expired)

[cisco_asa_message_id_609001_609002]
REGEX = -60900[12]:\s*(?<action>\w+)\s*local-host (?<zone>\w+):(?:(?<dest_ip>\d+.\d+.\d+.\d+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*)|(?<dest_host>[^\s]+))(?:\s+[Dd]uration:?\s*(?:(?<duration_day>\d+)[dD])?\s*(?<duration_hour>\d+)[Hh]?\s*:\s*(?<duration_minute>\d+)[Mm]?\s*:\s*(?<duration_second>\d+)[Ss]?)?

[cisco_asa_message_id_111001]
REGEX = -111001:\s*(?<command>Begin\s*(?<object_category>\w+)\s*:\s*(?<result>(?<src>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*)|(?:\w+))\s*writing to\s*(?<object>\w+)))

[cisco_asa_message_id_111004]
REGEX = -111004:\s*(?<command>(?<src>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*)|(?:\w+))\s*end\s*(?<object_category>\w+):\s*(?<result>\w+))

[cisco_asa_message_id_111009]
REGEX = -111009: User\s*'?(?<user>\w+)?'\s*executed cmd:\s*(?<command>.+)

[cisco_asa_message_id_771002]
REGEX = -771002:\s*(?<result>(?<object>\w+):\s*(?<command>.+),\s*(?<object_attrs>.+), IP\s*(?<src>(?:[\d+.]+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*)),\s*.+)

[cisco_asa_message_id_302022_302024_302026]
REGEX = -\d+-(?P<signature_id>302022|302024|302026): (?P<signature>.+?) for (?P<src_interface>[^:]+):(?P<src_ip>[0-9a-fA-F:.]+)/(?P<src_port>\d+)[^t]*to (?P<dest_interface>[^:]+):(?P<dest_ip>[0-9a-fA-F:.]+)/(?P<dest_port>\d+)

[cisco_asa_message_id_302023_302025]
REGEX = -\d+-(?P<signature_id>302023|302025): (?P<signature>Teardown stub \w+ connection) for (?P<src_interface>[^:]+):(?P<src_ip>[0-9a-fA-F:.]+)/(?P<src_port>\d+) to (?P<dest_interface>[^:]+):(?P<dest_ip>[0-9a-fA-F:.]+)/(?P<dest_port>\d+) duration (?P<duration_hour>\d+):(?P<duration_minute>\d+):(?P<duration_second>\d+) forwarded bytes (?P<bytes>\d+)\s*(?P<reason>.*)

[cisco_asa_message_id_212011]
REGEX = -\d+-(?P<signature_id>212011):\s*(?P<signature>[^.]+)

[cisco_asa_message_id_113015]
REGEX = -\d+-(?P<signature_id>113015): (?P<action_msg>[^:]+).*?: reason = (?P<reason>[^:]+) : (?P<app>[^:]+) : user = (?P<src_user>[^:]+) : user IP = (?P<src>[0-9a-fA-F:.]+)

[cisco_asa_message_id_430001]
REGEX = -\d+-(?P<signature_id>430001): DeviceUUID:\s*(?P<deviceuuid>[^,]+),.*?SrcIP:\s*(?P<src_ip>[^,]+), DstIP:\s*(?P<dest_ip>[^,]+), SrcPort:\s*(?P<src_port>\d+), DstPort:\s*(?P<dest_port>\d+), Protocol:\s*(?P<transport>[^,]+),.*?Priority:\s*(?P<severity_id>\d+),.*?Message:\s*(?P<signature>[^,]+),.*?InlineResult:\s*(?P<vendor_action>[^,]+)

[cisco_asa_message_id_430007]
REGEX = -\d+-(?P<signature_id>430007):\s*EventPriority:\s*(?P<severity>[^,]+),.*?DeviceUUID:\s*(?P<deviceuuid>[^,]+),.*?ConnectionID:\s*(?P<session_id>\d+),.*?AccessControlRuleAction:\s*(?P<vendor_action>[^,]+),.*?SrcIP:\s*(?P<src_ip>[^,]+),.*?DstIP:\s*(?P<dest_ip>[^,]+),.*?SrcPort:\s*(?P<src_port>\d+),.*?DstPort:\s*(?P<dest_port>\d+),.*?Protocol:\s*(?P<transport>[^,]+),.*?IngressZone:\s*(?P<src_interface>[^,]+),.*?EgressZone:\s*(?P<dest_interface>[^,]+),.*?AccessControlRuleName:\s*(?P<rule>[^,]+),.*?Client:\s*(?P<user>[^,]+),.*?ApplicationProtocol:\s*(?P<app>[^,]+),.*?InitiatorPackets:\s*(?P<packets_out>\d+),.*?ResponderPackets:\s*(?P<packets_in>\d+),.*?InitiatorBytes:\s*(?P<bytes_out>\d+),.*?ResponderBytes:\s*(?P<bytes_in>\d+)

[cisco_asa_message_id_430004]
REGEX = -(?P<severity_id>\d+)-(?P<signature_id>430004):.*?DeviceUUID:\s*(?P<deviceuuid>[^,]+),.*?SrcIP:\s*(?P<src_ip>[^,]+),.*?DstIP:\s*(?P<dest_ip>[^,]+),.*?SrcPort:\s*(?P<src_port>\d+),.*?DstPort:\s*(?P<dest_port>\d+),.*?Protocol:\s*(?P<transport>[^,]+),.*?FileDirection:\s*(?P<file_direction>[^,]+),.*?FileAction:\s*(?P<file_action>[^,]+),.*?FileSHA256:\s*(?P<file_sha256>[^,]+),.*?FileName:\s*(?P<file_name>[^,]+),.*?FileSize:\s*(?P<bytes>\d+),.*?ApplicationProtocol:\s*(?P<app>[^,]+),.*?Client:\s*(?P<user>[^,]+),.*?WebApplication:\s*(?P<web_application>[^,]+),.*?URI:\s*(?P<uri>[^,]+)

[cisco_asa_message_id_430003]
REGEX = -(?P<severity_id>\d+)-(?P<signature_id>430003):(?=.*AccessControlRuleAction:\s*(?P<vendor_action>[^,]+))(?=.*SrcIP:\s*(?P<src_ip>[^,]+))(?=.*DstIP:\s*(?P<dest_ip>[^,]+))(?=.*SrcPort:\s*(?P<src_port>\d+))(?=.*DstPort:\s*(?P<dest_port>\d+))(?=.*Protocol:\s*(?P<transport>\w+))(?=.*IngressZone:\s*(?P<src_interface>[^,]+))(?=.*EgressZone:\s*(?P<dest_interface>[^,]+))(?=.*ConnectionID:\s*(?P<session_id>\d+))(?=.*AccessControlRuleName:\s*(?P<rule>[^,]+))(?=.*InitiatorPackets:\s*(?P<packets_out>\d+))(?=.*ResponderPackets:\s*(?P<packets_in>\d+))(?=.*InitiatorBytes:\s*(?P<bytes_out>\d+))(?=.*ResponderBytes:\s*(?P<bytes_in>\d+))

[cisco_asa_message_id_430002]
REGEX = -\d+-(?<signature_id>430002):.*ConnectionID:\s*(?P<session_id>\d+),\s*AccessControlRuleAction:\s*(?P<vendor_action>[^,]+),\s*SrcIP:\s*(?P<src_ip>[\d\.]+),\s*DstIP:\s*(?P<dest_ip>[\d\.]+),\s*SrcPort:\s*(?P<src_port>\d+),\s*DstPort:\s*(?P<dest_port>\d+),\s*Protocol:\s*(?P<transport>[^,]+),\s*IngressInterface:\s*(?P<ingress_interface>[^,]+),\s*EgressInterface:\s*(?P<egress_interface>[^,]+),\s*IngressZone:\s*(?P<src_interface>[^,]+),\s*EgressZone:\s*(?P<dest_interface>[^,]+),\s*IngressVRF:\s*(?P<ingress_vrf>[^,]+),\s*EgressVRF:\s*(?P<egress_vrf>[^,]+),\s*ACPolicy:\s*(?P<ac_policy>[^,]+),\s*AccessControlRuleName:\s*(?P<rule>[^,]+),\s*Prefilter Policy:\s*(?P<prefilter_policy>[^,]+),\s*InitiatorPackets:\s*(?P<packets_out>\d+),\s*ResponderPackets:\s*(?P<packets_in>\d+),\s*InitiatorBytes:\s*(?P<bytes_out>\d+),\s*ResponderBytes:\s*(?P<bytes_in>\d+),\s*NAPPolicy:\s*(?P<nap_policy>[^,]+),\s*ClientAppDetector:\s*(?P<client_app_detector>[^,]+)

[cisco_asa_message_id_507003]
REGEX = -\d+-(?P<signature_id>507003):\s*(?P<transport>\w+)\s+flow from\s+(?P<src_interface>\S+):(?P<src_ip>[\d\.]+)/(?P<src_port>\d+)\s+to\s+(?P<dest_interface>\S+):(?P<dest_ip>[\d\.]+)/(?P<dest_port>\d+)

# =============================================================================
# MAC ADDRESS INVENTORY LOOKUP
# =============================================================================

[mac_inventory]
filename = mac_inventory.csv
case_sensitive_match = false


# =============================================================================
# SPLUNK ES ASSET & IDENTITY LOOKUPS
# =============================================================================

[asset_inventory]
filename = asset_inventory.csv
case_sensitive_match = false

[identity_inventory]
filename = identity_inventory.csv
case_sensitive_match = false
