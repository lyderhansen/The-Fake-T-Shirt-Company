<dashboard version="1.1" theme="dark">
  <label>Scenarios</label>
  <description>Coordinated attack and operational scenarios for demo and training</description>

  <fieldset submitButton="false">
    <input type="time" token="time" searchWhenChanged="true">
      <label>Time Range</label>
      <default>
        <earliest>1735689600</earliest>
        <latest>1736899200</latest>
      </default>
    </input>
  </fieldset>

  <row>
    <panel>
      <html>
        <div style="padding: 15px; background: #1a1a1a; border-radius: 5px;">
          <h2 style="color: #5CC05C; margin-top: 0;">Attack &amp; Operational Scenarios</h2>
          <p style="color: #999;">All scenarios add <code style="background: #333; padding: 2px 6px; border-radius: 3px;">demo_id=&lt;scenario_name&gt;</code> field for easy filtering in Splunk.</p>
          <p style="color: #f8be34; margin-top: 10px;"><strong>Note:</strong> Scenarios are spread out to avoid overlap - disk_filling (Day 1-5), memory_leak (Day 6-9), cpu_runaway (Day 11-12).</p>
        </div>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>Active Scenarios in Data</title>
      <chart>
        <search>
          <query>index=fake_tshrt demo_id=*
| timechart span=1d count by demo_id</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">column</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.drilldown">none</option>
        <option name="height">250</option>
      </chart>
    </panel>
  </row>

  <row>
    <panel>
      <title>Security Scenarios</title>
      <html>
        <div style="padding: 15px;">
          <h3 style="color: #dc4e41;">exfil - APT Data Exfiltration</h3>
          <p><strong>Duration:</strong> 14 days | <strong>Affected sources:</strong> ASA, Meraki, EntraID, AWS, GCP, Perfmon, WinEventLog, Exchange</p>
          <table style="width: 100%; border-collapse: collapse; margin: 10px 0;">
            <tr style="background: #2a2a2a;">
              <th style="padding: 8px; text-align: left; border: 1px solid #444;">Phase</th>
              <th style="padding: 8px; text-align: left; border: 1px solid #444;">Days</th>
              <th style="padding: 8px; text-align: left; border: 1px solid #444;">Activity</th>
              <th style="padding: 8px; text-align: left; border: 1px solid #444;">Location</th>
            </tr>
            <tr>
              <td style="padding: 8px; border: 1px solid #444;">Reconnaissance</td>
              <td style="padding: 8px; border: 1px solid #444;">0-3</td>
              <td style="padding: 8px; border: 1px solid #444;">Port scanning, phishing sent</td>
              <td style="padding: 8px; border: 1px solid #444;">External → All</td>
            </tr>
            <tr>
              <td style="padding: 8px; border: 1px solid #444;">Initial Access</td>
              <td style="padding: 8px; border: 1px solid #444;">4</td>
              <td style="padding: 8px; border: 1px solid #444;">Jessica Brown clicks phishing link</td>
              <td style="padding: 8px; border: 1px solid #444;">Atlanta (ATL)</td>
            </tr>
            <tr>
              <td style="padding: 8px; border: 1px solid #444;">Lateral Movement</td>
              <td style="padding: 8px; border: 1px solid #444;">5-7</td>
              <td style="padding: 8px; border: 1px solid #444;">Cross-site probing ATL→BOS, privesc</td>
              <td style="padding: 8px; border: 1px solid #444;">ATL → BOS</td>
            </tr>
            <tr>
              <td style="padding: 8px; border: 1px solid #444;">Persistence</td>
              <td style="padding: 8px; border: 1px solid #444;">8-10</td>
              <td style="padding: 8px; border: 1px solid #444;">Backdoor creation, data staging</td>
              <td style="padding: 8px; border: 1px solid #444;">Boston (BOS)</td>
            </tr>
            <tr>
              <td style="padding: 8px; border: 1px solid #444;">Exfiltration</td>
              <td style="padding: 8px; border: 1px solid #444;">11-14</td>
              <td style="padding: 8px; border: 1px solid #444;">Data theft via cloud storage</td>
              <td style="padding: 8px; border: 1px solid #444;">Boston → External</td>
            </tr>
          </table>
          <p><strong>Key personnel:</strong> Jessica Brown (ATL IT Admin - initial compromise), Alex Miller (BOS Finance - primary target)</p>
          <p><strong>Threat Actor IP:</strong> 185.220.101.42 (Frankfurt, Germany)</p>

          <hr style="border-color: #444; margin: 20px 0;"/>

          <h3 style="color: #dc4e41;">ransomware_attempt - Ransomware Attack</h3>
          <p><strong>Duration:</strong> Days 8-10 | <strong>Target:</strong> Austin office</p>
          <p>Simulates a ransomware attack attempt with IDS alerts, file encryption indicators, and incident response.</p>
        </div>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>Operational Scenarios (Non-overlapping Timeline)</title>
      <html>
        <div style="padding: 15px;">
          <div style="background: #2a2a2a; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
            <h4 style="color: #f8be34; margin-top: 0;">Timeline Overview</h4>
            <table style="width: 100%; border-collapse: collapse;">
              <tr style="background: #1a1a1a;">
                <th style="padding: 8px; text-align: left; border: 1px solid #444;">Scenario</th>
                <th style="padding: 8px; text-align: left; border: 1px solid #444;">Days</th>
                <th style="padding: 8px; text-align: left; border: 1px solid #444;">Key Event</th>
                <th style="padding: 8px; text-align: left; border: 1px solid #444;">Resolution</th>
              </tr>
              <tr>
                <td style="padding: 8px; border: 1px solid #444;">disk_filling</td>
                <td style="padding: 8px; border: 1px solid #444; color: #5CC05C;"><strong>Day 1-5</strong></td>
                <td style="padding: 8px; border: 1px solid #444;">97% disk usage</td>
                <td style="padding: 8px; border: 1px solid #444; color: #5CC05C;">Day 5 @ 10:00 - Cleanup</td>
              </tr>
              <tr>
                <td style="padding: 8px; border: 1px solid #444;">memory_leak</td>
                <td style="padding: 8px; border: 1px solid #444; color: #f8be34;"><strong>Day 6-9</strong></td>
                <td style="padding: 8px; border: 1px solid #444;">OOM crash Day 9 @ 14:00</td>
                <td style="padding: 8px; border: 1px solid #444; color: #5CC05C;">Day 9 @ 14:05 - Restart</td>
              </tr>
              <tr>
                <td style="padding: 8px; border: 1px solid #444;">cpu_runaway</td>
                <td style="padding: 8px; border: 1px solid #444; color: #dc4e41;"><strong>Day 11-12</strong></td>
                <td style="padding: 8px; border: 1px solid #444;">100% CPU SQL-PROD-01</td>
                <td style="padding: 8px; border: 1px solid #444;">Day 12 - Manual fix</td>
              </tr>
            </table>
          </div>

          <h3 style="color: #f8be34;">disk_filling - Server Disk Filling (Day 1-5)</h3>
          <p><strong>Duration:</strong> Days 1-5 (Resolved Day 5 @ 10:00) | <strong>Target:</strong> MON-ATL-01 (Atlanta)</p>
          <p><strong>Affected sources:</strong> Linux df</p>
          <p>Disk gradually fills from 45% to 97% over 5 days due to log accumulation. Resolved with cleanup script Day 5 @ 10:00.</p>

          <hr style="border-color: #444; margin: 20px 0;"/>

          <h3 style="color: #f8be34;">memory_leak - Application Memory Leak (Day 6-9)</h3>
          <p><strong>Duration:</strong> Days 6-9 (OOM crash Day 9 @ 14:00, restart @ 14:05) | <strong>Target:</strong> WEB-01 (Boston DMZ)</p>
          <p><strong>Affected sources:</strong> Linux metrics, ASA</p>
          <p>Gradual memory consumption (55% → 98%) leading to OOM crash. Service automatically restarted.</p>

          <hr style="border-color: #444; margin: 20px 0;"/>

          <h3 style="color: #f8be34;">cpu_runaway - SQL Backup Stuck (Day 11-12)</h3>
          <p><strong>Duration:</strong> Days 11-12 | <strong>Target:</strong> SQL-PROD-01 (Boston)</p>
          <p><strong>Affected sources:</strong> Perfmon, WinEventLog, ASA, Access logs</p>
          <p>SQL backup job gets stuck causing 100% CPU, database connection failures, and cascading web errors.</p>

          <hr style="border-color: #444; margin: 20px 0;"/>

          <h3 style="color: #f8be34;">certificate_expiry - SSL Certificate Expiring</h3>
          <p><strong>Duration:</strong> Days 10-14 | <strong>Target:</strong> WEB-01/WEB-02</p>
          <p>SSL certificate approaching expiration with increasing warnings.</p>
        </div>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>Network Scenarios</title>
      <html>
        <div style="padding: 15px;">
          <h3 style="color: #0877a6;">firewall_misconfig - Firewall Rule Mistake</h3>
          <p><strong>Duration:</strong> Days 6-7 | <strong>Target:</strong> FW-EDGE-01</p>
          <p><strong>Affected sources:</strong> ASA</p>
          <p>Accidental blocking of critical traffic causing service disruption and recovery.</p>
        </div>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>Scenario Events Summary</title>
      <table>
        <search>
          <query>index=fake_tshrt demo_id=*
| stats count, dc(sourcetype) as source_count, earliest(_time) as start_time, latest(_time) as end_time by demo_id
| eval start_time=strftime(start_time, "%Y-%m-%d"), end_time=strftime(end_time, "%Y-%m-%d")
| rename demo_id as "Scenario", count as "Total Events", source_count as "Data Sources", start_time as "Start", end_time as "End"
| sort -"Total Events"</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
</dashboard>
