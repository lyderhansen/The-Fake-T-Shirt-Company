<dashboard version="2" theme="dark">
  <label>Scenario - Data Exfiltration (Absolute)</label>
  <description>APT-style data exfiltration - absolute layout story dashboard</description>
  <definition><![CDATA[
{
  "title": "Scenario - Data Exfiltration (Absolute)",
  "description": "APT-style data exfiltration -- 14-day attack spanning reconnaissance, initial access, lateral movement, persistence, and exfiltration",
  "dataSources": {
    "ds_kpi_events": {
      "type": "ds.search",
      "name": "Total Exfil Events",
      "options": {
        "query": "index=fake_tshrt demo_id exfil | stats count as total"
      }
    },
    "ds_kpi_sourcetypes": {
      "type": "ds.search",
      "name": "Distinct Sourcetypes",
      "options": {
        "query": "index=fake_tshrt demo_id exfil | stats dc(sourcetype) as total"
      }
    },
    "ds_kpi_hosts": {
      "type": "ds.search",
      "name": "Distinct Hosts",
      "options": {
        "query": "index=fake_tshrt demo_id exfil | stats dc(host) as total"
      }
    },
    "ds_kpi_users": {
      "type": "ds.search",
      "name": "Distinct Users",
      "options": {
        "query": "index=fake_tshrt demo_id exfil | spath userIdentity.userName | spath userPrincipalName | spath identity | eval u=coalesce(user, userIdentity.userName, userPrincipalName, identity) | where isnotnull(u) | stats dc(u) as total"
      }
    },
    "ds_attack_flow_sankey": {
      "type": "ds.search",
      "name": "Attack Flow -- Threat Actor to Targets",
      "options": {
        "query": "| makeresults | eval data=\"185.220.101.42,Port Scanning,691|185.220.101.42,Phishing,5|Phishing,jessica.brown (ATL),5|jessica.brown (ATL),Lateral Movement,45|Lateral Movement,alex.miller (BOS),45|alex.miller (BOS),SharePoint Downloads,188|alex.miller (BOS),AWS S3 Exfil,196|alex.miller (BOS),Google Drive Exfil,24|alex.miller (BOS),C2 Upload,15|SharePoint Downloads,Data Exfiltrated,188|AWS S3 Exfil,Data Exfiltrated,196|Google Drive Exfil,Data Exfiltrated,24|C2 Upload,185.220.101.42,15\" | makemv delim=\"|\" data | mvexpand data | rex field=data \"(?<source>[^,]+),(?<target>[^,]+),(?<value>\\d+)\" | eval value=tonumber(value) | table source target value"
      }
    },
    "ds_attack_linkgraph": {
      "type": "ds.search",
      "name": "Attack Journey -- Full Kill Chain Link Graph",
      "options": {
        "query": "| makeresults | eval data=\"185.220.101.42 (Threat Actor),Port scan 3306/23/5432/1433,FW-EDGE-01 (ASA)|FW-EDGE-01 (ASA),691 deny events logged,SOC Visibility|185.220.101.42 (Threat Actor),Phishing from rnicrosoft-security.com,jessica.brown (IT Admin)|jessica.brown (IT Admin),Clicks phishing link,rnicrosoft-security.com/verify|rnicrosoft-security.com/verify,Credentials harvested,185.220.101.42 (Threat Actor)|185.220.101.42 (Threat Actor),Sign-in with stolen creds,EntraID (jessica.brown)|EntraID (jessica.brown),Authenticated from ATL,10.20.30.15 (Atlanta)|jessica.brown (IT Admin),Email forward rule created,protonmail.com (attacker)|jessica.brown (IT Admin),O365 FileAccessed x16,SharePoint Documents|jessica.brown (IT Admin),Pivot ATL to BOS via VPN,Boston Network (10.10.x.x)|Boston Network (10.10.x.x),Lateral movement detected,MX-BOS-01 (Meraki IDS)|185.220.101.42 (Threat Actor),Sign-in as alex.miller,EntraID (alex.miller)|EntraID (alex.miller),Risk: maliciousIPAddress,185.220.101.42 flagged|EntraID (alex.miller),Authenticated from BOS,10.10.30.55 (Finance)|alex.miller (Finance BOS),AWS ListBuckets,s3://faketshirt-finance-data|alex.miller (Finance BOS),GCP storage.objects.list,faketshirtcompany-prod-01|alex.miller (Finance BOS),AWS CreateUser,svc-datasync (IAM backdoor)|svc-datasync (IAM backdoor),AttachUserPolicy,AdministratorAccess|alex.miller (Finance BOS),Consent: DataSync Service,Mail.Read + Files.Read.All|alex.miller (Finance BOS),GCP SA key created,storage.admin role|alex.miller (Finance BOS),C2 beacon HTTPS,185.220.101.42 (Threat Actor)|alex.miller (Finance BOS),SharePoint download x188,Finance Reports + Contracts|alex.miller (Finance BOS),PowerShell Base64 encode,Data staging (backup.txt)|Data staging (backup.txt),curl POST to C2,185.220.101.42/upload|alex.miller (Finance BOS),rclone copy data_batch_4.zip,Google Drive (gdrive:backup/)|alex.miller (Finance BOS),AWS S3 PutObject x196,s3://external-staging|alex.miller (Finance BOS),del data_batch_*.zip,Evidence cleanup|SOC Visibility,INC0000208 opened,P1 Security Incident|P1 Security Incident,Confirm user compromised,alex.miller (Finance BOS)|P1 Security Incident,Revoke all sessions,alex.miller sessions killed|P1 Security Incident,Remove-InboxRule,jessica.brown forward deleted|P1 Security Incident,CHG0000039 remediation,Credentials rotated + isolated\" | makemv delim=\"|\" data | mvexpand data | rex field=data \"(?<Source>[^,]+),(?<Action>[^,]+),(?<Target>[^,]+)\" | table Source Action Target"
      }
    },
    "ds_attack_timeline": {
      "type": "ds.search",
      "name": "14-Day Attack Timeline by Source Category",
      "options": {
        "query": "index=fake_tshrt demo_id exfil | eval source_cat=case(match(sourcetype,\"cisco:asa\"), \"Firewall (ASA)\", match(sourcetype,\"aws:cloudtrail\"), \"AWS CloudTrail\", match(sourcetype,\"google:gcp\"), \"GCP Audit\", match(sourcetype,\"azure:aad\"), \"Entra ID\", match(sourcetype,\"o365:management\"), \"M365 Activity\", match(sourcetype,\"o365:reporting\"), \"Exchange\", match(sourcetype,\"WinEventLog\"), \"Windows Events\", match(sourcetype,\"meraki\"), \"Meraki Network\", match(sourcetype,\"servicenow\"), \"ServiceNow\", match(sourcetype,\"mssql\"), \"MSSQL\", match(sourcetype,\"cisco:webex\"), \"Webex\", match(sourcetype,\"cpu|interfaces|iostat|vmstat\"), \"Linux Metrics\", 1=1, \"Other\") | timechart span=1d count by source_cat"
      }
    },
    "ds_recon_port_scans": {
      "type": "ds.search",
      "name": "Reconnaissance Port Scan Targets",
      "options": {
        "query": "index=fake_tshrt demo_id exfil sourcetype=\"FAKE:cisco:asa\" earliest=\"01/01/2026:00:00:00\" latest=\"01/05/2026:00:00:00\" | rex \"to\\s+\\w+:(?<dst_ip>[\\d.]+)\\/(?<dst_port>\\d+)\" | where isnotnull(dst_port) | stats count by dst_port | eval service=case(dst_port=\"3306\",\"MySQL (3306)\",dst_port=\"23\",\"Telnet (23)\",dst_port=\"5432\",\"PostgreSQL (5432)\",dst_port=\"1433\",\"MSSQL (1433)\",dst_port=\"22\",\"SSH (22)\",dst_port=\"445\",\"SMB (445)\",dst_port=\"3389\",\"RDP (3389)\",1=1,\"Port \".dst_port) | sort -count | head 10 | rename service as \"Target Service\" count as \"Scan Attempts\""
      }
    },
    "ds_recon_timeline": {
      "type": "ds.search",
      "name": "Reconnaissance Scan Volume Over Time",
      "options": {
        "query": "index=fake_tshrt demo_id exfil sourcetype=\"FAKE:cisco:asa\" earliest=\"01/01/2026:00:00:00\" latest=\"01/05/2026:00:00:00\" | timechart span=4h count"
      }
    },
    "ds_phishing_emails": {
      "type": "ds.search",
      "name": "Phishing Email Evidence",
      "options": {
        "query": "index=fake_tshrt demo_id exfil sourcetype=\"FAKE:o365:reporting:messagetrace\" | spath SenderAddress | spath RecipientAddress | spath Subject | spath Status | spath Operation | spath Reason | eval day=strftime(_time,\"%Y-%m-%d %H:%M\") | table day SenderAddress RecipientAddress Subject Status Operation Reason | sort day | rename day as \"Time\" SenderAddress as \"From\" RecipientAddress as \"To\" Operation as \"Action\" Reason as \"Detail\""
      }
    },
    "ds_initial_o365": {
      "type": "ds.search",
      "name": "Initial Access O365 Activity Day 5",
      "options": {
        "query": "index=fake_tshrt demo_id exfil sourcetype=\"FAKE:o365:management:activity\" earliest=\"01/05/2026:00:00:00\" latest=\"01/06/2026:00:00:00\" | spath Operation | spath UserId | spath SourceFileName | eval day=strftime(_time,\"%Y-%m-%d %H:%M\") | table day Operation UserId SourceFileName | sort day | rename day as \"Time\" UserId as \"User\" SourceFileName as \"File\""
      }
    },
    "ds_network_sankey": {
      "type": "ds.search",
      "name": "Network Traffic Flow -- ASA by Subnet",
      "options": {
        "query": "index=fake_tshrt demo_id exfil sourcetype=\"FAKE:cisco:asa\" | rex \"for\\s+\\w+:(?<src_ip>\\d+\\.\\d+\\.\\d+\\.\\d+)\\/\" | rex \"to\\s+\\w+:(?<dst_ip>\\d+\\.\\d+\\.\\d+\\.\\d+)\\/\" | where isnotnull(src_ip) AND isnotnull(dst_ip) | eval src_net=case(match(src_ip,\"^10\\.10\\.\"), \"Boston (10.10.x)\", match(src_ip,\"^10\\.20\\.\"), \"Atlanta (10.20.x)\", match(src_ip,\"^10\\.30\\.\"), \"Austin (10.30.x)\", match(src_ip,\"^172\\.16\\.\"), \"DMZ\", match(src_ip,\"^185\\.220\\.\"), \"Threat Actor\", 1=1, \"External\") | eval dst_net=case(match(dst_ip,\"^10\\.10\\.\"), \"Boston (10.10.x)\", match(dst_ip,\"^10\\.20\\.\"), \"Atlanta (10.20.x)\", match(dst_ip,\"^10\\.30\\.\"), \"Austin (10.30.x)\", match(dst_ip,\"^172\\.16\\.\"), \"DMZ\", match(dst_ip,\"^185\\.220\\.\"), \"Threat Actor\", 1=1, \"External\") | stats count as value by src_net dst_net | rename src_net as source dst_net as target | sort -value"
      }
    },
    "ds_lateral_entraid": {
      "type": "ds.search",
      "name": "Lateral Movement Entra ID Events",
      "options": {
        "query": "index=fake_tshrt demo_id exfil sourcetype=\"FAKE:azure:aad:*\" earliest=\"01/06/2026:00:00:00\" latest=\"01/09/2026:00:00:00\" | spath operationName | spath identity | spath callerIpAddress | spath properties.riskLevel | eval day=strftime(_time,\"%Y-%m-%d %H:%M\") | table day sourcetype operationName identity callerIpAddress properties.riskLevel | sort day | rename day as \"Time\" sourcetype as \"Source\" operationName as \"Operation\" identity as \"Identity\" callerIpAddress as \"IP\" properties.riskLevel as \"Risk\""
      }
    },
    "ds_persist_aws": {
      "type": "ds.search",
      "name": "Persistence AWS CloudTrail Activity",
      "options": {
        "query": "index=fake_tshrt demo_id exfil sourcetype=\"FAKE:aws:cloudtrail\" earliest=\"01/09/2026:00:00:00\" latest=\"01/12/2026:00:00:00\" | spath eventName | spath userIdentity.userName | spath requestParameters.bucketName | eval day=strftime(_time,\"%Y-%m-%d %H:%M\") | table day eventName userIdentity.userName requestParameters.bucketName | sort day | rename day as \"Time\" eventName as \"Event\" userIdentity.userName as \"User\" requestParameters.bucketName as \"Bucket\""
      }
    },
    "ds_persist_consent": {
      "type": "ds.search",
      "name": "Persistence Entra ID Audit Actions",
      "options": {
        "query": "index=fake_tshrt demo_id exfil sourcetype=\"FAKE:azure:aad:audit\" | spath operationName | spath properties.initiatedBy.user.userPrincipalName | spath properties.targetResources{}.displayName | eval day=strftime(_time,\"%Y-%m-%d %H:%M\") | table day operationName properties.initiatedBy.user.userPrincipalName properties.targetResources{}.displayName | sort day | rename day as \"Time\" operationName as \"Operation\" properties.initiatedBy.user.userPrincipalName as \"Initiated By\" properties.targetResources{}.displayName as \"Target\""
      }
    },
    "ds_exfil_o365": {
      "type": "ds.search",
      "name": "Exfiltration M365 File Operations",
      "options": {
        "query": "index=fake_tshrt demo_id exfil sourcetype=\"FAKE:o365:management:activity\" earliest=\"01/12/2026:00:00:00\" latest=\"01/15/2026:00:00:00\" | spath Operation | timechart span=4h count by Operation"
      }
    },
    "ds_exfil_aws_s3": {
      "type": "ds.search",
      "name": "Exfiltration AWS S3 Operations",
      "options": {
        "query": "index=fake_tshrt demo_id exfil sourcetype=\"FAKE:aws:cloudtrail\" earliest=\"01/12/2026:00:00:00\" latest=\"01/15/2026:00:00:00\" | spath eventName | spath userIdentity.userName | stats count by eventName userIdentity.userName | sort -count | rename eventName as \"Operation\" userIdentity.userName as \"User\""
      }
    },
    "ds_exfil_evidence": {
      "type": "ds.search",
      "name": "Exfiltration Endpoint Process Evidence",
      "options": {
        "query": "index=fake_tshrt demo_id exfil (sourcetype=\"FAKE:WinEventLog\" OR sourcetype=\"FAKE:WinEventLog:Sysmon\") earliest=\"01/12/2026:00:00:00\" latest=\"01/15/2026:00:00:00\" | rex \"Process Command Line:\\s*(?<cmdline>[^\\n]+)\" | rex \"CommandLine:\\s*(?<cmdline2>[^\\n]+)\" | rex \"Image:\\s*(?<process>[^\\n]+)\" | eval command=coalesce(cmdline,cmdline2) | eval process_name=coalesce(process,\"unknown\") | eval day=strftime(_time,\"%Y-%m-%d %H:%M\") | where isnotnull(command) | table day process_name command | sort day | rename day as \"Time\" process_name as \"Process\" command as \"Command Line\""
      }
    },
    "ds_exfil_risk": {
      "type": "ds.search",
      "name": "Exfiltration Entra ID Risk Detections",
      "options": {
        "query": "index=fake_tshrt demo_id exfil sourcetype=\"FAKE:azure:aad:riskDetection\" earliest=\"01/12/2026:00:00:00\" latest=\"01/15/2026:00:00:00\" | spath properties.riskEventType | spath properties.userDisplayName | spath properties.ipAddress | spath properties.riskLevel | spath properties.location.city | eval day=strftime(_time,\"%Y-%m-%d %H:%M\") | table day properties.userDisplayName properties.ipAddress properties.riskEventType properties.riskLevel properties.location.city | sort day | rename day as \"Time\" properties.userDisplayName as \"User\" properties.ipAddress as \"IP\" properties.riskEventType as \"Risk Type\" properties.riskLevel as \"Level\" properties.location.city as \"City\""
      }
    },
    "ds_response_servicenow": {
      "type": "ds.search",
      "name": "Incident Response ServiceNow Records",
      "options": {
        "query": "index=fake_tshrt demo_id exfil sourcetype=\"FAKE:servicenow:*\" | rex \"number=\\\"(?<ticket>[^\\\"]+)\\\"\" | rex \"state=\\\"(?<state>[^\\\"]+)\\\"\" | rex \"close_notes=\\\"(?<notes>[^\\\"]+)\\\"\" | rex \"work_notes=\\\"(?<work>[^\\\"]+)\\\"\" | rex \"resolved_by_name=\\\"(?<resolver>[^\\\"]+)\\\"\" | eval detail=coalesce(notes,work,\"\") | eval day=strftime(_time,\"%Y-%m-%d %H:%M\") | table day sourcetype ticket state resolver detail | sort day | rename day as \"Time\" sourcetype as \"Source\" ticket as \"Ticket\" state as \"State\" resolver as \"Resolved By\" detail as \"Details\""
      }
    },
    "ds_response_entraid": {
      "type": "ds.search",
      "name": "Incident Response Entra ID Actions",
      "options": {
        "query": "index=fake_tshrt demo_id exfil sourcetype=\"FAKE:azure:aad:audit\" | spath operationName | spath properties.initiatedBy.user.userPrincipalName | spath properties.targetResources{}.displayName | eval day=strftime(_time,\"%Y-%m-%d %H:%M\") | table day operationName properties.initiatedBy.user.userPrincipalName properties.targetResources{}.displayName | sort day | rename day as \"Time\" operationName as \"Action\" properties.initiatedBy.user.userPrincipalName as \"Initiated By\" properties.targetResources{}.displayName as \"Target\""
      }
    },
    "ds_cross_source_matrix": {
      "type": "ds.search",
      "name": "Cross-Source Correlation Matrix",
      "options": {
        "query": "index=fake_tshrt demo_id exfil | eval day=strftime(_time,\"%Y-%m-%d\") | eval source_cat=case(match(sourcetype,\"cisco:asa\"), \"ASA\", match(sourcetype,\"aws:cloudtrail\"), \"AWS\", match(sourcetype,\"google:gcp\"), \"GCP\", match(sourcetype,\"azure:aad\"), \"EntraID\", match(sourcetype,\"o365:management\"), \"M365\", match(sourcetype,\"o365:reporting\"), \"Exchange\", match(sourcetype,\"WinEventLog\"), \"Windows\", match(sourcetype,\"meraki\"), \"Meraki\", match(sourcetype,\"servicenow\"), \"SNOW\", match(sourcetype,\"mssql\"), \"MSSQL\", match(sourcetype,\"cisco:webex\"), \"Webex\", match(sourcetype,\"cpu|interfaces|iostat|vmstat\"), \"Linux\", 1=1, \"Other\") | chart count over day by source_cat | sort day"
      }
    },
    "ds_mitre_mapping": {
      "type": "ds.search",
      "name": "MITRE ATT&CK Technique Mapping",
      "options": {
        "query": "| makeresults | eval data=\"T1595.001|Reconnaissance|Active Scanning: Port Scanning|ASA deny logs from 185.220.101.42 -- 691 port scan events|Days 1-4,T1598|Reconnaissance|Phishing for Information|Webex login probes from external threat actor|Days 1-4,T1566.002|Initial Access|Phishing: Spearphishing Link|Email from rnicrosoft-security.com to jessica.brown|Day 5,T1078|Initial Access|Valid Accounts|Jessica Brown credentials compromised via phishing|Day 5,T1114.003|Initial Access|Email Forwarding Rule|Auto-forward to backup-jessica.brown@protonmail.com|Day 5,T1021|Lateral Movement|Remote Services|Cross-site connections ATL 10.20.x to BOS 10.10.x|Days 6-8,T1078.004|Lateral Movement|Valid Accounts: Cloud Accounts|Cloud service access with stolen credentials|Days 6-8,T1087|Lateral Movement|Account Discovery|Enumeration of AWS and GCP resources|Days 6-8,T1136.003|Persistence|Create Account: Cloud Account|AWS IAM user svc-datasync created by alex.miller|Days 9-11,T1098|Persistence|Account Manipulation|AttachUserPolicy and GCP SA grants|Days 9-11,T1071|Persistence|Application Layer Protocol|C2 beacons via HTTPS to 185.220.101.42|Days 9-11,T1213.002|Exfiltration|Data from SharePoint|188 FileDownloaded operations via M365|Days 12-14,T1567.002|Exfiltration|Exfil Over Web Service to Cloud Storage|rclone to Google Drive gdrive:backup/finance/|Days 12-14,T1041|Exfiltration|Exfil Over C2 Channel|curl POST to 185.220.101.42/upload|Days 12-14,T1070.004|Exfiltration|Indicator Removal: File Deletion|del /q data_batch_*.zip cleanup|Days 12-14\" | makemv delim=\",\" data | mvexpand data | rex field=data \"(?<technique_id>[^|]+)\\|(?<tactic>[^|]+)\\|(?<technique>[^|]+)\\|(?<evidence>[^|]+)\\|(?<days>[^|]+)\" | table technique_id tactic technique evidence days | rename technique_id as \"ID\" tactic as \"Tactic\" technique as \"Technique\" evidence as \"Evidence\" days as \"Days\""
      }
    }
  },
  "visualizations": {
    "viz_bg_header": {
      "type": "splunk.rectangle",
      "options": {
        "fillColor": "#13141A",
        "fillOpacity": 1.0,
        "strokeColor": "transparent"
      }
    },
    "viz_bg_phase1": {
      "type": "splunk.rectangle",
      "options": {
        "fillColor": "#1A1A10",
        "fillOpacity": 0.3,
        "strokeColor": "transparent"
      }
    },
    "viz_bg_phase2": {
      "type": "splunk.rectangle",
      "options": {
        "fillColor": "#1A1015",
        "fillOpacity": 0.3,
        "strokeColor": "transparent"
      }
    },
    "viz_bg_phase3": {
      "type": "splunk.rectangle",
      "options": {
        "fillColor": "#101A1F",
        "fillOpacity": 0.3,
        "strokeColor": "transparent"
      }
    },
    "viz_bg_phase4": {
      "type": "splunk.rectangle",
      "options": {
        "fillColor": "#1A1520",
        "fillOpacity": 0.3,
        "strokeColor": "transparent"
      }
    },
    "viz_bg_phase5": {
      "type": "splunk.rectangle",
      "options": {
        "fillColor": "#1A1015",
        "fillOpacity": 0.3,
        "strokeColor": "transparent"
      }
    },
    "viz_bg_response": {
      "type": "splunk.rectangle",
      "options": {
        "fillColor": "#0A1A0F",
        "fillOpacity": 0.3,
        "strokeColor": "transparent"
      }
    },
    "viz_header_md": {
      "type": "splunk.markdown",
      "options": {
        "markdown": "# â˜  Scenario -- Data Exfiltration (APT)\n\n**demo_id:** `exfil` | **Category:** Security -- Advanced Persistent Threat | **Duration:** 14 days (Jan 1-14, 2026) | **Severity:** Critical\n\n**Threat Actor:** 185.220.101.42 (Frankfurt, Germany | AS205100) -> **Initial Compromise:** Jessica Brown (IT Admin, Atlanta) -> **Primary Target:** Alex Miller (Sr. Financial Analyst, Boston)\n\nExternal threat actor conducts a 14-day APT campaign: port scanning and phishing (Days 1-4), credential harvesting (Day 5), lateral movement ATL->BOS (Days 6-8), cloud persistence via backdoor accounts (Days 9-11), and multi-channel data exfiltration via S3, Google Drive, and C2 upload (Days 12-14).",
        "fontColor": "#C3CBD4",
        "backgroundColor": "#13141A"
      }
    },
    "viz_kpi_events": {
      "type": "splunk.singlevalue",
      "title": "Total Events",
      "dataSources": {
        "primary": "ds_kpi_events"
      },
      "options": {
        "majorValue": "> primary | seriesByName('total') | lastPoint()",
        "majorColor": "#DC4E41",
        "backgroundColor": "#1A1015",
        "sparklineDisplay": "off"
      }
    },
    "viz_kpi_sourcetypes": {
      "type": "splunk.singlevalue",
      "title": "Sourcetypes",
      "dataSources": {
        "primary": "ds_kpi_sourcetypes"
      },
      "options": {
        "majorValue": "> primary | seriesByName('total') | lastPoint()",
        "majorColor": "#7B56DB",
        "backgroundColor": "#1A1520",
        "sparklineDisplay": "off"
      }
    },
    "viz_kpi_hosts": {
      "type": "splunk.singlevalue",
      "title": "Affected Hosts",
      "dataSources": {
        "primary": "ds_kpi_hosts"
      },
      "options": {
        "majorValue": "> primary | seriesByName('total') | lastPoint()",
        "majorColor": "#009CEB",
        "backgroundColor": "#101A1F",
        "sparklineDisplay": "off"
      }
    },
    "viz_kpi_users": {
      "type": "splunk.singlevalue",
      "title": "Affected Users",
      "dataSources": {
        "primary": "ds_kpi_users"
      },
      "options": {
        "majorValue": "> primary | seriesByName('total') | lastPoint()",
        "majorColor": "#F8BE34",
        "backgroundColor": "#1A1A10",
        "sparklineDisplay": "off"
      }
    },
    "viz_attack_flow_sankey": {
      "type": "splunk.sankey",
      "title": "Attack Flow -- Threat Actor -> Compromise -> Exfiltration",
      "dataSources": {
        "primary": "ds_attack_flow_sankey"
      },
      "options": {
        "linkColorMode": "source",
        "backgroundColor": "#13141A"
      }
    },
    "viz_attack_linkgraph": {
      "type": "splunk.linkgraph",
      "title": "ðŸ”— Attack Journey -- Full Kill Chain (32 steps: Recon -> Phishing -> Lateral Movement -> Persistence -> Exfiltration -> Incident Response)",
      "dataSources": {
        "primary": "ds_attack_linkgraph"
      },
      "options": {
        "nodeColor": "#2A2B36",
        "nodeHighlightColor": "#DC4E41",
        "linkColor": "#DC4E41",
        "linkWidth": 2,
        "nodeWidth": 350,
        "nodeHeight": 32,
        "nodeSpacingX": 60,
        "nodeSpacingY": 6,
        "showNodeCounts": true,
        "showValueCounts": true,
        "resultLimit": 50,
        "backgroundColor": "#13141A"
      }
    },
    "viz_attack_timeline": {
      "type": "splunk.area",
      "title": "14-Day Attack Timeline -- All Sources",
      "dataSources": {
        "primary": "ds_attack_timeline"
      },
      "options": {
        "stackMode": "stacked",
        "areaOpacity": 0.7,
        "legendDisplay": "right",
        "nullValueDisplay": "zero",
        "backgroundColor": "#13141A",
        "xAxisTitleVisibility": "hide",
        "yAxisTitleText": "Events / day",
        "yAxisTitleVisibility": "show",
        "yAxisAbbreviation": "auto",
        "seriesColors": ["#DC4E41", "#7B56DB", "#53A051", "#00D2FF", "#009CEB", "#F8BE34", "#F1813F", "#00CDAF", "#FF677B", "#AE8CFF"]
      },
      "showProgressBar": true,
      "showLastUpdated": true
    },
    "viz_phase1_header": {
      "type": "splunk.markdown",
      "options": {
        "markdown": "## ðŸ” Phase 1: Reconnaissance -- Days 1-4 (Jan 1-4)\n**MITRE ATT&CK:** T1595.001 (Active Scanning: Port Scanning) | T1598 (Phishing for Information)\n\nThreat actor at **185.220.101.42** (Frankfurt, Germany) conducts aggressive port scanning against public-facing infrastructure. Over 690 firewall deny events logged as the attacker probes database and remote access ports (MySQL 3306, Telnet 23, PostgreSQL 5432, MSSQL 1433). This reconnaissance maps the target network topology before initial access.",
        "fontColor": "#F8BE34",
        "backgroundColor": "#13141A"
      }
    },
    "viz_recon_ports": {
      "type": "splunk.column",
      "title": "Port Scan Targets -- Top Services",
      "dataSources": {
        "primary": "ds_recon_port_scans"
      },
      "options": {
        "seriesColors": ["#F8BE34"],
        "backgroundColor": "#13141A",
        "xAxisTitleVisibility": "hide",
        "yAxisTitleText": "Scan Attempts",
        "yAxisTitleVisibility": "show",
        "dataValuesDisplay": "all",
        "legendDisplay": "off"
      },
      "showProgressBar": true
    },
    "viz_recon_timeline": {
      "type": "splunk.area",
      "title": "Scan Volume Over Time (4h buckets)",
      "dataSources": {
        "primary": "ds_recon_timeline"
      },
      "options": {
        "areaOpacity": 0.5,
        "seriesColors": ["#F8BE34"],
        "backgroundColor": "#13141A",
        "xAxisTitleVisibility": "hide",
        "yAxisTitleText": "Events",
        "yAxisTitleVisibility": "show",
        "legendDisplay": "off"
      },
      "showProgressBar": true
    },
    "viz_phase2_header": {
      "type": "splunk.markdown",
      "options": {
        "markdown": "## ðŸŽ£ Phase 2: Initial Access -- Day 5 (Jan 5)\n**MITRE ATT&CK:** T1566.002 (Phishing: Spearphishing Link) | T1078 (Valid Accounts) | T1114.003 (Email Forwarding Rule)\n\nSpearphishing email delivered to **Jessica Brown** (IT Admin, Atlanta) from fake domain `rnicrosoft-security.com`. Credentials harvested on click. Attacker sets email forwarding rule to `backup-jessica.brown@protonmail.com` for persistent email access. Multiple O365 events confirm the attacker now has a foothold in the tenant.",
        "fontColor": "#DC4E41",
        "backgroundColor": "#13141A"
      }
    },
    "viz_phishing_emails": {
      "type": "splunk.table",
      "title": "Email Evidence -- Message Trace",
      "dataSources": {
        "primary": "ds_phishing_emails"
      },
      "options": {
        "count": 20,
        "showRowNumbers": false,
        "backgroundColor": "transparent"
      },
      "showProgressBar": true
    },
    "viz_initial_o365": {
      "type": "splunk.table",
      "title": "O365 Activity -- Day 5",
      "dataSources": {
        "primary": "ds_initial_o365"
      },
      "options": {
        "count": 20,
        "showRowNumbers": false,
        "backgroundColor": "transparent"
      },
      "showProgressBar": true
    },
    "viz_phase3_header": {
      "type": "splunk.markdown",
      "options": {
        "markdown": "## ðŸ”€ Phase 3: Lateral Movement -- Days 6-8 (Jan 6-8)\n**MITRE ATT&CK:** T1021 (Remote Services) | T1078.004 (Cloud Accounts) | T1087 (Account Discovery)\n\nUsing Jessica Brown's credentials, the attacker pivots from **Atlanta (10.20.x.x)** to **Boston (10.10.x.x)**. The Sankey diagram shows network traffic flow through the ASA firewall -- note cross-site connections from ATL to BOS. Cloud resource enumeration begins on Day 8 as the attacker discovers AWS and GCP infrastructure.",
        "fontColor": "#009CEB",
        "backgroundColor": "#13141A"
      }
    },
    "viz_network_sankey": {
      "type": "splunk.sankey",
      "title": "Network Traffic Flow -- ASA Firewall by Subnet",
      "dataSources": {
        "primary": "ds_network_sankey"
      },
      "options": {
        "linkColorMode": "source",
        "backgroundColor": "#13141A"
      }
    },
    "viz_lateral_entraid": {
      "type": "splunk.table",
      "title": "Entra ID Sign-ins and Risk Detections -- Days 6-8",
      "dataSources": {
        "primary": "ds_lateral_entraid"
      },
      "options": {
        "count": 15,
        "showRowNumbers": false,
        "backgroundColor": "transparent"
      },
      "showProgressBar": true
    },
    "viz_phase4_header": {
      "type": "splunk.markdown",
      "options": {
        "markdown": "## ðŸ”’ Phase 4: Persistence -- Days 9-11 (Jan 9-11)\n**MITRE ATT&CK:** T1136.003 (Create Cloud Account) | T1098 (Account Manipulation) | T1071 (Application Layer Protocol)\n\nThe attacker establishes persistence across cloud platforms. In AWS, **alex.miller** creates backdoor IAM user `svc-datasync` with admin policies. In Entra ID, admin consent is granted to malicious app **DataSync Service** with `Mail.Read` and `Files.Read.All` permissions. GCP service accounts show unusual storage operations. C2 beacons maintain communication with 185.220.101.42.",
        "fontColor": "#7B56DB",
        "backgroundColor": "#13141A"
      }
    },
    "viz_persist_aws": {
      "type": "splunk.table",
      "title": "AWS CloudTrail -- IAM and S3 Activity",
      "dataSources": {
        "primary": "ds_persist_aws"
      },
      "options": {
        "count": 15,
        "showRowNumbers": false,
        "backgroundColor": "transparent"
      },
      "showProgressBar": true
    },
    "viz_persist_consent": {
      "type": "splunk.table",
      "title": "Entra ID Audit -- Persistence Actions",
      "dataSources": {
        "primary": "ds_persist_consent"
      },
      "options": {
        "count": 10,
        "showRowNumbers": false,
        "backgroundColor": "transparent"
      },
      "showProgressBar": true
    },
    "viz_phase5_header": {
      "type": "splunk.markdown",
      "options": {
        "markdown": "## ðŸ’€ Phase 5: Exfiltration -- Days 12-14 (Jan 12-14)\n**MITRE ATT&CK:** T1567.002 (Exfil to Cloud Storage) | T1041 (Exfil Over C2) | T1213.002 (Data from SharePoint) | T1070.004 (File Deletion)\n\nMulti-channel data exfiltration during nighttime hours (01:00-05:00 UTC). **188 files** downloaded from SharePoint via M365. Data staged, compressed, and exfiltrated via three channels: (1) **rclone** to Google Drive, (2) **curl** to C2 server 185.220.101.42/upload, (3) **AWS S3** PutObject. Post-exfil cleanup: `del /q data_batch_*.zip`.",
        "fontColor": "#DC4E41",
        "backgroundColor": "#13141A"
      }
    },
    "viz_exfil_o365": {
      "type": "splunk.column",
      "title": "M365 File Operations -- Days 12-14",
      "dataSources": {
        "primary": "ds_exfil_o365"
      },
      "options": {
        "stackMode": "stacked",
        "seriesColors": ["#DC4E41", "#F8BE34", "#7B56DB", "#009CEB", "#53A051"],
        "backgroundColor": "#13141A",
        "xAxisTitleVisibility": "hide",
        "yAxisTitleText": "Events",
        "yAxisTitleVisibility": "show",
        "legendDisplay": "bottom"
      },
      "showProgressBar": true
    },
    "viz_exfil_aws": {
      "type": "splunk.column",
      "title": "AWS S3 Operations by User",
      "dataSources": {
        "primary": "ds_exfil_aws_s3"
      },
      "options": {
        "seriesColors": ["#7B56DB", "#DC4E41"],
        "backgroundColor": "#13141A",
        "xAxisTitleVisibility": "hide",
        "yAxisTitleText": "Count",
        "yAxisTitleVisibility": "show",
        "legendDisplay": "off"
      },
      "showProgressBar": true
    },
    "viz_exfil_evidence": {
      "type": "splunk.table",
      "title": "Endpoint Evidence -- Process Execution",
      "dataSources": {
        "primary": "ds_exfil_evidence"
      },
      "options": {
        "count": 20,
        "showRowNumbers": false,
        "backgroundColor": "transparent"
      },
      "showProgressBar": true
    },
    "viz_exfil_risk": {
      "type": "splunk.table",
      "title": "Entra ID Risk Detections -- Days 12-14",
      "dataSources": {
        "primary": "ds_exfil_risk"
      },
      "options": {
        "count": 15,
        "showRowNumbers": false,
        "backgroundColor": "transparent"
      },
      "showProgressBar": true
    },
    "viz_response_header": {
      "type": "splunk.markdown",
      "options": {
        "markdown": "## âœ… Incident Response & Containment\n\nThe security team discovers the breach via Entra ID risk detections and initiates incident response. Sessions revoked, user confirmed compromised, credentials rotated, endpoints isolated via Meraki policy, and backdoor accounts deleted across AWS and Entra ID.",
        "fontColor": "#53A051",
        "backgroundColor": "#13141A"
      }
    },
    "viz_response_servicenow": {
      "type": "splunk.table",
      "title": "ServiceNow -- Incident and Change Records",
      "dataSources": {
        "primary": "ds_response_servicenow"
      },
      "options": {
        "count": 15,
        "showRowNumbers": false,
        "backgroundColor": "transparent"
      },
      "showProgressBar": true
    },
    "viz_response_entraid": {
      "type": "splunk.table",
      "title": "Entra ID -- Response Actions",
      "dataSources": {
        "primary": "ds_response_entraid"
      },
      "options": {
        "count": 10,
        "showRowNumbers": false,
        "backgroundColor": "transparent"
      },
      "showProgressBar": true
    },
    "viz_matrix_header": {
      "type": "splunk.markdown",
      "options": {
        "markdown": "## ðŸ“Š Cross-Source Correlation Matrix\n\nEvents per source category per day across the 14-day attack -- identify which data sources activate during each phase.",
        "fontColor": "#C3CBD4",
        "backgroundColor": "#13141A"
      }
    },
    "viz_cross_source_matrix": {
      "type": "splunk.table",
      "title": "Events by Source Category per Day",
      "dataSources": {
        "primary": "ds_cross_source_matrix"
      },
      "options": {
        "count": 20,
        "showRowNumbers": false,
        "backgroundColor": "transparent"
      },
      "showProgressBar": true
    },
    "viz_gaps_md": {
      "type": "splunk.markdown",
      "options": {
        "markdown": "## âš  Identified Gaps & Improvements\n\n**1. Missing alex.miller sign-in from threat IP** -- Risk detections exist for 185.220.101.42 but no correlated EntraID sign-in event. *Fix: Add failed/successful sign-in in generate_entraid.py*\n\n**2. Missing WinEventLog 4624/4625 logon events** -- Cannot correlate authentication to compromised workstation. *Fix: Add logon events in generate_wineventlog.py*\n\n**3. Webex events tagged but not attack-relevant** -- 490+ routine Webex events inflate the event count. *Fix: Remove demo_id=exfil from non-attack Webex events*\n\n**4. GCP sourcetypes have :demo suffix** -- Inconsistent with documented FAKE:google:gcp:pubsub:message pattern. *Fix: Align in generate_gcp.py*\n\n**5. Linux metrics are noise** -- 900+ cpu/iostat/vmstat events are system metrics, not attack indicators. *Fix: Remove demo_id=exfil from routine metrics*\n\n**6. No Meraki MR/MS events during lateral movement** -- Missing wireless and switch telemetry. *Fix: Add MR/MS events in generate_meraki.py*",
        "fontColor": "#F8BE34",
        "backgroundColor": "#13141A"
      }
    },
    "viz_mitre_header": {
      "type": "splunk.markdown",
      "options": {
        "markdown": "## ðŸ›¡ MITRE ATT&CK Mapping\n\nTechniques observed across the 14-day campaign mapped to the MITRE ATT&CK framework. Each technique includes the evidence source and the day range in which activity was detected.",
        "fontColor": "#C3CBD4",
        "backgroundColor": "#13141A"
      }
    },
    "viz_mitre_table": {
      "type": "splunk.table",
      "title": "MITRE ATT&CK Technique Mapping",
      "dataSources": {
        "primary": "ds_mitre_mapping"
      },
      "options": {
        "count": 20,
        "showRowNumbers": false,
        "backgroundColor": "transparent"
      },
      "showProgressBar": true
    }
  },
  "inputs": {
    "input_global_trp": {
      "type": "input.timerange",
      "title": "Time Range",
      "options": {
        "token": "global_time",
        "defaultValue": "1767225600,1769904000"
      }
    }
  },
  "defaults": {
    "dataSources": {
      "ds.search": {
        "options": {
          "queryParameters": {
            "earliest": "$global_time.earliest$",
            "latest": "$global_time.latest$"
          }
        }
      }
    }
  },
  "layout": {
    "globalInputs": ["input_global_trp"],
    "layoutDefinitions": {
      "layout_main": {
        "type": "absolute",
        "options": {
          "width": 1920,
          "height": 7020,
          "display": "auto-scale",
          "backgroundColor": "#0B0C10"
        },
        "structure": [
          {
            "item": "viz_bg_header",
            "type": "block",
            "position": { "x": 0, "y": 0, "w": 1920, "h": 300 }
          },
          {
            "item": "viz_bg_phase1",
            "type": "block",
            "position": { "x": 0, "y": 1600, "w": 1920, "h": 600 }
          },
          {
            "item": "viz_bg_phase2",
            "type": "block",
            "position": { "x": 0, "y": 2200, "w": 1920, "h": 550 }
          },
          {
            "item": "viz_bg_phase3",
            "type": "block",
            "position": { "x": 0, "y": 2750, "w": 1920, "h": 600 }
          },
          {
            "item": "viz_bg_phase4",
            "type": "block",
            "position": { "x": 0, "y": 3350, "w": 1920, "h": 600 }
          },
          {
            "item": "viz_bg_phase5",
            "type": "block",
            "position": { "x": 0, "y": 3950, "w": 1920, "h": 750 }
          },
          {
            "item": "viz_bg_response",
            "type": "block",
            "position": { "x": 0, "y": 4700, "w": 1920, "h": 500 }
          },
          {
            "item": "viz_header_md",
            "type": "block",
            "position": { "x": 20, "y": 20, "w": 1880, "h": 260 }
          },
          {
            "item": "viz_kpi_events",
            "type": "block",
            "position": { "x": 20, "y": 300, "w": 460, "h": 130 }
          },
          {
            "item": "viz_kpi_sourcetypes",
            "type": "block",
            "position": { "x": 490, "y": 300, "w": 460, "h": 130 }
          },
          {
            "item": "viz_kpi_hosts",
            "type": "block",
            "position": { "x": 960, "y": 300, "w": 460, "h": 130 }
          },
          {
            "item": "viz_kpi_users",
            "type": "block",
            "position": { "x": 1430, "y": 300, "w": 460, "h": 130 }
          },
          {
            "item": "viz_attack_flow_sankey",
            "type": "block",
            "position": { "x": 20, "y": 460, "w": 1880, "h": 400 }
          },
          {
            "item": "viz_attack_linkgraph",
            "type": "block",
            "position": { "x": 20, "y": 880, "w": 1880, "h": 900 }
          },
          {
            "item": "viz_attack_timeline",
            "type": "block",
            "position": { "x": 20, "y": 1800, "w": 1880, "h": 380 }
          },
          {
            "item": "viz_phase1_header",
            "type": "block",
            "position": { "x": 20, "y": 2040, "w": 1880, "h": 130 }
          },
          {
            "item": "viz_recon_ports",
            "type": "block",
            "position": { "x": 20, "y": 2190, "w": 920, "h": 380 }
          },
          {
            "item": "viz_recon_timeline",
            "type": "block",
            "position": { "x": 960, "y": 2190, "w": 920, "h": 380 }
          },
          {
            "item": "viz_phase2_header",
            "type": "block",
            "position": { "x": 20, "y": 2640, "w": 1880, "h": 130 }
          },
          {
            "item": "viz_phishing_emails",
            "type": "block",
            "position": { "x": 20, "y": 2790, "w": 920, "h": 340 }
          },
          {
            "item": "viz_initial_o365",
            "type": "block",
            "position": { "x": 960, "y": 2790, "w": 920, "h": 340 }
          },
          {
            "item": "viz_phase3_header",
            "type": "block",
            "position": { "x": 20, "y": 3190, "w": 1880, "h": 130 }
          },
          {
            "item": "viz_network_sankey",
            "type": "block",
            "position": { "x": 20, "y": 3340, "w": 920, "h": 400 }
          },
          {
            "item": "viz_lateral_entraid",
            "type": "block",
            "position": { "x": 960, "y": 3340, "w": 920, "h": 400 }
          },
          {
            "item": "viz_phase4_header",
            "type": "block",
            "position": { "x": 20, "y": 3790, "w": 1880, "h": 130 }
          },
          {
            "item": "viz_persist_aws",
            "type": "block",
            "position": { "x": 20, "y": 3940, "w": 920, "h": 380 }
          },
          {
            "item": "viz_persist_consent",
            "type": "block",
            "position": { "x": 960, "y": 3940, "w": 920, "h": 380 }
          },
          {
            "item": "viz_phase5_header",
            "type": "block",
            "position": { "x": 20, "y": 4390, "w": 1880, "h": 130 }
          },
          {
            "item": "viz_exfil_o365",
            "type": "block",
            "position": { "x": 20, "y": 4540, "w": 613, "h": 300 }
          },
          {
            "item": "viz_exfil_aws",
            "type": "block",
            "position": { "x": 653, "y": 4540, "w": 613, "h": 300 }
          },
          {
            "item": "viz_exfil_evidence",
            "type": "block",
            "position": { "x": 1286, "y": 4540, "w": 614, "h": 300 }
          },
          {
            "item": "viz_exfil_risk",
            "type": "block",
            "position": { "x": 20, "y": 4860, "w": 1880, "h": 260 }
          },
          {
            "item": "viz_response_header",
            "type": "block",
            "position": { "x": 20, "y": 5140, "w": 1880, "h": 90 }
          },
          {
            "item": "viz_response_servicenow",
            "type": "block",
            "position": { "x": 20, "y": 5250, "w": 920, "h": 320 }
          },
          {
            "item": "viz_response_entraid",
            "type": "block",
            "position": { "x": 960, "y": 5250, "w": 920, "h": 320 }
          },
          {
            "item": "viz_matrix_header",
            "type": "block",
            "position": { "x": 20, "y": 5620, "w": 1880, "h": 70 }
          },
          {
            "item": "viz_cross_source_matrix",
            "type": "block",
            "position": { "x": 20, "y": 5710, "w": 1880, "h": 380 }
          },
          {
            "item": "viz_gaps_md",
            "type": "block",
            "position": { "x": 20, "y": 6120, "w": 1880, "h": 300 }
          },
          {
            "item": "viz_mitre_header",
            "type": "block",
            "position": { "x": 20, "y": 6440, "w": 1880, "h": 80 }
          },
          {
            "item": "viz_mitre_table",
            "type": "block",
            "position": { "x": 20, "y": 6540, "w": 1880, "h": 450 }
          }
        ]
      }
    },
    "options": {},
    "tabs": {
      "items": [
        {
          "label": "Attack Story",
          "layoutId": "layout_main"
        }
      ]
    }
  }
}
  ]]></definition>
</dashboard>
