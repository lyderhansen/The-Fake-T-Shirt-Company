<dashboard version="1.1" theme="dark">
  <label>Linux Metrics</label>
  <description>Linux system metrics - CPU, memory, disk, I/O</description>

  <fieldset submitButton="false">
    <input type="time" token="time" searchWhenChanged="true">
      <label>Time Range</label>
      <default>
        <earliest>1735689600</earliest>
        <latest>1736899200</latest>
      </default>
    </input>
  </fieldset>

  <row>
    <panel>
      <html>
        <div style="padding: 20px; background: linear-gradient(135deg, #1a1a1a 0%, #1f2d1f 100%); border-radius: 8px; border-left: 4px solid #f8be34;">
          <h2 style="color: #f8be34; margin-top: 0;">Linux System Metrics</h2>
          <p style="color: #ccc; font-size: 1.1em;">CPU, memory, disk, and I/O statistics from Linux servers in the DMZ and Atlanta.</p>
          <div style="display: flex; gap: 20px; margin-top: 15px; flex-wrap: wrap;">
            <div style="background: #333; padding: 10px 15px; border-radius: 5px;">
              <span style="color: #999;">CPU:</span> <code style="color: #5CC05C;">FAKE:cpu</code>
            </div>
            <div style="background: #333; padding: 10px 15px; border-radius: 5px;">
              <span style="color: #999;">Memory:</span> <code style="color: #5CC05C;">FAKE:vmstat</code>
            </div>
            <div style="background: #333; padding: 10px 15px; border-radius: 5px;">
              <span style="color: #999;">Disk:</span> <code style="color: #5CC05C;">FAKE:df</code>
            </div>
            <div style="background: #333; padding: 10px 15px; border-radius: 5px;">
              <span style="color: #999;">I/O:</span> <code style="color: #5CC05C;">FAKE:iostat</code>
            </div>
          </div>
        </div>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>Events by Metric Type</title>
      <chart>
        <search>
          <query>| tstats count where index=fake_tshrt (sourcetype="FAKE:cpu" OR sourcetype="FAKE:vmstat" OR sourcetype="FAKE:df" OR sourcetype="FAKE:iostat") by sourcetype</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">pie</option>
        <option name="charting.drilldown">none</option>
        <option name="height">250</option>
      </chart>
    </panel>
    <panel>
      <title>Events Over Time</title>
      <chart>
        <search>
          <query>| tstats count where index=fake_tshrt (sourcetype="FAKE:cpu" OR sourcetype="FAKE:vmstat" OR sourcetype="FAKE:df" OR sourcetype="FAKE:iostat") by _time span=1h</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">area</option>
        <option name="charting.drilldown">none</option>
        <option name="height">250</option>
        <option name="charting.fieldColors">{"count": 0xf8be34}</option>
      </chart>
    </panel>
  </row>

  <row>
    <panel>
      <title>Total Events</title>
      <single>
        <search>
          <query>| tstats count where index=fake_tshrt (sourcetype="FAKE:cpu" OR sourcetype="FAKE:vmstat" OR sourcetype="FAKE:df" OR sourcetype="FAKE:iostat")</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="colorMode">block</option>
        <option name="rangeColors">["0xf8be34","0xf8be34"]</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Unique Hosts</title>
      <single>
        <search>
          <query>| tstats dc(host) where index=fake_tshrt (sourcetype="FAKE:cpu" OR sourcetype="FAKE:vmstat" OR sourcetype="FAKE:df" OR sourcetype="FAKE:iostat")</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="colorMode">block</option>
        <option name="rangeColors">["0x5CC05C","0x5CC05C"]</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>High Disk Usage (&gt;90%)</title>
      <single>
        <search>
          <query>index=fake_tshrt sourcetype="FAKE:df" pct_used>90 | stats count</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="colorMode">block</option>
        <option name="rangeColors">["0xdc4e41","0xdc4e41"]</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>High Memory (&gt;85%)</title>
      <single>
        <search>
          <query>index=fake_tshrt sourcetype="FAKE:vmstat" memory_pct>85 | stats count</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="colorMode">block</option>
        <option name="rangeColors">["0xf8be34","0xf8be34"]</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>

  <row>
    <panel>
      <title>Linux Servers</title>
      <html>
        <div style="background: #1a1a1a; padding: 15px; border-radius: 5px;">
          <h4 style="color: #5CC05C; margin-top: 0;">Web Servers (DMZ)</h4>
          <ul style="color: #ccc; line-height: 1.8;">
            <li><strong>WEB-01</strong> (172.16.1.10) - Memory leak scenario</li>
            <li><strong>WEB-02</strong> (172.16.1.11) - Normal operation</li>
          </ul>

          <h4 style="color: #f8be34; margin-top: 15px;">Atlanta</h4>
          <ul style="color: #ccc; line-height: 1.8;">
            <li><strong>MON-ATL-01</strong> (10.20.20.30) - Disk filling scenario</li>
          </ul>
        </div>
      </html>
    </panel>
    <panel>
      <title>Key Fields</title>
      <html>
        <div style="background: #1a1a1a; padding: 15px; border-radius: 5px;">
          <h4 style="color: #f8be34; margin-top: 0;">vmstat (Memory)</h4>
          <p style="color: #ccc;">memory_pct, swap_pct, memory_used_kb, swap_used_kb</p>

          <h4 style="color: #f8be34; margin-top: 15px;">df (Disk)</h4>
          <p style="color: #ccc;">pct_used, mount, filesystem</p>

          <h4 style="color: #f8be34; margin-top: 15px;">iostat (I/O)</h4>
          <p style="color: #ccc;">io_wait, device, reads_sec, writes_sec</p>

          <h4 style="color: #f8be34; margin-top: 15px;">cpu</h4>
          <p style="color: #ccc;">cpu_pct, user_pct, system_pct, idle_pct</p>
        </div>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>Memory % by Host</title>
      <chart>
        <search>
          <query>index=fake_tshrt sourcetype="FAKE:vmstat"
| timechart span=4h avg(memory_pct) by host</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.drilldown">none</option>
        <option name="height">250</option>
      </chart>
    </panel>
    <panel>
      <title>Disk % by Host</title>
      <chart>
        <search>
          <query>index=fake_tshrt sourcetype="FAKE:df"
| timechart span=1d avg(pct_used) by host</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.drilldown">none</option>
        <option name="height">250</option>
      </chart>
    </panel>
  </row>

  <row>
    <panel>
      <title>Use Cases</title>
      <html>
        <div style="background: #1a1a1a; padding: 20px; border-radius: 5px;">
          <h3 style="color: #5CC05C; margin-top: 0;">Common SPL Queries</h3>

          <h4 style="color: #ccc; margin-top: 20px;">Memory Leak Detection</h4>
          <pre style="background: #0d0d0d; padding: 10px; border-radius: 3px; overflow-x: auto; color: #5CC05C;">index=fake_tshrt sourcetype="FAKE:vmstat" host=WEB-01 demo_id=memory_leak
| timechart span=4h avg(memory_pct) AS memory, avg(swap_pct) AS swap</pre>

          <h4 style="color: #ccc; margin-top: 20px;">Disk Filling Trend</h4>
          <pre style="background: #0d0d0d; padding: 10px; border-radius: 3px; overflow-x: auto; color: #5CC05C;">index=fake_tshrt sourcetype="FAKE:df" host=MON-ATL-01 demo_id=disk_filling
| timechart span=1d avg(pct_used) AS "Disk %"</pre>

          <h4 style="color: #ccc; margin-top: 20px;">High Memory Alerts</h4>
          <pre style="background: #0d0d0d; padding: 10px; border-radius: 3px; overflow-x: auto; color: #5CC05C;">index=fake_tshrt sourcetype="FAKE:vmstat" memory_pct>85
| stats count, max(memory_pct) AS max_mem by host
| sort - max_mem</pre>

          <h4 style="color: #ccc; margin-top: 20px;">I/O Wait Analysis</h4>
          <pre style="background: #0d0d0d; padding: 10px; border-radius: 3px; overflow-x: auto; color: #5CC05C;">index=fake_tshrt sourcetype="FAKE:iostat"
| timechart span=1h avg(io_wait) by host</pre>
        </div>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>Sample Events</title>
      <table>
        <search>
          <query>index=fake_tshrt (sourcetype="FAKE:cpu" OR sourcetype="FAKE:vmstat" OR sourcetype="FAKE:df" OR sourcetype="FAKE:iostat")
| table _time, sourcetype, host, memory_pct, swap_pct, pct_used, io_wait, demo_id
| head 20</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
</dashboard>
