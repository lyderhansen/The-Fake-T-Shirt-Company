<dashboard version="2" theme="dark">
  <label>Ransomware — Attack Blocked</label>
  <description>Ransomware attack detected and stopped in 20 minutes by EDR + Meraki IDS (Day 8-9)</description>
  <definition><![CDATA[
{
  "title": "Ransomware — Attack Blocked",
  "description": "Ransomware attack detected and stopped in 20 minutes by EDR + Meraki IDS (Day 8-9)",
  "dataSources": {
    "ds_total_events": {
      "type": "ds.search",
      "name": "Total Ransomware Events",
      "options": {
        "query": "index=fake_tshrt demo_id=ransomware_attempt | stats count"
      }
    },
    "ds_c2_count": {
      "type": "ds.search",
      "name": "C2 Beacon Count",
      "options": {
        "query": "index=fake_tshrt demo_id=ransomware_attempt sourcetype=\"FAKE:cisco:asa\" | stats count"
      }
    },
    "ds_lateral_count": {
      "type": "ds.search",
      "name": "Lateral Movement Attempts Blocked",
      "options": {
        "query": "index=fake_tshrt demo_id=ransomware_attempt EventID=4625 | stats count"
      }
    },
    "ds_ttc": {
      "type": "ds.search",
      "name": "Time to Containment",
      "options": {
        "query": "| makeresults | eval count=20 | table count"
      }
    },
    "ds_events_timeline": {
      "type": "ds.search",
      "name": "Events Over Time by Source",
      "options": {
        "query": "index=fake_tshrt demo_id=ransomware_attempt | timechart span=5m count by sourcetype"
      }
    },
    "ds_events_by_source": {
      "type": "ds.search",
      "name": "Event Distribution by Source",
      "options": {
        "query": "index=fake_tshrt demo_id=ransomware_attempt | stats count by sourcetype | sort -count"
      }
    },
    "ds_attack_flow": {
      "type": "ds.search",
      "name": "Attack Network Flow",
      "options": {
        "query": "| makeresults count=6 | streamstats count as id | eval source=case(id=1, \"185.234.72.15 (Phishing)\", id=2, \"10.30.30.20 (brooklyn.white)\", id=3, \"10.30.30.20 (brooklyn.white)\", id=4, \"10.30.30.20 (brooklyn.white)\", id=5, \"10.30.30.20 (brooklyn.white)\", id=6, \"MX-AUS-01 (Meraki IDS)\") | eval target=case(id=1, \"10.30.30.20 (brooklyn.white)\", id=2, \"194.26.29.42 (C2 Server)\", id=3, \"10.30.30.21 (dakota.harris)\", id=4, \"10.30.30.22 (phoenix.martin)\", id=5, \"10.30.30.40 (amelia.collins)\", id=6, \"ISOLATED (Quarantined)\") | eval value=case(id=1, 1, id=2, 4, id=3, 1, id=4, 1, id=5, 1, id=6, 1) | table source, target, value"
      }
    },
    "ds_process_chain": {
      "type": "ds.search",
      "name": "Windows Process Execution Chain",
      "options": {
        "query": "index=fake_tshrt sourcetype=\"FAKE:WinEventLog\" demo_id=ransomware_attempt (EventID=4688 OR EventID=4697 OR EventID=1116 OR EventID=4625) | eval Phase=case(EventID=4688 AND match(NewProcessName, \"(?i)WINWORD\"), \"Execution\", EventID=4688 AND match(NewProcessName, \"(?i)svchost_update\"), \"Installation\", EventID=4697, \"Persistence\", EventID=1116, \"Detection\", EventID=4625, \"Lateral Movement\", 1=1, \"Other\") | table _time, Phase, EventID, Computer, SubjectUserName, NewProcessName, ParentProcessName, CommandLine, ServiceName, TargetUserName | sort _time"
      }
    },
    "ds_c2_beacons": {
      "type": "ds.search",
      "name": "C2 Callback Connections via ASA",
      "options": {
        "query": "index=fake_tshrt sourcetype=\"FAKE:cisco:asa\" demo_id=ransomware_attempt | table _time, src, src_port, dest, dest_port, protocol, action | sort _time"
      }
    },
    "ds_lateral_attempts": {
      "type": "ds.search",
      "name": "Failed Lateral Movement Logons",
      "options": {
        "query": "index=fake_tshrt sourcetype=\"FAKE:WinEventLog\" demo_id=ransomware_attempt EventID=4625 | table _time, Computer, TargetUserName, TargetDomainName, IpAddress, IpPort, LogonType, FailureReason | sort _time"
      }
    },
    "ds_meraki_events": {
      "type": "ds.search",
      "name": "Meraki Security Events",
      "options": {
        "query": "index=fake_tshrt sourcetype=\"FAKE:meraki:*\" demo_id=ransomware_attempt | table _time, deviceName, type, clientMac, srcIp, destIp, message, blocked, description | sort _time"
      }
    },
    "ds_servicenow": {
      "type": "ds.search",
      "name": "ServiceNow Incidents",
      "options": {
        "query": "index=fake_tshrt sourcetype=\"FAKE:servicenow:incident\" demo_id=ransomware_attempt | table _time, number, state, priority, category, subcategory, short_description, assignment_group, cmdb_ci | sort _time"
      }
    },
    "ds_o365_events": {
      "type": "ds.search",
      "name": "Office 365 File Events",
      "options": {
        "query": "index=fake_tshrt sourcetype=\"FAKE:o365:management:activity\" demo_id=ransomware_attempt | table _time, UserId, Operation, ObjectId, SourceFileName | sort _time"
      }
    },
    "ds_exchange": {
      "type": "ds.search",
      "name": "Phishing Email Trace",
      "options": {
        "query": "index=fake_tshrt sourcetype=\"FAKE:o365:reporting:messagetrace\" demo_id=ransomware_attempt | table _time, SenderAddress, RecipientAddress, Subject, Status, AttachmentNames, FromIP, Size | sort _time"
      }
    },
    "ds_full_timeline": {
      "type": "ds.search",
      "name": "Complete Event Timeline",
      "options": {
        "query": "index=fake_tshrt demo_id=ransomware_attempt | eval description=coalesce(message, short_description, Subject, Operation, NewProcessName, type, action, \"--\") | eval entity=coalesce(user, UserId, SubjectUserName, SenderAddress, src, srcIp, deviceName, \"--\") | table _time, sourcetype, entity, description | sort _time | head 200"
      }
    }
  },
  "visualizations": {
    "viz_header": {
      "type": "splunk.markdown",
      "options": {
        "markdown": "# Ransomware Attack — BLOCKED\n\n**Brooklyn White** (Sales Engineer, Austin) received a phishing email with a malicious Word macro at **13:55** on **January 8, 2026**. The macro dropped an Emotet trojan (`svchost_update.exe`) which attempted C2 communication and lateral movement. **Windows Defender** detected the malware at **14:12**, and **Meraki IDS** automatically isolated the endpoint at **14:15**. Total time from infection to containment: **20 minutes**.\n\n| Field | Value |\n|-------|-------|\n| **Target** | Brooklyn White — brooklyn.white@theFakeTshirtCompany.com |\n| **Hostname** | AUS-WS-BWHITE01 (10.30.30.20) — Austin, TX |\n| **Malware** | Trojan:Win32/Emotet.RPK!MTB — `svchost_update.exe` |\n| **C2 Server** | 194.26.29.42 (Russia, AS49505) — Port 443 |\n| **Outcome** | Attack blocked, endpoint isolated and reimaged |\n| **demo_id** | `ransomware_attempt` |",
        "fontSize": "default",
        "fontColor": "#C3CBD4"
      }
    },
    "viz_kpi_total": {
      "type": "splunk.singlevalue",
      "title": "Total Events",
      "dataSources": {
        "primary": "ds_total_events"
      },
      "options": {
        "majorColor": "#53A051",
        "backgroundColor": "#171D29",
        "unit": "events",
        "unitPosition": "after"
      }
    },
    "viz_kpi_c2": {
      "type": "splunk.singlevalue",
      "title": "C2 Beacons",
      "dataSources": {
        "primary": "ds_c2_count"
      },
      "options": {
        "majorColor": "#DC4E41",
        "backgroundColor": "#171D29",
        "unit": "connections",
        "unitPosition": "after"
      }
    },
    "viz_kpi_lateral": {
      "type": "splunk.singlevalue",
      "title": "Lateral Attempts Blocked",
      "dataSources": {
        "primary": "ds_lateral_count"
      },
      "options": {
        "majorColor": "#F8BE34",
        "backgroundColor": "#171D29",
        "unit": "blocked",
        "unitPosition": "after"
      }
    },
    "viz_kpi_ttc": {
      "type": "splunk.singlevalue",
      "title": "Time to Containment",
      "dataSources": {
        "primary": "ds_ttc"
      },
      "options": {
        "majorColor": "#53A051",
        "backgroundColor": "#171D29",
        "unit": "min",
        "unitPosition": "after"
      }
    },
    "viz_killchain": {
      "type": "splunk.markdown",
      "options": {
        "markdown": "### Kill Chain Timeline — January 8, 2026\n\n| Time | Phase | Event | Source | Status |\n|------|-------|-------|--------|--------|\n| **13:55** | Delivery | Phishing email with `Invoice_Q4_2026.docm` | Exchange | Delivered |\n| **14:02** | Execution | Word macro opens malicious attachment | WinEventLog (4688) | Executed |\n| **14:03** | Installation | Dropper `svchost_update.exe` launched from Word | WinEventLog (4688) | Executed |\n| **14:04** | Persistence | Service \"Windows Update Helper\" installed | WinEventLog (4697) | Installed |\n| **14:05** | Command and Control | HTTPS beacon to 194.26.29.42:443 (Russia) | Cisco ASA (302013) | 4 beacons |\n| **14:08-11** | Lateral Movement | SMB brute force to 3 Austin workstations | WinEventLog (4625) | All FAILED |\n| **14:12** | **DETECTION** | **Windows Defender quarantines Emotet trojan** | **WinEventLog (1116)** | **QUARANTINED** |\n| **14:12** | **DETECTION** | **Meraki IDS blocks lateral SMB traffic** | **Meraki MX-AUS-01** | **BLOCKED** |\n| **14:15** | **CONTAINMENT** | **Client network isolated + WiFi disassociated** | **Meraki MX/MR** | **ISOLATED** |\n\n**Total: 20 minutes from infection to full containment**\n\n---\n\n**Day 9 — Recovery:** IT Admin jessica.brown restores encrypted OneDrive files. Workstation AUS-WS-BWHITE01 reimaged. Three ServiceNow incidents tracked through resolution.",
        "fontSize": "default",
        "fontColor": "#C3CBD4"
      }
    },
    "viz_timeline_chart": {
      "type": "splunk.column",
      "title": "Attack Events Over Time (5-min intervals)",
      "dataSources": {
        "primary": "ds_events_timeline"
      },
      "options": {
        "stackMode": "stacked",
        "legendDisplay": "right",
        "seriesColorsByField": {
          "FAKE:cisco:asa": "#DC4E41",
          "FAKE:o365:reporting:messagetrace": "#F1813F",
          "FAKE:WinEventLog": "#F8BE34",
          "FAKE:meraki:securityappliances": "#009CEB",
          "FAKE:meraki:accesspoints": "#5794DE",
          "FAKE:servicenow:incident": "#7B56DB",
          "FAKE:o365:management:activity": "#FF677B",
          "FAKE:XmlWinEventLog:Sysmon": "#00CDAF"
        },
        "xAxisTitleText": "Time",
        "yAxisTitleText": "Event Count",
        "xAxisTitleVisibility": "show",
        "yAxisTitleVisibility": "show"
      }
    },
    "viz_source_pie": {
      "type": "splunk.pie",
      "title": "Events by Data Source",
      "dataSources": {
        "primary": "ds_events_by_source"
      },
      "options": {
        "labelDisplay": "valuesAndPercentage",
        "seriesColorsByField": {
          "FAKE:cisco:asa": "#DC4E41",
          "FAKE:o365:reporting:messagetrace": "#F1813F",
          "FAKE:WinEventLog": "#F8BE34",
          "FAKE:meraki:securityappliances": "#009CEB",
          "FAKE:meraki:accesspoints": "#5794DE",
          "FAKE:servicenow:incident": "#7B56DB",
          "FAKE:o365:management:activity": "#FF677B",
          "FAKE:XmlWinEventLog:Sysmon": "#00CDAF"
        }
      }
    },
    "viz_sankey": {
      "type": "splunk.sankey",
      "title": "Attack Network Flow",
      "dataSources": {
        "primary": "ds_attack_flow"
      },
      "options": {
        "linkColorMode": "source"
      }
    },
    "viz_attack_header": {
      "type": "splunk.markdown",
      "options": {
        "markdown": "### Attack Details\nDetailed log analysis across all affected data sources. Each table shows raw events correlated by `demo_id=ransomware_attempt`.",
        "fontSize": "default",
        "fontColor": "#C3CBD4"
      }
    },
    "viz_exchange_table": {
      "type": "splunk.table",
      "title": "Phishing Email (Exchange Message Trace)",
      "dataSources": {
        "primary": "ds_exchange"
      },
      "options": {
        "count": 10,
        "showRowNumbers": false
      }
    },
    "viz_process_table": {
      "type": "splunk.table",
      "title": "Windows Process Execution Chain",
      "dataSources": {
        "primary": "ds_process_chain"
      },
      "options": {
        "count": 20,
        "showRowNumbers": false,
        "columnFormat": {
          "Phase": {
            "rowBackgroundColors": "> table | seriesByName(\"Phase\") | matchValue(phaseColors)"
          }
        }
      },
      "context": {
        "phaseColors": [
          {"match": "Execution", "value": "#F8BE34"},
          {"match": "Installation", "value": "#F1813F"},
          {"match": "Persistence", "value": "#F1813F"},
          {"match": "Lateral Movement", "value": "#DC4E41"},
          {"match": "Detection", "value": "#53A051"},
          {"match": "Other", "value": "#5794DE"}
        ]
      }
    },
    "viz_c2_table": {
      "type": "splunk.table",
      "title": "C2 Callback Connections (Cisco ASA)",
      "dataSources": {
        "primary": "ds_c2_beacons"
      },
      "options": {
        "count": 10,
        "showRowNumbers": false
      }
    },
    "viz_lateral_table": {
      "type": "splunk.table",
      "title": "Failed Lateral Movement Attempts (Event 4625)",
      "dataSources": {
        "primary": "ds_lateral_attempts"
      },
      "options": {
        "count": 10,
        "showRowNumbers": false
      }
    },
    "viz_meraki_table": {
      "type": "splunk.table",
      "title": "Meraki Security Events (IDS + Isolation)",
      "dataSources": {
        "primary": "ds_meraki_events"
      },
      "options": {
        "count": 10,
        "showRowNumbers": false,
        "columnFormat": {
          "type": {
            "rowBackgroundColors": "> table | seriesByName(\"type\") | matchValue(typeColors)"
          }
        }
      },
      "context": {
        "typeColors": [
          {"match": "IDS Alert", "value": "#DC4E41"},
          {"match": "ids_alert", "value": "#DC4E41"},
          {"match": "client_isolated", "value": "#F8BE34"},
          {"match": "disassociation", "value": "#F1813F"}
        ]
      }
    },
    "viz_response_header": {
      "type": "splunk.markdown",
      "options": {
        "markdown": "### Response and Recovery\nIncident response actions, ServiceNow ticket tracking, and file recovery operations following the ransomware containment.",
        "fontSize": "default",
        "fontColor": "#C3CBD4"
      }
    },
    "viz_snow_table": {
      "type": "splunk.table",
      "title": "ServiceNow Incidents",
      "dataSources": {
        "primary": "ds_servicenow"
      },
      "options": {
        "count": 10,
        "showRowNumbers": false,
        "columnFormat": {
          "priority": {
            "rowBackgroundColors": "> table | seriesByName(\"priority\") | matchValue(priorityColors)"
          }
        }
      },
      "context": {
        "priorityColors": [
          {"match": "1", "value": "#DC4E41"},
          {"match": "2", "value": "#F1813F"},
          {"match": "3", "value": "#F8BE34"},
          {"match": "CRITICAL", "value": "#DC4E41"},
          {"match": "High", "value": "#F1813F"}
        ]
      }
    },
    "viz_o365_table": {
      "type": "splunk.table",
      "title": "Office 365 File Events (Encryption Attempt + Recovery)",
      "dataSources": {
        "primary": "ds_o365_events"
      },
      "options": {
        "count": 20,
        "showRowNumbers": false,
        "columnFormat": {
          "Operation": {
            "rowBackgroundColors": "> table | seriesByName(\"Operation\") | matchValue(operationColors)"
          }
        }
      },
      "context": {
        "operationColors": [
          {"match": "FileModified", "value": "#DC4E41"},
          {"match": "FileAccessed", "value": "#F8BE34"},
          {"match": "FileRestored", "value": "#53A051"}
        ]
      }
    },
    "viz_investigation": {
      "type": "splunk.markdown",
      "options": {
        "markdown": "### Investigation Queries\n\n**Full Attack Timeline:**\n```\nindex=fake_tshrt demo_id=ransomware_attempt | sort _time | table _time, sourcetype, host, EventID, message, action\n```\n\n**Process Creation Chain:**\n```\nindex=fake_tshrt sourcetype=\"FAKE:WinEventLog\" EventID=4688 Computer=\"AUS-WS-BWHITE01\" demo_id=ransomware_attempt\n| table _time, NewProcessName, ParentProcessName, CommandLine\n```\n\n**C2 Beacons:**\n```\nindex=fake_tshrt sourcetype=\"FAKE:cisco:asa\" src=10.30.30.20 dest=194.26.29.42 demo_id=ransomware_attempt\n| table _time, src, dest, dest_port, action\n```\n\n**Lateral Movement:**\n```\nindex=fake_tshrt EventID=4625 IpAddress=10.30.30.20 demo_id=ransomware_attempt\n| stats count by TargetUserName, IpPort\n```\n\n**Meraki Security Events:**\n```\nindex=fake_tshrt sourcetype=\"FAKE:meraki:*\" demo_id=ransomware_attempt\n| table _time, deviceName, clientMac, type, message, blocked\n```\n\n**ServiceNow Incidents:**\n```\nindex=fake_tshrt sourcetype=\"FAKE:servicenow:incident\" demo_id=ransomware_attempt\n| table _time, number, state, priority, short_description\n```\n\n**Office 365 File Activity (Encryption + Recovery):**\n```\nindex=fake_tshrt sourcetype=\"FAKE:o365:management:activity\" demo_id=ransomware_attempt\n| table _time, UserId, Operation, ObjectId\n```",
        "fontSize": "small",
        "fontColor": "#C3CBD4"
      }
    },
    "viz_full_table": {
      "type": "splunk.table",
      "title": "Complete Event Timeline (All Sources)",
      "dataSources": {
        "primary": "ds_full_timeline"
      },
      "options": {
        "count": 50,
        "showRowNumbers": true
      }
    }
  },
  "inputs": {
    "input_global_trp": {
      "type": "input.timerange",
      "title": "Time Range",
      "options": {
        "token": "global_time",
        "defaultValue": "1735689600,1736899200"
      }
    }
  },
  "defaults": {
    "dataSources": {
      "ds.search": {
        "options": {
          "queryParameters": {
            "earliest": "$global_time.earliest$",
            "latest": "$global_time.latest$"
          }
        }
      }
    }
  },
  "layout": {
    "globalInputs": ["input_global_trp"],
    "tabs": {
      "items": [
        {"layoutId": "layout_overview", "label": "Incident Overview"},
        {"layoutId": "layout_attack", "label": "Attack Analysis"},
        {"layoutId": "layout_response", "label": "Response & Recovery"}
      ],
      "options": {
        "barPosition": "top",
        "showTabBar": true
      }
    },
    "layoutDefinitions": {
      "layout_overview": {
        "type": "grid",
        "structure": [
          {"item": "viz_header", "type": "block", "position": {"x": 0, "y": 0, "w": 1200, "h": 280}},
          {"item": "viz_kpi_total", "type": "block", "position": {"x": 0, "y": 280, "w": 300, "h": 120}},
          {"item": "viz_kpi_c2", "type": "block", "position": {"x": 300, "y": 280, "w": 300, "h": 120}},
          {"item": "viz_kpi_lateral", "type": "block", "position": {"x": 600, "y": 280, "w": 300, "h": 120}},
          {"item": "viz_kpi_ttc", "type": "block", "position": {"x": 900, "y": 280, "w": 300, "h": 120}},
          {"item": "viz_killchain", "type": "block", "position": {"x": 0, "y": 400, "w": 1200, "h": 340}},
          {"item": "viz_timeline_chart", "type": "block", "position": {"x": 0, "y": 740, "w": 800, "h": 350}},
          {"item": "viz_source_pie", "type": "block", "position": {"x": 800, "y": 740, "w": 400, "h": 350}},
          {"item": "viz_sankey", "type": "block", "position": {"x": 0, "y": 1090, "w": 1200, "h": 310}}
        ]
      },
      "layout_attack": {
        "type": "grid",
        "structure": [
          {"item": "viz_attack_header", "type": "block", "position": {"x": 0, "y": 0, "w": 1200, "h": 60}},
          {"item": "viz_exchange_table", "type": "block", "position": {"x": 0, "y": 60, "w": 1200, "h": 200}},
          {"item": "viz_process_table", "type": "block", "position": {"x": 0, "y": 260, "w": 1200, "h": 370}},
          {"item": "viz_c2_table", "type": "block", "position": {"x": 0, "y": 630, "w": 600, "h": 300}},
          {"item": "viz_lateral_table", "type": "block", "position": {"x": 600, "y": 630, "w": 600, "h": 300}},
          {"item": "viz_meraki_table", "type": "block", "position": {"x": 0, "y": 930, "w": 1200, "h": 340}}
        ]
      },
      "layout_response": {
        "type": "grid",
        "structure": [
          {"item": "viz_response_header", "type": "block", "position": {"x": 0, "y": 0, "w": 1200, "h": 60}},
          {"item": "viz_snow_table", "type": "block", "position": {"x": 0, "y": 60, "w": 1200, "h": 280}},
          {"item": "viz_o365_table", "type": "block", "position": {"x": 0, "y": 340, "w": 1200, "h": 280}},
          {"item": "viz_investigation", "type": "block", "position": {"x": 0, "y": 620, "w": 1200, "h": 520}},
          {"item": "viz_full_table", "type": "block", "position": {"x": 0, "y": 1140, "w": 1200, "h": 400}}
        ]
      }
    }
  }
}
  ]]></definition>
</dashboard>
