<dashboard version="1.1" theme="dark">
  <label>Disk Filling - MON-ATL-01</label>
  <description>5-day disk filling from 45% to 97%, resolved Day 5 at 10:00 with cleanup</description>

  <fieldset submitButton="false">
    <input type="time" token="time" searchWhenChanged="true">
      <label>Time Range</label>
      <default>
        <earliest>1735689600</earliest>
        <latest>1736899200</latest>
      </default>
    </input>
  </fieldset>

  <row>
    <panel>
      <html>
        <div style="padding: 20px; background: linear-gradient(135deg, #1a1a1a 0%, #2d2d1f 100%); border-radius: 8px; border-left: 4px solid #f8be34;">
          <h2 style="color: #f8be34; margin-top: 0;">Disk Filling - Slow Burn Problem (Resolved)</h2>
          <p style="color: #ccc; font-size: 1.1em;">Monitoring server in Atlanta gradually fills up disk over 5 days. Resolved Day 5 @ 10:00 with log cleanup script. This demonstrates "slow burn" operational problems that are often overlooked until critical.</p>
          <div style="display: flex; gap: 30px; margin-top: 15px; flex-wrap: wrap;">
            <div style="background: #333; padding: 10px 15px; border-radius: 5px;">
              <span style="color: #999;">Duration:</span> <strong style="color: #fff;">5 days (Day 1-5)</strong>
            </div>
            <div style="background: #333; padding: 10px 15px; border-radius: 5px;">
              <span style="color: #999;">Category:</span> <strong style="color: #f8be34;">Operations</strong>
            </div>
            <div style="background: #333; padding: 10px 15px; border-radius: 5px;">
              <span style="color: #999;">demo_id:</span> <code style="color: #5CC05C;">disk_filling</code>
            </div>
            <div style="background: #333; padding: 10px 15px; border-radius: 5px;">
              <span style="color: #999;">Progression:</span> <strong style="color: #fff;">45% → 97% → 45% (cleanup)</strong>
            </div>
          </div>
        </div>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>Target Server</title>
      <html>
        <div style="background: #1a1a1a; padding: 15px; border-radius: 5px; border-left: 4px solid #f8be34;">
          <h3 style="color: #f8be34; margin-top: 0;">MON-ATL-01</h3>
          <table style="width: 100%;">
            <tr><td style="color: #999; padding: 5px 0; width: 120px;">Hostname:</td><td style="color: #fff;"><strong>MON-ATL-01</strong></td></tr>
            <tr><td style="color: #999; padding: 5px 0;">IP:</td><td style="color: #5CC05C;">10.20.20.30</td></tr>
            <tr><td style="color: #999; padding: 5px 0;">Location:</td><td style="color: #fff;">Atlanta</td></tr>
            <tr><td style="color: #999; padding: 5px 0;">OS:</td><td style="color: #fff;">Linux (Ubuntu 22.04)</td></tr>
            <tr><td style="color: #999; padding: 5px 0;">Total Disk:</td><td style="color: #fff;">500 GB</td></tr>
            <tr><td style="color: #999; padding: 5px 0;">Role:</td><td style="color: #fff;">Monitoring server (Splunk forwarder)</td></tr>
          </table>
        </div>
      </html>
    </panel>
    <panel>
      <title>Disk Progression</title>
      <html>
        <div style="background: #1a1a1a; padding: 15px; border-radius: 5px;">
          <table style="width: 100%; border-collapse: collapse;">
            <tr style="background: #2a2a2a;">
              <th style="padding: 8px; text-align: left; border: 1px solid #444;">Day</th>
              <th style="padding: 8px; text-align: left; border: 1px solid #444;">Disk %</th>
              <th style="padding: 8px; text-align: left; border: 1px solid #444;">GB Free</th>
              <th style="padding: 8px; text-align: left; border: 1px solid #444;">Status</th>
            </tr>
            <tr>
              <td style="padding: 8px; border: 1px solid #444;">1</td>
              <td style="padding: 8px; border: 1px solid #444;">45-50%</td>
              <td style="padding: 8px; border: 1px solid #444;">250-275</td>
              <td style="padding: 8px; border: 1px solid #444; color: #5CC05C;">Normal</td>
            </tr>
            <tr>
              <td style="padding: 8px; border: 1px solid #444;">2</td>
              <td style="padding: 8px; border: 1px solid #444;">55-65%</td>
              <td style="padding: 8px; border: 1px solid #444;">175-225</td>
              <td style="padding: 8px; border: 1px solid #444; color: #5CC05C;">Increasing</td>
            </tr>
            <tr>
              <td style="padding: 8px; border: 1px solid #444; color: #f8be34;"><strong>3</strong></td>
              <td style="padding: 8px; border: 1px solid #444; color: #f8be34;"><strong>70-80%</strong></td>
              <td style="padding: 8px; border: 1px solid #444;">100-150</td>
              <td style="padding: 8px; border: 1px solid #444; color: #f8be34;"><strong>WARNING</strong></td>
            </tr>
            <tr>
              <td style="padding: 8px; border: 1px solid #444; color: #dc4e41;"><strong>4</strong></td>
              <td style="padding: 8px; border: 1px solid #444; color: #dc4e41;"><strong>85-95%</strong></td>
              <td style="padding: 8px; border: 1px solid #444;">25-75</td>
              <td style="padding: 8px; border: 1px solid #444; color: #dc4e41;"><strong>CRITICAL</strong></td>
            </tr>
            <tr>
              <td style="padding: 8px; border: 1px solid #444; color: #dc4e41;"><strong>5 (før 10:00)</strong></td>
              <td style="padding: 8px; border: 1px solid #444; color: #dc4e41;"><strong>95-97%</strong></td>
              <td style="padding: 8px; border: 1px solid #444;">15-25</td>
              <td style="padding: 8px; border: 1px solid #444; color: #dc4e41;"><strong>EMERGENCY</strong></td>
            </tr>
            <tr>
              <td style="padding: 8px; border: 1px solid #444; color: #5CC05C;"><strong>5 @ 10:00</strong></td>
              <td style="padding: 8px; border: 1px solid #444; color: #5CC05C;"><strong>45%</strong></td>
              <td style="padding: 8px; border: 1px solid #444;">275</td>
              <td style="padding: 8px; border: 1px solid #444; color: #5CC05C;"><strong>RESOLVED</strong></td>
            </tr>
            <tr>
              <td style="padding: 8px; border: 1px solid #444;">6+</td>
              <td style="padding: 8px; border: 1px solid #444;">45%</td>
              <td style="padding: 8px; border: 1px solid #444;">275</td>
              <td style="padding: 8px; border: 1px solid #444; color: #5CC05C;">Normal</td>
            </tr>
          </table>
        </div>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>Disk % Over Time (MON-ATL-01)</title>
      <chart>
        <search>
          <query>index=fake_tshrt source="/opt/splunk/etc/apps/TA-FAKE-TSHRT/bin/output/linux/df.log" host=MON-ATL-01 demo_id=disk_filling
| timechart span=4h avg(pct_used) AS "Disk %"</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">area</option>
        <option name="charting.drilldown">none</option>
        <option name="height">300</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleY.text">Disk %</option>
      </chart>
    </panel>
  </row>

  <row>
    <panel>
      <title>Peak Disk Usage</title>
      <single>
        <search>
          <query>index=fake_tshrt source="/opt/splunk/etc/apps/TA-FAKE-TSHRT/bin/output/linux/df.log" host=MON-ATL-01 demo_id=disk_filling
| stats max(pct_used) AS "Peak Disk %"</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="colorMode">block</option>
        <option name="rangeColors">["0x5CC05C","0xf8be34","0xdc4e41"]</option>
        <option name="rangeValues">[75,90]</option>
        <option name="useColors">1</option>
        <option name="numberPrecision">0.0</option>
        <option name="unit">%</option>
      </single>
    </panel>
    <panel>
      <title>Total Events</title>
      <single>
        <search>
          <query>index=fake_tshrt demo_id=disk_filling | stats count</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="colorMode">block</option>
        <option name="rangeColors">["0xf8be34","0xf8be34"]</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Time to Resolution</title>
      <single>
        <search>
          <query>| makeresults | eval days="5 days" | table days</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="colorMode">block</option>
        <option name="rangeColors">["0x5CC05C","0x5CC05C"]</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Root Cause</title>
      <single>
        <search>
          <query>| makeresults | eval cause="No log rotation" | table cause</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="colorMode">block</option>
        <option name="rangeColors">["0xdc4e41","0xdc4e41"]</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>

  <row>
    <panel>
      <title>Resolution Events</title>
      <table>
        <search>
          <query>index=fake_tshrt source="/opt/splunk/etc/apps/TA-FAKE-TSHRT/bin/output/linux/syslog.log" host=MON-ATL-01 demo_id=disk_filling
  ("cleanup" OR "logrotate" OR "deleted" OR "freed" OR "resolved")
| sort _time
| table _time, message
| head 20</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>

  <row>
    <panel>
      <title>Severity Thresholds</title>
      <html>
        <div style="background: #1a1a1a; padding: 15px; border-radius: 5px;">
          <table style="width: 100%; border-collapse: collapse;">
            <tr style="background: #2a2a2a;">
              <th style="padding: 8px; text-align: left; border: 1px solid #444;">Level</th>
              <th style="padding: 8px; text-align: left; border: 1px solid #444;">Disk %</th>
              <th style="padding: 8px; text-align: left; border: 1px solid #444;">Days</th>
              <th style="padding: 8px; text-align: left; border: 1px solid #444;">Action Recommended</th>
            </tr>
            <tr>
              <td style="padding: 8px; border: 1px solid #444; color: #5CC05C;"><strong>Normal</strong></td>
              <td style="padding: 8px; border: 1px solid #444;">&lt;70%</td>
              <td style="padding: 8px; border: 1px solid #444;">1-2</td>
              <td style="padding: 8px; border: 1px solid #444;">Routine monitoring</td>
            </tr>
            <tr>
              <td style="padding: 8px; border: 1px solid #444; color: #f8be34;"><strong>Warning</strong></td>
              <td style="padding: 8px; border: 1px solid #444;">70-85%</td>
              <td style="padding: 8px; border: 1px solid #444;">3</td>
              <td style="padding: 8px; border: 1px solid #444;">Investigate, plan cleanup</td>
            </tr>
            <tr>
              <td style="padding: 8px; border: 1px solid #444; color: #dc4e41;"><strong>Critical</strong></td>
              <td style="padding: 8px; border: 1px solid #444;">85-95%</td>
              <td style="padding: 8px; border: 1px solid #444;">4</td>
              <td style="padding: 8px; border: 1px solid #444;">Immediate cleanup required</td>
            </tr>
            <tr>
              <td style="padding: 8px; border: 1px solid #444; color: #dc4e41;"><strong>Emergency</strong></td>
              <td style="padding: 8px; border: 1px solid #444;">&gt;95%</td>
              <td style="padding: 8px; border: 1px solid #444;">5 (før 10:00)</td>
              <td style="padding: 8px; border: 1px solid #444;">Service impact likely</td>
            </tr>
            <tr>
              <td style="padding: 8px; border: 1px solid #444; color: #5CC05C;"><strong>Resolved</strong></td>
              <td style="padding: 8px; border: 1px solid #444;">45%</td>
              <td style="padding: 8px; border: 1px solid #444;">5 @ 10:00</td>
              <td style="padding: 8px; border: 1px solid #444;">Cleanup completed</td>
            </tr>
          </table>
        </div>
      </html>
    </panel>
    <panel>
      <title>Root Cause &amp; Resolution</title>
      <html>
        <div style="background: #1a1a1a; padding: 15px; border-radius: 5px;">
          <h3 style="color: #dc4e41; margin-top: 0;">Problem: No Log Rotation</h3>
          <p style="color: #ccc;">Excessive logging from monitoring agents without log rotation policy.</p>
          <h4 style="color: #999; margin-top: 15px;">Files Growing:</h4>
          <ul style="color: #ccc; line-height: 2;">
            <li><code style="background: #333; padding: 2px 6px; border-radius: 3px;">/var/log/splunkforwarder/</code> - Splunk forwarder logs</li>
            <li><code style="background: #333; padding: 2px 6px; border-radius: 3px;">/var/log/monitoring/</code> - Agent debug logs</li>
            <li><code style="background: #333; padding: 2px 6px; border-radius: 3px;">/var/log/syslog</code> - System logs not rotated</li>
          </ul>
          <h3 style="color: #5CC05C; margin-top: 20px;">Resolution: Day 5 @ 10:00</h3>
          <p style="color: #ccc;">Automated cleanup script executed, log rotation configured.</p>
        </div>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>Disk % vs IO Wait Correlation</title>
      <chart>
        <search>
          <query>index=fake_tshrt host=MON-ATL-01 demo_id=disk_filling
  (source="/opt/splunk/etc/apps/TA-FAKE-TSHRT/bin/output/linux/df.log" OR source="/opt/splunk/etc/apps/TA-FAKE-TSHRT/bin/output/linux/vmstat.log")
| eval metric=if(sourcetype="FAKE:df", "Disk %", "IO Wait %")
| eval value=if(sourcetype="FAKE:df", pct_used, io_wait)
| timechart span=4h avg(value) by metric</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.drilldown">none</option>
        <option name="height">250</option>
        <option name="charting.legend.placement">bottom</option>
      </chart>
    </panel>
    <panel>
      <title>Free Space (GB) Over Time</title>
      <chart>
        <search>
          <query>index=fake_tshrt source="/opt/splunk/etc/apps/TA-FAKE-TSHRT/bin/output/linux/df.log" host=MON-ATL-01 demo_id=disk_filling
| eval free_gb = (100 - pct_used) * 5
| timechart span=4h avg(free_gb) AS "Free GB"</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">area</option>
        <option name="charting.drilldown">none</option>
        <option name="height">250</option>
      </chart>
    </panel>
  </row>

  <row>
    <panel>
      <title>Investigation Queries</title>
      <html>
        <div style="background: #1a1a1a; padding: 20px; border-radius: 5px;">
          <h3 style="color: #5CC05C; margin-top: 0;">Ready-to-Use SPL Queries</h3>

          <h4 style="color: #ccc; margin-top: 20px;">Disk Progression Over 5 Days</h4>
          <pre style="background: #0d0d0d; padding: 10px; border-radius: 3px; overflow-x: auto; color: #5CC05C;">index=fake_tshrt source="/opt/splunk/etc/apps/TA-FAKE-TSHRT/bin/output/linux/df.log" host=MON-ATL-01 demo_id=disk_filling
| timechart span=1d avg(pct_used) AS "Disk %"</pre>

          <h4 style="color: #ccc; margin-top: 20px;">Daily Breakdown</h4>
          <pre style="background: #0d0d0d; padding: 10px; border-radius: 3px; overflow-x: auto; color: #5CC05C;">index=fake_tshrt source="/opt/splunk/etc/apps/TA-FAKE-TSHRT/bin/output/linux/df.log" host=MON-ATL-01 demo_id=disk_filling
| eval day=strftime(_time, "%Y-%m-%d")
| stats min(pct_used) AS min, max(pct_used) AS max, avg(pct_used) AS avg by day
| sort day</pre>

          <h4 style="color: #ccc; margin-top: 20px;">Resolution Events</h4>
          <pre style="background: #0d0d0d; padding: 10px; border-radius: 3px; overflow-x: auto; color: #5CC05C;">index=fake_tshrt host=MON-ATL-01 demo_id=disk_filling
  ("cleanup" OR "logrotate" OR "deleted" OR "freed")
| table _time, message</pre>

          <h4 style="color: #ccc; margin-top: 20px;">Threshold Alerts</h4>
          <pre style="background: #0d0d0d; padding: 10px; border-radius: 3px; overflow-x: auto; color: #5CC05C;">index=fake_tshrt source="/opt/splunk/etc/apps/TA-FAKE-TSHRT/bin/output/linux/df.log" host=MON-ATL-01 demo_id=disk_filling
| eval severity=case(
    pct_used >= 95, "EMERGENCY",
    pct_used >= 85, "CRITICAL",
    pct_used >= 70, "WARNING",
    true(), "NORMAL"
)
| timechart span=4h count by severity</pre>

          <h4 style="color: #ccc; margin-top: 20px;">Free Space in GB</h4>
          <pre style="background: #0d0d0d; padding: 10px; border-radius: 3px; overflow-x: auto; color: #5CC05C;">index=fake_tshrt source="/opt/splunk/etc/apps/TA-FAKE-TSHRT/bin/output/linux/df.log" host=MON-ATL-01 demo_id=disk_filling
| eval free_gb = (100 - pct_used) * 5
| timechart span=4h avg(free_gb) AS "Free GB"</pre>
        </div>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>Recent Disk Filling Events</title>
      <table>
        <search>
          <query>index=fake_tshrt demo_id=disk_filling
| sort - _time
| table _time, sourcetype, host, mount, pct_used, io_wait
| head 50</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="count">20</option>
      </table>
    </panel>
  </row>
</dashboard>
