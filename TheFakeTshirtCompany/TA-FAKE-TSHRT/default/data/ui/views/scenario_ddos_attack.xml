<dashboard version="2" theme="dark">
  <label>Scenario - DDoS Attack</label>
  <description>Volumetric HTTP flood from botnet -- 28-hour attack targeting DMZ web servers with SD-WAN failover</description>
  <definition><![CDATA[
{
  "title": "Scenario - DDoS Attack",
  "description": "Volumetric HTTP flood from botnet -- 28-hour attack targeting DMZ web servers with SD-WAN failover",
  "dataSources": {
    "ds_total_events": {
      "type": "ds.search",
      "name": "Total DDoS Scenario Events Over Time",
      "options": {
        "query": "| tstats count where index=fake_tshrt IDX_demo_id=ddos_attack by _time span=1h"
      }
    },
    "ds_affected_sourcetypes": {
      "type": "ds.search",
      "name": "Affected Sourcetype Count",
      "options": {
        "query": "| tstats dc(sourcetype) as count where index=fake_tshrt IDX_demo_id=ddos_attack"
      }
    },
    "ds_affected_hosts": {
      "type": "ds.search",
      "name": "Affected Host Count",
      "options": {
        "query": "| tstats dc(host) as count where index=fake_tshrt IDX_demo_id=ddos_attack"
      }
    },
    "ds_attack_duration": {
      "type": "ds.search",
      "name": "Attack Duration",
      "options": {
        "query": "| makeresults | eval count=\"28 hrs\" | fields count"
      }
    },
    "ds_attack_timeline": {
      "type": "ds.search",
      "name": "Attack Volume Timeline (Access Logs)",
      "options": {
        "query": "index=fake_tshrt sourcetype=\"FAKE:access_combined\" demo_id=ddos_attack | timechart span=1h count"
      }
    },
    "ds_cross_source": {
      "type": "ds.search",
      "name": "Cross-Source Correlation Timeline",
      "options": {
        "query": "index=fake_tshrt demo_id=ddos_attack | eval source_label=case(match(sourcetype,\"access_combined\"), \"Apache Access\", match(sourcetype,\"online:order\"), \"Orders\", match(sourcetype,\"cisco:asa\"), \"Cisco ASA\", match(sourcetype,\"catalyst:device\"), \"Catalyst Center\", match(sourcetype,\"Perfmon\"), \"Perfmon\", match(sourcetype,\"cpu$\\|interfaces$\\|iostat$\"), \"Linux Metrics\", match(sourcetype,\"meraki\"), \"Meraki MX\", match(sourcetype,\"aws:cloudtrail\"), \"AWS CloudTrail\", match(sourcetype,\"cisco:ios\"), \"Catalyst Switch\", match(sourcetype,\"cisco:aci\"), \"ACI\", match(sourcetype,\"servicenow\"), \"ServiceNow\", 1=1, sourcetype) | timechart span=1h count by source_label"
      }
    },
    "ds_events_by_source": {
      "type": "ds.search",
      "name": "Events by Source Type",
      "options": {
        "query": "index=fake_tshrt demo_id=ddos_attack | eval source_label=case(match(sourcetype,\"access_combined\"), \"Apache Access\", match(sourcetype,\"online:order\"), \"Orders\", match(sourcetype,\"cisco:asa\"), \"Cisco ASA\", match(sourcetype,\"catalyst:device\"), \"Catalyst Center\", match(sourcetype,\"Perfmon\"), \"Perfmon\", match(sourcetype,\"cpu$\\|interfaces$\\|iostat$\"), \"Linux Metrics\", match(sourcetype,\"meraki\"), \"Meraki MX\", match(sourcetype,\"aws\"), \"AWS\", match(sourcetype,\"cisco:ios\"), \"Catalyst Switch\", match(sourcetype,\"cisco:aci\"), \"ACI\", match(sourcetype,\"servicenow\"), \"ServiceNow\", 1=1, sourcetype) | stats count by source_label | sort -count"
      }
    },
    "ds_asa_events": {
      "type": "ds.search",
      "name": "ASA Firewall Events Over Time",
      "options": {
        "query": "index=fake_tshrt sourcetype=\"FAKE:cisco:asa\" demo_id=ddos_attack | timechart span=1h count by message_id"
      }
    },
    "ds_http_errors": {
      "type": "ds.search",
      "name": "HTTP Error Rate Over Time",
      "options": {
        "query": "index=fake_tshrt sourcetype=\"FAKE:access_combined\" demo_id=ddos_attack | eval is_error=if(status>=500, 1, 0) | timechart span=1h perc(is_error) as error_rate"
      }
    },
    "ds_key_evidence": {
      "type": "ds.search",
      "name": "Key Evidence Timeline",
      "options": {
        "query": "index=fake_tshrt demo_id=ddos_attack (sourcetype=\"FAKE:cisco:asa\" OR sourcetype=\"FAKE:meraki:securityappliances\" OR sourcetype=\"FAKE:cisco:ios\" OR sourcetype=\"FAKE:cisco:aci:fault\" OR sourcetype=\"FAKE:servicenow:*\" OR sourcetype=\"FAKE:cisco:catalyst:issue\") | eval evidence=coalesce(message, short_description, description, \"event\") | eval source_label=case(match(sourcetype,\"cisco:asa\"), \"ASA\", match(sourcetype,\"meraki\"), \"Meraki\", match(sourcetype,\"cisco:ios\"), \"Catalyst\", match(sourcetype,\"cisco:aci\"), \"ACI\", match(sourcetype,\"servicenow\"), \"SNOW\", match(sourcetype,\"catalyst:issue\"), \"CatCenter\", 1=1, sourcetype) | table _time source_label host evidence | sort -_time | head 50 | rename source_label as \"Source\" host as \"Host\" evidence as \"Event\""
      }
    }
  },
  "visualizations": {
    "viz_header": {
      "type": "splunk.markdown",
      "options": {
        "markdown": "# Scenario -- DDoS Attack\n\n| Property | Value |\n|----------|-------|\n| **demo_id** | `ddos_attack` |\n| **Category** | Network (Attack) |\n| **Duration** | Days 18-19 (28 hours) |\n| **Severity** | Critical |\n| **Target** | WEB-01 / WEB-02 (DMZ 172.16.1.x) |\n| **Attack Type** | Volumetric HTTP Flood |\n| **Source** | Botnet (300+ IPs across 40+ countries) |\n| **Outcome** | SD-WAN failover triggered, rate limiting applied, attack subsides |\n\n**Scenario Summary:** A botnet launches a volumetric HTTP flood targeting the company's public web servers on Day 18. Traffic spikes 10x above baseline, causing HTTP 503 errors and degraded response times. The ASA triggers rate limiting, Meraki SD-WAN initiates failover, and Catalyst Center raises critical issues. ServiceNow tickets are opened. The attack subsides after 28 hours as botnet C2 is disrupted by upstream ISP filtering.",
        "fontColor": "#C3CBD4"
      }
    },
    "viz_kpi_total_events": {
      "type": "splunk.singlevalue",
      "title": "Scenario Events",
      "dataSources": {
        "primary": "ds_total_events"
      },
      "options": {
        "majorValue": "> sparklineValues | lastPoint()",
        "trendValue": "> sparklineValues | delta(-2)",
        "sparklineValues": "> primary | seriesByName('count')",
        "sparklineDisplay": "below",
        "trendDisplay": "percent",
        "majorColor": "#7B56DB",
        "trendColor": "> trendValue | rangeValue(trendColorConfig)",
        "backgroundColor": "transparent",
        "showSparklineAreaGraph": true,
        "sparklineStrokeColor": "#7B56DB"
      },
      "context": {
        "trendColorConfig": [
          { "value": "#DC4E41", "to": 0 },
          { "value": "#53A051", "from": 0 }
        ]
      }
    },
    "viz_kpi_sourcetypes": {
      "type": "splunk.singlevalue",
      "title": "Affected Sources",
      "dataSources": {
        "primary": "ds_affected_sourcetypes"
      },
      "options": {
        "majorValue": "> primary | seriesByName('count') | lastPoint()",
        "majorColor": "#009CEB",
        "backgroundColor": "transparent",
        "sparklineDisplay": "off"
      }
    },
    "viz_kpi_hosts": {
      "type": "splunk.singlevalue",
      "title": "Affected Hosts",
      "dataSources": {
        "primary": "ds_affected_hosts"
      },
      "options": {
        "majorValue": "> primary | seriesByName('count') | lastPoint()",
        "majorColor": "#F8BE34",
        "backgroundColor": "transparent",
        "sparklineDisplay": "off"
      }
    },
    "viz_kpi_duration": {
      "type": "splunk.singlevalue",
      "title": "Attack Duration",
      "dataSources": {
        "primary": "ds_attack_duration"
      },
      "options": {
        "majorValue": "> primary | seriesByName('count') | lastPoint()",
        "majorColor": "#DC4E41",
        "backgroundColor": "transparent",
        "sparklineDisplay": "off"
      }
    },
    "viz_attack_timeline": {
      "type": "splunk.area",
      "title": "HTTP Flood Volume (Access Logs)",
      "dataSources": {
        "primary": "ds_attack_timeline"
      },
      "options": {
        "legendDisplay": "off",
        "nullValueDisplay": "zero",
        "areaOpacity": 0.7,
        "backgroundColor": "transparent",
        "xAxisTitleVisibility": "hide",
        "yAxisTitleText": "Requests / hour",
        "yAxisTitleVisibility": "show",
        "yAxisAbbreviation": "auto",
        "seriesColors": ["#DC4E41"]
      },
      "showProgressBar": true
    },
    "viz_asa_events": {
      "type": "splunk.area",
      "title": "ASA Firewall Events by Message ID",
      "dataSources": {
        "primary": "ds_asa_events"
      },
      "options": {
        "stackMode": "stacked",
        "legendDisplay": "right",
        "nullValueDisplay": "zero",
        "areaOpacity": 0.7,
        "backgroundColor": "transparent",
        "xAxisTitleVisibility": "hide",
        "yAxisTitleText": "Events / hour",
        "yAxisTitleVisibility": "show",
        "seriesColors": ["#7B56DB", "#00D2FF", "#DC4E41", "#53A051", "#F8BE34", "#009CEB"]
      },
      "showProgressBar": true
    },
    "viz_cross_source": {
      "type": "splunk.area",
      "title": "Cross-Source Correlation Timeline",
      "dataSources": {
        "primary": "ds_cross_source"
      },
      "options": {
        "stackMode": "stacked",
        "legendDisplay": "right",
        "nullValueDisplay": "zero",
        "areaOpacity": 0.7,
        "backgroundColor": "transparent",
        "xAxisTitleVisibility": "hide",
        "yAxisTitleText": "Events / hour",
        "yAxisTitleVisibility": "show",
        "yAxisAbbreviation": "auto",
        "seriesColors": ["#7B56DB", "#00D2FF", "#DC4E41", "#53A051", "#F8BE34", "#009CEB", "#F1813F", "#CB2196", "#813193", "#0051B5", "#008C80"]
      },
      "showProgressBar": true,
      "showLastUpdated": true
    },
    "viz_events_donut": {
      "type": "splunk.pie",
      "title": "Events by Source",
      "dataSources": {
        "primary": "ds_events_by_source"
      },
      "options": {
        "labelDisplay": "valuesAndPercentage",
        "showDonutHole": true,
        "seriesColors": ["#7B56DB", "#00D2FF", "#DC4E41", "#53A051", "#F8BE34", "#009CEB", "#F1813F", "#CB2196", "#813193", "#0051B5", "#008C80"]
      }
    },
    "viz_http_errors": {
      "type": "splunk.line",
      "title": "HTTP Error Rate (%)",
      "dataSources": {
        "primary": "ds_http_errors"
      },
      "options": {
        "legendDisplay": "off",
        "nullValueDisplay": "zero",
        "backgroundColor": "transparent",
        "xAxisTitleVisibility": "hide",
        "yAxisTitleText": "Error Rate %",
        "yAxisTitleVisibility": "show",
        "seriesColors": ["#DC4E41"]
      },
      "showProgressBar": true
    },
    "viz_evidence_header": {
      "type": "splunk.markdown",
      "options": {
        "markdown": "### Key Evidence",
        "fontColor": "#C3CBD4"
      }
    },
    "viz_key_evidence": {
      "type": "splunk.table",
      "title": "Evidence Timeline (Most Recent)",
      "dataSources": {
        "primary": "ds_key_evidence"
      },
      "options": {
        "count": 20,
        "showRowNumbers": false
      },
      "showProgressBar": true,
      "showLastUpdated": true
    }
  },
  "inputs": {
    "input_global_trp": {
      "type": "input.timerange",
      "title": "Time Range",
      "options": {
        "token": "global_time",
        "defaultValue": "1767225600,1769904000"
      }
    }
  },
  "defaults": {
    "dataSources": {
      "ds.search": {
        "options": {
          "queryParameters": {
            "earliest": "$global_time.earliest$",
            "latest": "$global_time.latest$"
          }
        }
      }
    }
  },
  "layout": {
    "type": "grid",
    "globalInputs": ["input_global_trp"],
    "structure": [
      {
        "item": "viz_header",
        "type": "block",
        "position": { "x": 0, "y": 0, "w": 1200, "h": 280 }
      },
      {
        "item": "viz_kpi_total_events",
        "type": "block",
        "position": { "x": 0, "y": 280, "w": 300, "h": 120 }
      },
      {
        "item": "viz_kpi_sourcetypes",
        "type": "block",
        "position": { "x": 300, "y": 280, "w": 300, "h": 120 }
      },
      {
        "item": "viz_kpi_hosts",
        "type": "block",
        "position": { "x": 600, "y": 280, "w": 300, "h": 120 }
      },
      {
        "item": "viz_kpi_duration",
        "type": "block",
        "position": { "x": 900, "y": 280, "w": 300, "h": 120 }
      },
      {
        "item": "viz_attack_timeline",
        "type": "block",
        "position": { "x": 0, "y": 400, "w": 600, "h": 300 }
      },
      {
        "item": "viz_asa_events",
        "type": "block",
        "position": { "x": 600, "y": 400, "w": 600, "h": 300 }
      },
      {
        "item": "viz_cross_source",
        "type": "block",
        "position": { "x": 0, "y": 700, "w": 750, "h": 350 }
      },
      {
        "item": "viz_events_donut",
        "type": "block",
        "position": { "x": 750, "y": 700, "w": 450, "h": 350 }
      },
      {
        "item": "viz_http_errors",
        "type": "block",
        "position": { "x": 0, "y": 1050, "w": 1200, "h": 300 }
      },
      {
        "item": "viz_evidence_header",
        "type": "block",
        "position": { "x": 0, "y": 1350, "w": 1200, "h": 50 }
      },
      {
        "item": "viz_key_evidence",
        "type": "block",
        "position": { "x": 0, "y": 1400, "w": 1200, "h": 400 }
      }
    ]
  }
}
  ]]></definition>
</dashboard>
