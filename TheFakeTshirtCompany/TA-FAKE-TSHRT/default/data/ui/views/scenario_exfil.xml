<dashboard version="1.1" theme="dark">
  <label>Exfil - APT Data Exfiltration</label>
  <description>14-day APT-style attack: Frankfurt → Atlanta → Boston → External data theft</description>

  <fieldset submitButton="false">
    <input type="time" token="time" searchWhenChanged="true">
      <label>Time Range</label>
      <default>
        <earliest>1735689600</earliest>
        <latest>1736899200</latest>
      </default>
    </input>
  </fieldset>

  <row>
    <panel>
      <html>
        <div style="padding: 20px; background: linear-gradient(135deg, #1a1a1a 0%, #2d1f1f 100%); border-radius: 8px; border-left: 4px solid #dc4e41;">
          <h2 style="color: #dc4e41; margin-top: 0;">APT Data Exfiltration Attack</h2>
          <p style="color: #ccc; font-size: 1.1em;">A sophisticated 14-day attack where a threat actor from Germany compromises an IT admin in Atlanta, moves laterally to Boston, and exfiltrates sensitive financial data.</p>
          <div style="display: flex; gap: 30px; margin-top: 15px; flex-wrap: wrap;">
            <div style="background: #333; padding: 10px 15px; border-radius: 5px;">
              <span style="color: #999;">Duration:</span> <strong style="color: #fff;">14 days</strong>
            </div>
            <div style="background: #333; padding: 10px 15px; border-radius: 5px;">
              <span style="color: #999;">Category:</span> <strong style="color: #dc4e41;">Security/Attack</strong>
            </div>
            <div style="background: #333; padding: 10px 15px; border-radius: 5px;">
              <span style="color: #999;">demo_id:</span> <code style="color: #5CC05C;">exfil</code>
            </div>
            <div style="background: #333; padding: 10px 15px; border-radius: 5px;">
              <span style="color: #999;">Outcome:</span> <strong style="color: #dc4e41;">Successful data theft</strong>
            </div>
          </div>
        </div>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>Attack Timeline by Phase</title>
      <html>
        <div style="padding: 15px; background: #1a1a1a; border-radius: 5px;">
          <table style="width: 100%; border-collapse: collapse;">
            <tr style="background: #2a2a2a;">
              <th style="padding: 12px; text-align: left; border: 1px solid #444; color: #5CC05C;">Phase</th>
              <th style="padding: 12px; text-align: left; border: 1px solid #444; color: #5CC05C;">Days</th>
              <th style="padding: 12px; text-align: left; border: 1px solid #444; color: #5CC05C;">Activity</th>
              <th style="padding: 12px; text-align: left; border: 1px solid #444; color: #5CC05C;">Location</th>
              <th style="padding: 12px; text-align: left; border: 1px solid #444; color: #5CC05C;">Key Logs</th>
            </tr>
            <tr>
              <td style="padding: 10px; border: 1px solid #444; color: #f8be34;">1. Reconnaissance</td>
              <td style="padding: 10px; border: 1px solid #444;">Days 1-3</td>
              <td style="padding: 10px; border: 1px solid #444;">Port scanning, phishing email sent</td>
              <td style="padding: 10px; border: 1px solid #444;">External → All</td>
              <td style="padding: 10px; border: 1px solid #444;"><code>ASA deny</code>, <code>Exchange</code></td>
            </tr>
            <tr>
              <td style="padding: 10px; border: 1px solid #444; color: #dc4e41;">2. Initial Access</td>
              <td style="padding: 10px; border: 1px solid #444;">Day 4</td>
              <td style="padding: 10px; border: 1px solid #444;">Jessica Brown clicks phishing link, credentials stolen</td>
              <td style="padding: 10px; border: 1px solid #444;">Atlanta (ATL)</td>
              <td style="padding: 10px; border: 1px solid #444;"><code>ASA inbound</code>, <code>EntraID</code></td>
            </tr>
            <tr>
              <td style="padding: 10px; border: 1px solid #444; color: #f8be34;">3. Lateral Movement</td>
              <td style="padding: 10px; border: 1px solid #444;">Days 5-7</td>
              <td style="padding: 10px; border: 1px solid #444;">Cross-site probing ATL→BOS, privilege escalation</td>
              <td style="padding: 10px; border: 1px solid #444;">ATL → BOS</td>
              <td style="padding: 10px; border: 1px solid #444;"><code>ASA ACL</code>, <code>WinEvent 4625</code></td>
            </tr>
            <tr>
              <td style="padding: 10px; border: 1px solid #444; color: #dc4e41;">4. Persistence</td>
              <td style="padding: 10px; border: 1px solid #444;">Days 8-10</td>
              <td style="padding: 10px; border: 1px solid #444;">AWS/GCP backdoors created, Alex Miller compromised</td>
              <td style="padding: 10px; border: 1px solid #444;">Boston (BOS)</td>
              <td style="padding: 10px; border: 1px solid #444;"><code>CloudTrail</code>, <code>GCP Audit</code></td>
            </tr>
            <tr>
              <td style="padding: 10px; border: 1px solid #444; color: #dc4e41;">5. Exfiltration</td>
              <td style="padding: 10px; border: 1px solid #444;">Days 11-14</td>
              <td style="padding: 10px; border: 1px solid #444;">Data theft 01:00-05:00 via cloud storage</td>
              <td style="padding: 10px; border: 1px solid #444;">Boston → External</td>
              <td style="padding: 10px; border: 1px solid #444;"><code>S3/GCS access</code>, <code>ASA bytes</code></td>
            </tr>
          </table>
        </div>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>Key Personnel</title>
      <html>
        <div style="display: flex; gap: 20px; flex-wrap: wrap;">
          <div style="flex: 1; min-width: 300px; background: #1a1a1a; padding: 15px; border-radius: 5px; border-left: 4px solid #f8be34;">
            <h3 style="color: #f8be34; margin-top: 0;">Initial Compromise</h3>
            <table style="width: 100%;">
              <tr><td style="color: #999; padding: 5px 0;">Name:</td><td style="color: #fff;"><strong>Jessica Brown</strong></td></tr>
              <tr><td style="color: #999; padding: 5px 0;">Role:</td><td style="color: #fff;">IT Administrator</td></tr>
              <tr><td style="color: #999; padding: 5px 0;">Location:</td><td style="color: #fff;">Atlanta</td></tr>
              <tr><td style="color: #999; padding: 5px 0;">Email:</td><td style="color: #fff;">jessica.brown@theFakeTshirtCompany.com</td></tr>
              <tr><td style="color: #999; padding: 5px 0;">Hostname:</td><td style="color: #fff;">ATL-WS-JBROWN01</td></tr>
              <tr><td style="color: #999; padding: 5px 0;">IP:</td><td style="color: #5CC05C;">10.20.30.15</td></tr>
            </table>
          </div>
          <div style="flex: 1; min-width: 300px; background: #1a1a1a; padding: 15px; border-radius: 5px; border-left: 4px solid #dc4e41;">
            <h3 style="color: #dc4e41; margin-top: 0;">Primary Target</h3>
            <table style="width: 100%;">
              <tr><td style="color: #999; padding: 5px 0;">Name:</td><td style="color: #fff;"><strong>Alex Miller</strong></td></tr>
              <tr><td style="color: #999; padding: 5px 0;">Role:</td><td style="color: #fff;">Sr. Financial Analyst</td></tr>
              <tr><td style="color: #999; padding: 5px 0;">Location:</td><td style="color: #fff;">Boston</td></tr>
              <tr><td style="color: #999; padding: 5px 0;">Email:</td><td style="color: #fff;">alex.miller@theFakeTshirtCompany.com</td></tr>
              <tr><td style="color: #999; padding: 5px 0;">Hostname:</td><td style="color: #fff;">BOS-WS-AMILLER01</td></tr>
              <tr><td style="color: #999; padding: 5px 0;">IP:</td><td style="color: #5CC05C;">10.10.30.55</td></tr>
            </table>
          </div>
          <div style="flex: 1; min-width: 300px; background: #1a1a1a; padding: 15px; border-radius: 5px; border-left: 4px solid #dc4e41;">
            <h3 style="color: #dc4e41; margin-top: 0;">Threat Actor</h3>
            <table style="width: 100%;">
              <tr><td style="color: #999; padding: 5px 0;">IP:</td><td style="color: #dc4e41;"><strong>185.220.101.42</strong></td></tr>
              <tr><td style="color: #999; padding: 5px 0;">Location:</td><td style="color: #fff;">Frankfurt, Germany</td></tr>
              <tr><td style="color: #999; padding: 5px 0;">ASN:</td><td style="color: #fff;">AS205100 (F3 Netze e.V.)</td></tr>
            </table>
          </div>
        </div>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>Attack Events Over Time</title>
      <chart>
        <search>
          <query>index=fake_tshrt demo_id=exfil
| timechart span=1d count by sourcetype</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">column</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.drilldown">none</option>
        <option name="height">300</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>
    <panel>
      <title>Events by Data Source</title>
      <chart>
        <search>
          <query>index=fake_tshrt demo_id=exfil
| stats count by sourcetype
| sort - count</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">pie</option>
        <option name="charting.drilldown">none</option>
        <option name="height">300</option>
      </chart>
    </panel>
  </row>

  <row>
    <panel>
      <title>Total Events</title>
      <single>
        <search>
          <query>index=fake_tshrt demo_id=exfil | stats count</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="colorMode">block</option>
        <option name="rangeColors">["0xdc4e41","0xdc4e41"]</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Data Sources Affected</title>
      <single>
        <search>
          <query>index=fake_tshrt demo_id=exfil | stats dc(sourcetype)</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="colorMode">block</option>
        <option name="rangeColors">["0x0877a6","0x0877a6"]</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Threat Actor Connections</title>
      <single>
        <search>
          <query>index=fake_tshrt demo_id=exfil src=185.220.101.42 | stats count</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="colorMode">block</option>
        <option name="rangeColors">["0xdc4e41","0xdc4e41"]</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Compromised Users</title>
      <single>
        <search>
          <query>index=fake_tshrt demo_id=exfil (user=jessica.brown OR user=alex.miller) | stats dc(user)</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="colorMode">block</option>
        <option name="rangeColors">["0xf8be34","0xf8be34"]</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>

  <row>
    <panel>
      <title>Phishing Details</title>
      <html>
        <div style="background: #1a1a1a; padding: 15px; border-radius: 5px;">
          <h3 style="color: #dc4e41; margin-top: 0;">Phishing Email</h3>
          <table style="width: 100%;">
            <tr><td style="color: #999; padding: 8px 0; width: 150px;">Fake Domain:</td><td style="color: #dc4e41;"><strong>rnicrosoft-security.com</strong> <span style="color: #666;">(note: "rn" looks like "m")</span></td></tr>
            <tr><td style="color: #999; padding: 8px 0;">Sender:</td><td style="color: #fff;">security@rnicrosoft-security.com</td></tr>
            <tr><td style="color: #999; padding: 8px 0;">Subject:</td><td style="color: #fff;">"Action Required: Verify your account security"</td></tr>
            <tr><td style="color: #999; padding: 8px 0;">URL:</td><td style="color: #fff;">https://rnicrosoft-security.com/verify?token=a8f3d9c2</td></tr>
            <tr><td style="color: #999; padding: 8px 0;">Recipient:</td><td style="color: #fff;">jessica.brown@theFakeTshirtCompany.com</td></tr>
            <tr><td style="color: #999; padding: 8px 0;">Sent:</td><td style="color: #fff;">Day 1, 16:42</td></tr>
          </table>
        </div>
      </html>
    </panel>
    <panel>
      <title>Exfiltrated Files</title>
      <html>
        <div style="background: #1a1a1a; padding: 15px; border-radius: 5px;">
          <h3 style="color: #dc4e41; margin-top: 0;">Sensitive Data Stolen</h3>
          <ul style="color: #ccc; line-height: 2;">
            <li><code style="background: #333; padding: 2px 6px; border-radius: 3px;">annual-financial-report.xlsx</code></li>
            <li><code style="background: #333; padding: 2px 6px; border-radius: 3px;">merger-plans-2025.docx</code></li>
            <li><code style="background: #333; padding: 2px 6px; border-radius: 3px;">employee-salaries.csv</code></li>
            <li><code style="background: #333; padding: 2px 6px; border-radius: 3px;">customer-database.csv</code></li>
            <li><code style="background: #333; padding: 2px 6px; border-radius: 3px;">q4-projections.xlsx</code></li>
          </ul>
          <p style="color: #999; margin-top: 10px;">Total: 500MB - 2.5GB per session, transferred 01:00-05:00</p>
        </div>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>Threat Actor Activity</title>
      <table>
        <search>
          <query>index=fake_tshrt demo_id=exfil src=185.220.101.42
| stats count by sourcetype, action, dest_port
| sort - count</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="count">10</option>
      </table>
    </panel>
    <panel>
      <title>Compromised User Activity</title>
      <table>
        <search>
          <query>index=fake_tshrt demo_id=exfil (user=jessica.brown OR user=alex.miller)
| stats count, earliest(_time) as first_seen, latest(_time) as last_seen by user, sourcetype
| eval first_seen=strftime(first_seen, "%Y-%m-%d %H:%M"), last_seen=strftime(last_seen, "%Y-%m-%d %H:%M")
| sort - count</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>

  <row>
    <panel>
      <title>Cloud Backdoor Events (AWS/GCP)</title>
      <table>
        <search>
          <query>index=fake_tshrt demo_id=exfil (sourcetype="FAKE:aws:cloudtrail" OR sourcetype="FAKE:google:gcp:*")
  (eventName=CreateUser OR eventName=AttachUserPolicy OR methodName=*CreateServiceAccountKey*)
| table _time, sourcetype, eventName, methodName, userIdentity.userName, requestParameters.userName
| sort _time</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="count">20</option>
      </table>
    </panel>
  </row>

  <row>
    <panel>
      <title>Investigation Queries</title>
      <html>
        <div style="background: #1a1a1a; padding: 20px; border-radius: 5px;">
          <h3 style="color: #5CC05C; margin-top: 0;">Ready-to-Use SPL Queries</h3>

          <h4 style="color: #ccc; margin-top: 20px;">Threat Actor Activity</h4>
          <pre style="background: #0d0d0d; padding: 10px; border-radius: 3px; overflow-x: auto; color: #5CC05C;">index=fake_tshrt demo_id=exfil src=185.220.101.42
| stats count by action, dest_port
| sort - count</pre>

          <h4 style="color: #ccc; margin-top: 20px;">Attack Timeline</h4>
          <pre style="background: #0d0d0d; padding: 10px; border-radius: 3px; overflow-x: auto; color: #5CC05C;">index=fake_tshrt demo_id=exfil
| timechart span=1d count by sourcetype</pre>

          <h4 style="color: #ccc; margin-top: 20px;">Compromised User Activity</h4>
          <pre style="background: #0d0d0d; padding: 10px; border-radius: 3px; overflow-x: auto; color: #5CC05C;">index=fake_tshrt demo_id=exfil (user=jessica.brown OR user=alex.miller)
| stats count, earliest(_time) AS first_seen, latest(_time) AS last_seen by user, sourcetype</pre>

          <h4 style="color: #ccc; margin-top: 20px;">Cloud Data Access</h4>
          <pre style="background: #0d0d0d; padding: 10px; border-radius: 3px; overflow-x: auto; color: #5CC05C;">index=fake_tshrt (sourcetype=FAKE:aws:cloudtrail OR sourcetype=FAKE:google:gcp:*)
  (eventName=GetObject OR methodName=*get*) demo_id=exfil
| stats count by eventName, bucketName</pre>

          <h4 style="color: #ccc; margin-top: 20px;">Lateral Movement</h4>
          <pre style="background: #0d0d0d; padding: 10px; border-radius: 3px; overflow-x: auto; color: #5CC05C;">index=fake_tshrt demo_id=exfil
  (src_ip=10.20.30.15 OR src_ip=10.10.30.55)
  (dest_ip=10.10.20.* OR dest_ip=10.20.20.*)
| stats count by src_ip, dest_ip, dest_port</pre>

          <h4 style="color: #ccc; margin-top: 20px;">Exfiltration Bursts</h4>
          <pre style="background: #0d0d0d; padding: 10px; border-radius: 3px; overflow-x: auto; color: #5CC05C;">index=fake_tshrt sourcetype=FAKE:cisco:asa demo_id=exfil action=built dest_port=443
| bin _time span=1h
| stats sum(bytes) AS total_bytes by _time
| where total_bytes > 100000000</pre>
        </div>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>Recent Exfil Events</title>
      <table>
        <search>
          <query>index=fake_tshrt demo_id=exfil
| sort - _time
| table _time, sourcetype, host, user, src, dest, action, message
| head 50</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="count">20</option>
      </table>
    </panel>
  </row>
</dashboard>
