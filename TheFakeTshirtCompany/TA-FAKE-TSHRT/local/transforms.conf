#
# local/transforms.conf for TA-FAKE-TSHRT
#
# CIM alignment overrides and fixes.
# These stanzas add missing attributes to lookup definitions in default/transforms.conf.
# Splunk merges local/ on top of default/ at the attribute level.
#

##############################################################################################################
# CISCO ASA - Lookup fixes (Phase 1)
##############################################################################################################

# Add WILDCARD match_type missing from default/ (required for CSV wildcard matching)
[cisco_asa_change_analysis_lookup]
match_type = WILDCARD(message_id)

[cisco_asa_vendor_class_lookup]
match_type = WILDCARD(message_id)


##############################################################################################################
# SYSMON - Lookup definitions (Phase 2)
# Source: Splunk_TA_microsoft_sysmon v4.x (Splunkbase #5765)
##############################################################################################################

# Sysmon EventCode to description mapping
[sysmon_eventcode_lookup]
default_match = Unknown
filename = sysmon_eventcode_lookup.csv
min_matches = 1

# DNS record type ID to name mapping (EventCode 22)
[sysmon_record_type_lookup]
default_match = 1
filename = sysmon_record_type_lookup.csv
min_matches = 1


##############################################################################################################
# AWS CLOUDTRAIL - Lookup definitions (Phase 3)
# Source: Splunk_TA_aws v7.x (Splunkbase #1876)
##############################################################################################################

# Action and status mapping from eventName + errorCode
# Uses WILDCARD on errorCode for fallback matching (e.g., * catches unknown error codes)
[aws_cloudtrail_action_status_lookup]
filename = aws_cloudtrail_action_status.csv
match_type = WILDCARD(errorCode)
min_matches = 1
default_match = unknown

# EventName to object_category mapping
[aws_cloudtrail_eventname_lookup]
filename = aws_cloudtrail_eventname_lookup.csv
min_matches = 1

# EventSource to change_type mapping (general)
[aws_cloudtrail_changetype_lookup]
filename = aws_cloudtrail_changetype.csv
min_matches = 1

# EventName to change_type mapping (specific, overrides source-based)
[aws_cloudtrail_eventname_changetype_lookup]
filename = aws_cloudtrail_eventname_changetype.csv
min_matches = 1


##############################################################################################################
# ENTRA ID (Azure AD) - Lookup definitions (Phase 4)
# Source: Splunk_TA_microsoft-cloudservices v5.x (Splunkbase #3110)
##############################################################################################################

# Dataset classification from operationName + category
# Used by sign-in and audit stanzas to classify events (authentication, account_management, alerts, all_changes)
[mscs_aad_audit_authentication_lookup]
filename = mscs_aad_audit_authentication.csv
min_matches = 1

# Change analysis from operationName
# Maps audit operationNames to change_type, action, object_category for CIM Change model
[mscs_aad_change_analysis_lookup]
filename = mscs_aad_change_analysis.csv
min_matches = 1

# Risk severity/type from properties.riskLevel
# Maps risk level (low/medium/high/hidden/none) to severity + type for CIM Alert model
[mscs_aad_severity_type_lookup]
filename = mscs_aad_severity_type.csv
min_matches = 1


##############################################################################################################
# MICROSOFT 365 / O365 - Lookup definitions (Phase 5)
# Source: splunk_ta_o365 v5.1.0 (Splunkbase)
##############################################################################################################

# Change analysis from Workload + Operation
# Maps O365 audit operations to dataset_name, action, change_type, object_category for CIM Change model
# Uses WILDCARD on Operation for AzureActiveDirectory entries (e.g., "Add user*")
[splunk_ta_o365_cim_change_analysis]
filename = splunk_ta_o365_cim_change_analysis_3_1_0.csv
match_type = WILDCARD(Operation)
min_matches = 1

# Data access classification from Workload + Operation
# Maps SharePoint/OneDrive/Teams file operations to CIM Data Access model
[splunk_ta_o365_cim_data_access]
filename = splunk_ta_o365_cim_data_access_3_1_0.csv
min_matches = 1

# Authentication dataset classification from Workload + Operation
[splunk_ta_o365_cim_authentication]
filename = splunk_ta_o365_cim_authentication_3_1_0.csv
min_matches = 1

# ResultStatus to CIM action mapping (success/failure)
[splunk_ta_o365_cim_authentication_ResultStatus]
filename = splunk_ta_o365_cim_authentication_ResultStatus.csv
min_matches = 1

# RecordType to human-readable record_type name + description
[splunk_ta_o365_cim_authentication_RecordType]
filename = splunk_ta_o365_cim_authentication_RecordType.csv
min_matches = 1

# Alert dataset classification from Workload + Operation (SecurityComplianceCenter)
[splunk_ta_o365_cim_alerts]
filename = splunk_ta_o365_cim_alerts.csv
min_matches = 1
