#
# local/transforms.conf for TA-FAKE-TSHRT
#
# CIM alignment overrides and fixes.
# These stanzas add missing attributes to lookup definitions in default/transforms.conf.
# Splunk merges local/ on top of default/ at the attribute level.
#

##############################################################################################################
# CISCO ASA - Lookup fixes (Phase 1)
##############################################################################################################

# Add WILDCARD match_type missing from default/ (required for CSV wildcard matching)
[cisco_asa_change_analysis_lookup]
match_type = WILDCARD(message_id)

[cisco_asa_vendor_class_lookup]
match_type = WILDCARD(message_id)


##############################################################################################################
# SYSMON - Lookup definitions (Phase 2)
# Source: Splunk_TA_microsoft_sysmon v4.x (Splunkbase #5765)
##############################################################################################################

# Sysmon EventCode to description mapping
[sysmon_eventcode_lookup]
default_match = Unknown
filename = sysmon_eventcode_lookup.csv
min_matches = 1

# DNS record type ID to name mapping (EventCode 22)
[sysmon_record_type_lookup]
default_match = 1
filename = sysmon_record_type_lookup.csv
min_matches = 1


##############################################################################################################
# AWS CLOUDTRAIL - Lookup definitions (Phase 3)
# Source: Splunk_TA_aws v7.x (Splunkbase #1876)
##############################################################################################################

# Action and status mapping from eventName + errorCode
# Uses WILDCARD on errorCode for fallback matching (e.g., * catches unknown error codes)
[aws_cloudtrail_action_status_lookup]
filename = aws_cloudtrail_action_status.csv
match_type = WILDCARD(errorCode)
min_matches = 1
default_match = unknown

# EventName to object_category mapping
[aws_cloudtrail_eventname_lookup]
filename = aws_cloudtrail_eventname_lookup.csv
min_matches = 1

# EventSource to change_type mapping (general)
[aws_cloudtrail_changetype_lookup]
filename = aws_cloudtrail_changetype.csv
min_matches = 1

# EventName to change_type mapping (specific, overrides source-based)
[aws_cloudtrail_eventname_changetype_lookup]
filename = aws_cloudtrail_eventname_changetype.csv
min_matches = 1
