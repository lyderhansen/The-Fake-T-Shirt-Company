#
# local/eventtypes.conf for TA-FAKE-TSHRT
#
# CIM-aligned event types from real Splunk TAs.
# Source: Supporting TA downloads (Splunkbase).
# Convention: fake_ prefix on all eventtype names.
# All searches use FAKE: prefixed sourcetypes.
#

##############################################################################################################
# CISCO ASA - CIM Event Types (Phase 1)
# Source: Splunk_TA_cisco-asa v6.0.0 (Splunkbase #1620)
# CIM Models: Network Traffic, Authentication, IDS, VPN, Change, Certificate, Alert
##############################################################################################################

[fake_cisco_authentication]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("109031","605004","605005","716047","772002","772003","772004","113008","113012","113004","113005","611101","605005","713166","713167","713185","716038","716039","713198","113015")

[fake_cisco_authentication_privileged]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("113021")

[fake_cisco_connection]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("109025","302013","305011","302015","106023","106015","106012","106100","106103","110002","302020","302021","305012","305013","338301","400013","710003","710005","419002","106021","313005","106001","313001","106007","303002","710002","313009","500003","106006","106014","419003","106020","338002","313004","302014","302016","430007","430004","430003","430002","507003")

[fake_cisco_intrusion]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("400032","106016","106017","430001")

[fake_cisco_vpn]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("722051","713228")

[fake_cisco_vpn_start]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("113039","716001","722022","602303","722033","722034")

[fake_cisco_vpn_end]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("113019","716002","722023","602304")

[fake_cisco_asa_network_sessions]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("609001","609002","716058","716059","722028","722029","722030","722031","722037","751025","725003","725007")

[fake_cisco_asa_configuration_change]
search = (sourcetype="FAKE:cisco:asa") (change_class=*) OR message_id IN ("505001","505002","505003","505004","505005","505006","505007","505008","505009","505015","113003")

[fake_cisco_asa_audit_change]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("771002","111009","111004","111001","502102","502101","502103","502111","111010","502112","505015","505004","505009")

[fake_cisco_asa_endpoint_filesystem]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("716015","716014","716016")

[fake_cisco_asa_certificates]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("717009","717022","717027","717028","717029","717037")

[fake_cisco_asa_network_resolution]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("713154")

[fake_cisco_asa_alert]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("110003","405001","212011")

[fake_cisco_network_session_start]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("302022","302024","302026")

[fake_cisco_network_session_end]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("302023","302025")


##############################################################################################################
# WINDOWS - CIM Event Types (Phase 2)
# Source: Splunk_TA_windows v9.x (Splunkbase #742)
# CIM Models: Authentication, Change, Endpoint, Performance
##############################################################################################################

# --- Base Eventtypes (Log Source Filters) ---

[fake_wineventlog_security]
search = (sourcetype="FAKE:WinEventLog") source="WinEventLog:Security"

[fake_wineventlog_system]
search = (sourcetype="FAKE:WinEventLog") source="WinEventLog:System"

[fake_wineventlog_application]
search = (sourcetype="FAKE:WinEventLog") source="WinEventLog:Application"

# --- Security: Authentication ---

# Successful logon (EventCode 4624)
[fake_windows_logon_success]
search = (sourcetype="FAKE:WinEventLog") EventCode=4624

# Failed logon (EventCode 4625)
[fake_windows_logon_failure]
search = (sourcetype="FAKE:WinEventLog") EventCode=4625

# Special privileges assigned to new logon (EventCode 4672)
[fake_windows_special_privileges]
search = (sourcetype="FAKE:WinEventLog") EventCode=4672

# Kerberos TGT requested (EventCode 4768)
[fake_windows_auth_ticket_granted]
search = (sourcetype="FAKE:WinEventLog") EventCode=4768

# Kerberos service ticket requested (EventCode 4769)
[fake_windows_service_ticket_granted]
search = (sourcetype="FAKE:WinEventLog") EventCode=4769

# NTLM credential validation (EventCode 4776)
[fake_windows_account_used4logon]
search = (sourcetype="FAKE:WinEventLog") EventCode=4776

# --- Security: Account Management ---

# User account password set (EventCode 4724)
[fake_windows_account_password_set]
search = (sourcetype="FAKE:WinEventLog") EventCode=4724

# User account changed (EventCode 4738)
[fake_windows_account_modified]
search = (sourcetype="FAKE:WinEventLog") EventCode=4738

# User account locked out (EventCode 4740)
[fake_windows_account_lockout]
search = (sourcetype="FAKE:WinEventLog") EventCode=4740

# --- Security: Process Tracking ---

# New process created (EventCode 4688)
[fake_windows_process_new]
search = (sourcetype="FAKE:WinEventLog") EventCode=4688

# --- Security: CIM Composite Eventtypes ---

# Authentication data model (4624 + 4625 + 4672)
[fake_windows_security_authentication]
search = (sourcetype="FAKE:WinEventLog") (EventCode=4624 OR EventCode=4625 OR EventCode=4672)

# Change data model - scheduled task created (EventCode 4698)
[fake_windows_security_change]
search = (sourcetype="FAKE:WinEventLog") EventCode=4698

# Change data model - account changes (4724 + 4728 + 4738 + 4740)
[fake_windows_security_change_account]
search = (sourcetype="FAKE:WinEventLog") (EventCode=4724 OR EventCode=4728 OR EventCode=4738 OR EventCode=4740)

# Endpoint processes data model (4688 + 4672)
[fake_windows_endpoint_processes]
search = (sourcetype="FAKE:WinEventLog") (EventCode=4688 OR EventCode=4672)

# --- System Events ---

# Time synchronization success (EventCode 37)
[fake_windows_time_sync]
search = (sourcetype="FAKE:WinEventLog") source="WinEventLog:System" EventCode=37

# --- Perfmon ---

# CPU performance metrics
[fake_perfmon_cputime]
search = (sourcetype="FAKE:Perfmon:Processor")

# Memory performance metrics
[fake_perfmon_memory]
search = (sourcetype="FAKE:Perfmon:Memory")

# Logical disk performance metrics
[fake_perfmon_logicaldisk]
search = (sourcetype="FAKE:Perfmon:LogicalDisk")


##############################################################################################################
# SYSMON - CIM Event Types (Phase 2)
# Source: Splunk_TA_microsoft_sysmon v4.x (Splunkbase #5765)
# CIM Models: Endpoint (Processes, Filesystem, Registry), Network Traffic, Network Resolution
##############################################################################################################

# Process events: Create(1), Terminate(5), ImageLoaded(7), CreateRemoteThread(8), ProcessAccess(10)
[fake_sysmon_process]
search = (sourcetype="FAKE:WinEventLog:Sysmon") (EventCode=1 OR EventCode=5 OR EventCode=7 OR EventCode=8 OR EventCode=10)

# Network connection (EventCode 3)
[fake_sysmon_network]
search = (sourcetype="FAKE:WinEventLog:Sysmon") EventCode=3

# File creation (EventCode 11)
[fake_sysmon_filemod]
search = (sourcetype="FAKE:WinEventLog:Sysmon") EventCode=11

# Registry modification (EventCode 13)
[fake_sysmon_regmod]
search = (sourcetype="FAKE:WinEventLog:Sysmon") EventCode=13

# DNS query (EventCode 22)
[fake_sysmon_dns]
search = (sourcetype="FAKE:WinEventLog:Sysmon") EventCode=22


##############################################################################################################
# AWS CLOUDTRAIL - CIM Event Types (Phase 3)
# Source: Splunk_TA_aws v7.x (Splunkbase #1876)
# CIM Models: Authentication, Change, Cloud
##############################################################################################################

# --- Authentication ---

# All auth events (ConsoleLogin + AssumeRole)
[fake_aws_cloudtrail_auth]
search = (sourcetype="FAKE:aws:cloudtrail") (eventName="AssumeRole" OR eventName="ConsoleLogin")

# Console login authentication
[fake_aws_cloudtrail_consolelogin_auth]
search = (sourcetype="FAKE:aws:cloudtrail") eventName="ConsoleLogin"

# Assume role authentication
[fake_aws_cloudtrail_assumeRole_auth]
search = (sourcetype="FAKE:aws:cloudtrail") eventName="AssumeRole"

# Multi-factor authentication events
[fake_aws_cloudtrail_multifactor_auth]
search = (sourcetype="FAKE:aws:cloudtrail") additionalEventData.MFAUsed="Yes"

# --- Change ---

# All change events (create, delete, modify, put)
[fake_aws_cloudtrail_change]
search = (sourcetype="FAKE:aws:cloudtrail") (eventName="CreateAccessKey" OR eventName="DeleteAccessKey" OR eventName="RunInstances" OR eventName="TerminateInstances" OR eventName="PutObject" OR eventName="DeleteObject" OR eventName="SetAlarmState" OR eventName="PutEvaluations" OR eventName="StartConfigRulesEvaluation" OR eventName="PutLogEvents")

# IAM-specific changes (access key management)
[fake_aws_cloudtrail_iam_change]
search = (sourcetype="FAKE:aws:cloudtrail") (eventName="CreateAccessKey" OR eventName="DeleteAccessKey")

# Delete/remove/terminate events
[fake_aws_cloudtrail_delete_events]
search = (sourcetype="FAKE:aws:cloudtrail") (eventName="DeleteObject" OR eventName="DeleteAccessKey" OR eventName="TerminateInstances")

# Endpoint (S3 object) changes
[fake_aws_cloudtrail_endpoint_change]
search = (sourcetype="FAKE:aws:cloudtrail") (eventName="PutObject" OR eventName="DeleteObject")

# --- Compute ---

# EC2 instance lifecycle events
[fake_aws_cloudtrail_ec2_events]
search = (sourcetype="FAKE:aws:cloudtrail") (eventName="RunInstances" OR eventName="TerminateInstances")

# --- Error ---

# All error events
[fake_aws_cloudtrail_errors]
search = (sourcetype="FAKE:aws:cloudtrail") errorCode="*" errorCode!="success"


##############################################################################################################
# ENTRA ID (Azure AD) - CIM Event Types (Phase 4)
# Source: Splunk_TA_microsoft-cloudservices v5.x (Splunkbase #3110)
# CIM Models: Authentication, Change, Alert
# Our FAKE TA uses 3 sourcetypes vs real TA's single azure:monitor:aad
##############################################################################################################

# --- Sign-in: Authentication ---

# All sign-in events
[fake_entra_signin]
search = (sourcetype="FAKE:azure:aad:signin")

# Successful sign-ins (resultType=0 means success)
[fake_entra_signin_success]
search = (sourcetype="FAKE:azure:aad:signin") resultType="0"

# Failed sign-ins (any non-zero resultType)
[fake_entra_signin_failure]
search = (sourcetype="FAKE:azure:aad:signin") resultType!="0"

# MFA-required sign-ins
[fake_entra_signin_mfa]
search = (sourcetype="FAKE:azure:aad:signin") "properties.authenticationRequirement"="multiFactorAuthentication"

# --- Audit: Change ---

# All audit events
[fake_entra_audit]
search = (sourcetype="FAKE:azure:aad:audit")

# Account management (user + group management)
[fake_entra_audit_account_mgmt]
search = (sourcetype="FAKE:azure:aad:audit") "properties.category" IN ("UserManagement","GroupManagement")

# Application management
[fake_entra_audit_app_mgmt]
search = (sourcetype="FAKE:azure:aad:audit") "properties.category"="ApplicationManagement"

# Role management
[fake_entra_audit_role_mgmt]
search = (sourcetype="FAKE:azure:aad:audit") "properties.category"="RoleManagement"

# --- Risk: Alert ---

# All risk detection events
[fake_entra_risk_detection]
search = (sourcetype="FAKE:azure:aad:riskDetection")

# High-risk detections
[fake_entra_risk_high]
search = (sourcetype="FAKE:azure:aad:riskDetection") "properties.riskLevel"="high"


##############################################################################################################
# MICROSOFT 365 / O365 - CIM Event Types (Phase 5)
# Source: splunk_ta_o365 v5.1.0 (Splunkbase)
# CIM Models: Change, Data Access, Authentication, Alert, Email
# dataset_name populated by lookups on Workload+Operation (see local/props.conf)
##############################################################################################################

# --- M365 Unified Audit Log (o365:management:activity) ---

# All change events (user/group/app/team management, configuration changes)
[fake_o365_change]
search = (sourcetype="FAKE:o365:management:activity") dataset_name="all_changes"

# Endpoint change events (SharePoint file/site modifications, access management)
[fake_o365_endpoint_changes]
search = (sourcetype="FAKE:o365:management:activity") dataset_name="endpoint_changes"

# Data access events (file read/download/upload, SharePoint/OneDrive operations)
[fake_o365_data_access]
search = (sourcetype="FAKE:o365:management:activity") dataset_name="data_access"

# Authentication events (AzureAD logon, Exchange MailboxLogin)
[fake_o365_authentication]
search = (sourcetype="FAKE:o365:management:activity") dataset_name="authentication"

# Account management events (user/group membership changes)
[fake_o365_account_management]
search = (sourcetype="FAKE:o365:management:activity") dataset_name="account_management"

# Security alert events (SecurityComplianceCenter alerts)
[fake_o365_alerts]
search = (sourcetype="FAKE:o365:management:activity") dataset_name="alerts"

# --- Exchange Message Trace ---

# All Exchange message trace events
[fake_o365_reporting_messagetrace]
search = (sourcetype="FAKE:ms:o365:reporting:messagetrace")


##############################################################################################################
# CISCO MERAKI - CIM Event Types (Phase 6)
# Source: Splunk_TA_cisco_meraki v3.2.0 (Splunkbase)
# CIM Models: Alert, Authentication, Change, Network Traffic, Network Sessions
# Scoped to event types our generators actually produce (JSON API format)
##############################################################################################################

# --- MX Security Appliances ---

# Alert events (DHCP problems, content filter blocks, malware, client isolation)
[fake_meraki_securityappliances_alerts]
search = (sourcetype="FAKE:meraki:securityappliances") type IN ("dhcp_problem","dhcp_blocked","content_filtering","amp_malware","client_isolation")

# Authentication events (splash auth)
[fake_meraki_securityappliances_authentication]
search = (sourcetype="FAKE:meraki:securityappliances") type="splash_auth"

# Change events (VPN, SD-WAN state changes)
[fake_meraki_securityappliances_change]
search = (sourcetype="FAKE:meraki:securityappliances") type IN ("vpn_connectivity_change","vpn_tunnel_status","sd_wan_failover")

# Network traffic (firewall flows, URL filtering, IDS/IPS)
[fake_meraki_securityappliances_network]
search = (sourcetype="FAKE:meraki:securityappliances") type IN ("firewall","url","security_event")

# Network sessions (SD-WAN health metrics)
[fake_meraki_securityappliances_networksessions]
search = (sourcetype="FAKE:meraki:securityappliances") type="sd_wan_health"

# --- MR Access Points ---

# Alert events (rogue SSID detection, health alerts)
[fake_meraki_accesspoints_alerts]
search = (sourcetype="FAKE:meraki:accesspoints") type IN ("rogue_ssid_detected","health_alert")

# Authentication events (802.1X, WPA auth)
[fake_meraki_accesspoints_authentication]
search = (sourcetype="FAKE:meraki:accesspoints") type IN ("wpa_auth","8021x_eap_success","8021x_eap_failure")

# Change events (client association/disassociation)
[fake_meraki_accesspoints_change]
search = (sourcetype="FAKE:meraki:accesspoints") type IN ("association","disassociation")

# --- MS Switches ---

# Change events (port status, STP, 802.1X port auth)
[fake_meraki_switches_change]
search = (sourcetype="FAKE:meraki:switches") type IN ("port_status","stp_change","8021x_auth")

# --- MV Cameras ---

# Change/Analytics events (motion, person detection, analytics, health)
[fake_meraki_cameras]
search = (sourcetype="FAKE:meraki:cameras") type IN ("motion_detected","person_detected","analytics","health_status")

# --- MT Sensors ---

# All sensor events (temperature, humidity, door, water leak)
# Phase 14 fix: was type="sensor_reading" only, now includes door_open/door_close/water events
[fake_meraki_sensors]
search = (sourcetype="FAKE:meraki:sensors")


##############################################################################################################
# LINUX (Splunk_TA_nix) - CIM Event Types (Phase 7)
# Source: Splunk_TA_nix (Splunkbase #833)
# CIM Models: Performance (cpu, vmstat, df, iostat), Inventory (interfaces), Authentication (auth)
# Scoped to event types our generators actually produce.
##############################################################################################################

# --- Performance / OS Metrics ---

[fake_cpu]
search = (sourcetype="FAKE:cpu")

[fake_vmstat]
search = (sourcetype="FAKE:vmstat")

[fake_df]
search = (sourcetype="FAKE:df")

[fake_iostat]
search = (sourcetype="FAKE:iostat")

[fake_interfaces]
search = (sourcetype="FAKE:interfaces")

# --- Authentication (linux:auth) ---

# SSH authentication (accepted + failed logins)
[fake_nix_sshd_authentication]
search = (sourcetype="FAKE:linux:auth") process=sshd (Accepted OR Failed)

# SSH session started (accepted logins only)
[fake_nix_sshd_session_start]
search = (sourcetype="FAKE:linux:auth") process=sshd Accepted

# SSH session ended (session close / logged out)
[fake_nix_sshd_session_end]
search = (sourcetype="FAKE:linux:auth") ("logged out" OR "session closed")

# Sudo/su authentication (privilege escalation)
[fake_nix_su_authentication]
search = (sourcetype="FAKE:linux:auth") process=sudo

# Failed SSH logins
[fake_nix_failed_login]
search = (sourcetype="FAKE:linux:auth") "Failed password"

# Cron job execution
[fake_nix_cron]
search = (sourcetype="FAKE:linux:auth") process=CRON

# Privileged session (sudo to root)
[fake_nix_privileged_session]
search = (sourcetype="FAKE:linux:auth") process=sudo USER=root


##############################################################################################################
# SERVICENOW (Splunk_TA_snow) - CIM Event Types (Phase 8)
# Source: Splunk_TA_snow (Splunkbase)
# CIM Models: Ticket Management (Incident, Change), Inventory (CMDB)
# Scoped to our 3 sourcetypes (incident, change, cmdb).
##############################################################################################################

# Incident tickets
[fake_snow_incident]
search = (sourcetype="FAKE:servicenow:incident")

# Change request tickets
[fake_snow_change_request]
search = (sourcetype="FAKE:servicenow:change")

# CMDB CI records (inventory)
[fake_snow_cmdb_ci_list]
search = (sourcetype="FAKE:servicenow:cmdb")


##############################################################################################################
# GCP (Splunk_TA_google-cloudplatform) - CIM Event Types (Phase 9)
# Source: Splunk_TA_google-cloudplatform v4.4.0 (Splunkbase #3088)
# CIM Models: Authentication (data_access), Change (admin_activity)
# Scoped to methods our generator produces.
##############################################################################################################

# --- Authentication (data_access = read/list operations) ---

[fake_gcp_audit_auth]
search = (sourcetype="FAKE:google:gcp:pubsub:audit:data_access")

# --- Change (admin_activity = create/modify/delete operations) ---

[fake_gcp_audit_change]
search = (sourcetype="FAKE:google:gcp:pubsub:audit:admin_activity")

# --- Change sub-types (granular classification) ---

# Compute instance operations (start, stop, list)
[fake_gcp_audit_change_instances]
search = (sourcetype="FAKE:google:gcp:pubsub:audit:admin_activity") ("protoPayload.methodName"="v1.compute.instances.start" OR "protoPayload.methodName"="v1.compute.instances.stop" OR "protoPayload.methodName"="v1.compute.instances.list")

# Storage operations (object create/delete/get, bucket get)
[fake_gcp_audit_change_storage]
search = (sourcetype="FAKE:google:gcp:pubsub:audit:admin_activity") ("protoPayload.methodName"="storage.objects.create" OR "protoPayload.methodName"="storage.objects.delete" OR "protoPayload.methodName"="storage.buckets.get" OR "protoPayload.methodName"="storage.objects.get")

# IAM policy changes
[fake_gcp_audit_change_iam]
search = (sourcetype="FAKE:google:gcp:pubsub:audit:admin_activity") ("protoPayload.methodName"="google.iam.admin.v1.SetIamPolicy")

# Service account key creation
[fake_gcp_audit_change_service_accounts]
search = (sourcetype="FAKE:google:gcp:pubsub:audit:admin_activity") ("protoPayload.methodName"="google.iam.admin.v1.CreateServiceAccountKey")

# --- Catch-all (all GCP audit events) ---

[fake_gcp_audit_all]
search = (sourcetype="FAKE:google:gcp:pubsub:audit:*")


##############################################################################################################
# Phase 10: CISCO CATALYST IOS-XE -- Eventtypes
# Source: TA_cisco_catalyst (Splunkbase)
##############################################################################################################

# --- Catch-all ---

[fake_catalyst_all]
search = (sourcetype="FAKE:cisco:ios")

# --- Port/Interface Events ---

[fake_catalyst_port_down]
search = (sourcetype="FAKE:cisco:ios") (mnemonic=UPDOWN "changed state to down")

[fake_catalyst_port_up]
search = (sourcetype="FAKE:cisco:ios") (mnemonic=UPDOWN "changed state to up")

# --- Authentication Events ---

[fake_catalyst_login_success]
search = (sourcetype="FAKE:cisco:ios") mnemonic=LOGIN_SUCCESS

[fake_catalyst_login_failed]
search = (sourcetype="FAKE:cisco:ios") mnemonic=LOGIN_FAILED

[fake_catalyst_ssh_login]
search = (sourcetype="FAKE:cisco:ios") mnemonic=SSH2_USERAUTH

[fake_catalyst_dot1x]
search = (sourcetype="FAKE:cisco:ios") (facility=DOT1X OR facility=MAB OR facility=AUTHMGR)

# --- Change Events ---

[fake_catalyst_config_change]
search = (sourcetype="FAKE:cisco:ios") facility=SYS mnemonic=CONFIG_I

[fake_catalyst_reload]
search = (sourcetype="FAKE:cisco:ios") mnemonic=RELOAD

[fake_catalyst_restart]
search = (sourcetype="FAKE:cisco:ios") facility=SYS mnemonic=RESTART

[fake_catalyst_interface_admin_change]
search = (sourcetype="FAKE:cisco:ios") (vendor_action="administratively down" OR vendor_action="administratively up")

# --- Network Traffic Events ---

[fake_catalyst_acl_log]
search = (sourcetype="FAKE:cisco:ios") (facility=IPACCESSLOG OR mnemonic=IPACCESSLOG*)


##############################################################################################################
# Phase 10: CISCO ACI -- Eventtypes
##############################################################################################################

# --- Fault Events ---

[fake_aci_fault_all]
search = (sourcetype="FAKE:cisco:aci:fault")

[fake_aci_fault_critical]
search = (sourcetype="FAKE:cisco:aci:fault") ("faultInst.attributes.severity"="critical" OR "faultInst.attributes.severity"="major")

# --- Event Records ---

[fake_aci_event_all]
search = (sourcetype="FAKE:cisco:aci:event")

[fake_aci_event_contract_match]
search = (sourcetype="FAKE:cisco:aci:event") "eventRecord.attributes.cause"="contract-match"

# --- Audit Events ---

[fake_aci_audit_all]
search = (sourcetype="FAKE:cisco:aci:audit")


##############################################################################################################
# Phase 11: CISCO SECURE ACCESS (Umbrella) -- Eventtypes
# Source: TA-cisco-cloud-security-addon (Splunkbase)
##############################################################################################################

# DNS resolution events
[fake_umbrella_dns]
search = (sourcetype="FAKE:cisco:umbrella:dns")

# Web proxy events
[fake_umbrella_proxy]
search = (sourcetype="FAKE:cisco:umbrella:proxy")

# Cloud firewall events
[fake_umbrella_firewall]
search = (sourcetype="FAKE:cisco:umbrella:firewall")

# Audit/change events
[fake_umbrella_audit]
search = (sourcetype="FAKE:cisco:umbrella:audit")


##############################################################################################################
# Phase 12: CISCO WEBEX -- Eventtypes
# 8 sourcetypes: device events, meetings (3), admin audit, security audit, qualities, calling
##############################################################################################################

# Device health/status events
[fake_webex_events]
search = (sourcetype="FAKE:cisco:webex:events")

# Meeting usage summary (XML API)
[fake_webex_meetings_usage]
search = (sourcetype="FAKE:cisco:webex:meetings:history:meetingusagehistory")

# Meeting attendee records (XML API)
[fake_webex_meetings_attendee]
search = (sourcetype="FAKE:cisco:webex:meetings:history:meetingattendeehistory")

# Meetings REST API
[fake_webex_meetings_api]
search = (sourcetype="FAKE:cisco:webex:meetings")

# Admin audit/change events
[fake_webex_admin_audit]
search = (sourcetype="FAKE:cisco:webex:admin:audit:events")

# Security audit (authentication) events
[fake_webex_security_audit]
search = (sourcetype="FAKE:cisco:webex:security:audit:events")

# Meeting quality metrics
[fake_webex_qualities]
search = (sourcetype="FAKE:cisco:webex:meeting:qualities")

# Calling detailed history (CDR)
[fake_webex_calling_history]
search = (sourcetype="FAKE:cisco:webex:call:detailed_history")


##############################################################################################################
# Phase 13: CISCO CATALYST CENTER -- Eventtypes
# 4 sourcetypes: device health, network health, client health, issues
##############################################################################################################

# Device health metrics
[fake_catcenter_devicehealth]
search = (sourcetype="FAKE:cisco:catalyst:devicehealth")

# Network health summary
[fake_catcenter_networkhealth]
search = (sourcetype="FAKE:cisco:catalyst:networkhealth")

# Client health summary
[fake_catcenter_clienthealth]
search = (sourcetype="FAKE:cisco:catalyst:clienthealth")

# Assurance issues/alerts
[fake_catcenter_issue]
search = (sourcetype="FAKE:cisco:catalyst:issue")


##############################################################################################################
# Phase 14: MERAKI HEALTH / IoT -- Eventtypes
# 2 new health eventtypes + 2 new sub-type eventtypes
# Note: fake_meraki_sensors was FIXED above (removed type="sensor_reading" filter)
# Note: fake_meraki_cameras unchanged (already covers all 4 types from Phase 8)
##############################################################################################################

# Switch port health metrics
[fake_meraki_switches_health]
search = (sourcetype="FAKE:meraki:switches:health")

# Wireless AP health metrics
[fake_meraki_ap_health]
search = (sourcetype="FAKE:meraki:accesspoints:health")

# Sensor sub-type: door open/close events (physical security)
[fake_meraki_sensors_door]
search = (sourcetype="FAKE:meraki:sensors") type IN ("door_open","door_close")

# Camera sub-type: health status events (device inventory)
[fake_meraki_cameras_health]
search = (sourcetype="FAKE:meraki:cameras") type="health_status"


##############################################################################################################
# Phase 15: AWS BILLING CUR + GUARDDUTY -- Eventtypes
# Source: Splunk_TA_aws (Splunkbase)
# GuardDuty eventtypes adapted from guard_duty_events/guard_duty_events_alert/guard_duty_events_ids
##############################################################################################################

# AWS Cost and Usage Report
[fake_aws_billing]
search = (sourcetype="FAKE:aws:billing:cur")

# All GuardDuty findings
[fake_aws_guardduty]
search = (sourcetype="FAKE:aws:cloudwatch:guardduty")

# GuardDuty alert findings (API-based threats)
[fake_aws_guardduty_alert]
search = (sourcetype="FAKE:aws:cloudwatch:guardduty") "service.action.actionType" IN ("AWS_API_CALL","KUBERNETES_API_CALL","RDS_LOGIN_ATTEMPT")

# GuardDuty IDS findings (network-based threats)
[fake_aws_guardduty_ids]
search = (sourcetype="FAKE:aws:cloudwatch:guardduty") "service.action.actionType" IN ("NETWORK_CONNECTION","DNS_REQUEST","PORT_PROBE")
