#
# local/eventtypes.conf for TA-FAKE-TSHRT
#
# CIM-aligned event types from real Splunk TAs.
# Source: Supporting TA downloads (Splunkbase).
# Convention: fake_ prefix on all eventtype names.
# All searches use FAKE: prefixed sourcetypes.
#

##############################################################################################################
# CISCO ASA - CIM Event Types (Phase 1)
# Source: Splunk_TA_cisco-asa v6.0.0 (Splunkbase #1620)
# CIM Models: Network Traffic, Authentication, IDS, VPN, Change, Certificate, Alert
##############################################################################################################

[fake_cisco_authentication]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("109031","605004","605005","716047","772002","772003","772004","113008","113012","113004","113005","611101","605005","713166","713167","713185","716038","716039","713198","113015")

[fake_cisco_authentication_privileged]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("113021")

[fake_cisco_connection]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("109025","302013","305011","302015","106023","106015","106012","106100","106103","110002","302020","302021","305012","305013","338301","400013","710003","710005","419002","106021","313005","106001","313001","106007","303002","710002","313009","500003","106006","106014","419003","106020","338002","313004","302014","302016","430007","430004","430003","430002","507003")

[fake_cisco_intrusion]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("400032","106016","106017","430001")

[fake_cisco_vpn]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("722051","713228")

[fake_cisco_vpn_start]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("113039","716001","722022","602303","722033","722034")

[fake_cisco_vpn_end]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("113019","716002","722023","602304")

[fake_cisco_asa_network_sessions]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("609001","609002","716058","716059","722028","722029","722030","722031","722037","751025","725003","725007")

[fake_cisco_asa_configuration_change]
search = (sourcetype="FAKE:cisco:asa") (change_class=*) OR message_id IN ("505001","505002","505003","505004","505005","505006","505007","505008","505009","505015","113003")

[fake_cisco_asa_audit_change]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("771002","111009","111004","111001","502102","502101","502103","502111","111010","502112","505015","505004","505009")

[fake_cisco_asa_endpoint_filesystem]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("716015","716014","716016")

[fake_cisco_asa_certificates]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("717009","717022","717027","717028","717029","717037")

[fake_cisco_asa_network_resolution]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("713154")

[fake_cisco_asa_alert]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("110003","405001","212011")

[fake_cisco_network_session_start]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("302022","302024","302026")

[fake_cisco_network_session_end]
search = (sourcetype="FAKE:cisco:asa") message_id IN ("302023","302025")


##############################################################################################################
# WINDOWS - CIM Event Types (Phase 2)
# Source: Splunk_TA_windows v9.x (Splunkbase #742)
# CIM Models: Authentication, Change, Endpoint, Performance
##############################################################################################################

# --- Base Eventtypes (Log Source Filters) ---

[fake_wineventlog_security]
search = (sourcetype="FAKE:WinEventLog") source="WinEventLog:Security"

[fake_wineventlog_system]
search = (sourcetype="FAKE:WinEventLog") source="WinEventLog:System"

[fake_wineventlog_application]
search = (sourcetype="FAKE:WinEventLog") source="WinEventLog:Application"

# --- Security: Authentication ---

# Successful logon (EventCode 4624)
[fake_windows_logon_success]
search = (sourcetype="FAKE:WinEventLog") EventCode=4624

# Failed logon (EventCode 4625)
[fake_windows_logon_failure]
search = (sourcetype="FAKE:WinEventLog") EventCode=4625

# Special privileges assigned to new logon (EventCode 4672)
[fake_windows_special_privileges]
search = (sourcetype="FAKE:WinEventLog") EventCode=4672

# Kerberos TGT requested (EventCode 4768)
[fake_windows_auth_ticket_granted]
search = (sourcetype="FAKE:WinEventLog") EventCode=4768

# Kerberos service ticket requested (EventCode 4769)
[fake_windows_service_ticket_granted]
search = (sourcetype="FAKE:WinEventLog") EventCode=4769

# NTLM credential validation (EventCode 4776)
[fake_windows_account_used4logon]
search = (sourcetype="FAKE:WinEventLog") EventCode=4776

# --- Security: Account Management ---

# User account password set (EventCode 4724)
[fake_windows_account_password_set]
search = (sourcetype="FAKE:WinEventLog") EventCode=4724

# User account changed (EventCode 4738)
[fake_windows_account_modified]
search = (sourcetype="FAKE:WinEventLog") EventCode=4738

# User account locked out (EventCode 4740)
[fake_windows_account_lockout]
search = (sourcetype="FAKE:WinEventLog") EventCode=4740

# --- Security: Process Tracking ---

# New process created (EventCode 4688)
[fake_windows_process_new]
search = (sourcetype="FAKE:WinEventLog") EventCode=4688

# --- Security: CIM Composite Eventtypes ---

# Authentication data model (4624 + 4625 + 4672)
[fake_windows_security_authentication]
search = (sourcetype="FAKE:WinEventLog") (EventCode=4624 OR EventCode=4625 OR EventCode=4672)

# Change data model - scheduled task created (EventCode 4698)
[fake_windows_security_change]
search = (sourcetype="FAKE:WinEventLog") EventCode=4698

# Change data model - account changes (4724 + 4728 + 4738 + 4740)
[fake_windows_security_change_account]
search = (sourcetype="FAKE:WinEventLog") (EventCode=4724 OR EventCode=4728 OR EventCode=4738 OR EventCode=4740)

# Endpoint processes data model (4688 + 4672)
[fake_windows_endpoint_processes]
search = (sourcetype="FAKE:WinEventLog") (EventCode=4688 OR EventCode=4672)

# --- System Events ---

# Time synchronization success (EventCode 37)
[fake_windows_time_sync]
search = (sourcetype="FAKE:WinEventLog") source="WinEventLog:System" EventCode=37

# --- Perfmon ---

# CPU performance metrics
[fake_perfmon_cputime]
search = (sourcetype="FAKE:Perfmon:Processor")

# Memory performance metrics
[fake_perfmon_memory]
search = (sourcetype="FAKE:Perfmon:Memory")

# Logical disk performance metrics
[fake_perfmon_logicaldisk]
search = (sourcetype="FAKE:Perfmon:LogicalDisk")


##############################################################################################################
# SYSMON - CIM Event Types (Phase 2)
# Source: Splunk_TA_microsoft_sysmon v4.x (Splunkbase #5765)
# CIM Models: Endpoint (Processes, Filesystem, Registry), Network Traffic, Network Resolution
##############################################################################################################

# Process events: Create(1), Terminate(5), ImageLoaded(7), CreateRemoteThread(8), ProcessAccess(10)
[fake_sysmon_process]
search = (sourcetype="FAKE:WinEventLog:Sysmon") (EventCode=1 OR EventCode=5 OR EventCode=7 OR EventCode=8 OR EventCode=10)

# Network connection (EventCode 3)
[fake_sysmon_network]
search = (sourcetype="FAKE:WinEventLog:Sysmon") EventCode=3

# File creation (EventCode 11)
[fake_sysmon_filemod]
search = (sourcetype="FAKE:WinEventLog:Sysmon") EventCode=11

# Registry modification (EventCode 13)
[fake_sysmon_regmod]
search = (sourcetype="FAKE:WinEventLog:Sysmon") EventCode=13

# DNS query (EventCode 22)
[fake_sysmon_dns]
search = (sourcetype="FAKE:WinEventLog:Sysmon") EventCode=22


##############################################################################################################
# AWS CLOUDTRAIL - CIM Event Types (Phase 3)
# Source: Splunk_TA_aws v7.x (Splunkbase #1876)
# CIM Models: Authentication, Change, Cloud
##############################################################################################################

# --- Authentication ---

# All auth events (ConsoleLogin + AssumeRole)
[fake_aws_cloudtrail_auth]
search = (sourcetype="FAKE:aws:cloudtrail") (eventName="AssumeRole" OR eventName="ConsoleLogin")

# Console login authentication
[fake_aws_cloudtrail_consolelogin_auth]
search = (sourcetype="FAKE:aws:cloudtrail") eventName="ConsoleLogin"

# Assume role authentication
[fake_aws_cloudtrail_assumeRole_auth]
search = (sourcetype="FAKE:aws:cloudtrail") eventName="AssumeRole"

# Multi-factor authentication events
[fake_aws_cloudtrail_multifactor_auth]
search = (sourcetype="FAKE:aws:cloudtrail") additionalEventData.MFAUsed="Yes"

# --- Change ---

# All change events (create, delete, modify, put)
[fake_aws_cloudtrail_change]
search = (sourcetype="FAKE:aws:cloudtrail") (eventName="CreateAccessKey" OR eventName="DeleteAccessKey" OR eventName="RunInstances" OR eventName="TerminateInstances" OR eventName="PutObject" OR eventName="DeleteObject" OR eventName="SetAlarmState" OR eventName="PutEvaluations" OR eventName="StartConfigRulesEvaluation" OR eventName="PutLogEvents")

# IAM-specific changes (access key management)
[fake_aws_cloudtrail_iam_change]
search = (sourcetype="FAKE:aws:cloudtrail") (eventName="CreateAccessKey" OR eventName="DeleteAccessKey")

# Delete/remove/terminate events
[fake_aws_cloudtrail_delete_events]
search = (sourcetype="FAKE:aws:cloudtrail") (eventName="DeleteObject" OR eventName="DeleteAccessKey" OR eventName="TerminateInstances")

# Endpoint (S3 object) changes
[fake_aws_cloudtrail_endpoint_change]
search = (sourcetype="FAKE:aws:cloudtrail") (eventName="PutObject" OR eventName="DeleteObject")

# --- Compute ---

# EC2 instance lifecycle events
[fake_aws_cloudtrail_ec2_events]
search = (sourcetype="FAKE:aws:cloudtrail") (eventName="RunInstances" OR eventName="TerminateInstances")

# --- Error ---

# All error events
[fake_aws_cloudtrail_errors]
search = (sourcetype="FAKE:aws:cloudtrail") errorCode="*" errorCode!="success"


##############################################################################################################
# ENTRA ID (Azure AD) - CIM Event Types (Phase 4)
# Source: Splunk_TA_microsoft-cloudservices v5.x (Splunkbase #3110)
# CIM Models: Authentication, Change, Alert
# Our FAKE TA uses 3 sourcetypes vs real TA's single azure:monitor:aad
##############################################################################################################

# --- Sign-in: Authentication ---

# All sign-in events
[fake_entra_signin]
search = (sourcetype="FAKE:azure:aad:signin")

# Successful sign-ins (resultType=0 means success)
[fake_entra_signin_success]
search = (sourcetype="FAKE:azure:aad:signin") resultType="0"

# Failed sign-ins (any non-zero resultType)
[fake_entra_signin_failure]
search = (sourcetype="FAKE:azure:aad:signin") resultType!="0"

# MFA-required sign-ins
[fake_entra_signin_mfa]
search = (sourcetype="FAKE:azure:aad:signin") "properties.authenticationRequirement"="multiFactorAuthentication"

# --- Audit: Change ---

# All audit events
[fake_entra_audit]
search = (sourcetype="FAKE:azure:aad:audit")

# Account management (user + group management)
[fake_entra_audit_account_mgmt]
search = (sourcetype="FAKE:azure:aad:audit") "properties.category" IN ("UserManagement","GroupManagement")

# Application management
[fake_entra_audit_app_mgmt]
search = (sourcetype="FAKE:azure:aad:audit") "properties.category"="ApplicationManagement"

# Role management
[fake_entra_audit_role_mgmt]
search = (sourcetype="FAKE:azure:aad:audit") "properties.category"="RoleManagement"

# --- Risk: Alert ---

# All risk detection events
[fake_entra_risk_detection]
search = (sourcetype="FAKE:azure:aad:riskDetection")

# High-risk detections
[fake_entra_risk_high]
search = (sourcetype="FAKE:azure:aad:riskDetection") "properties.riskLevel"="high"
